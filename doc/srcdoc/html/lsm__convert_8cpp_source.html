<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libStorageMgmt: lsm_convert.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>lsm_convert.cpp</h1><a href="lsm__convert_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (C) 2011-2014 Red Hat, Inc.</span>
<a name="l00003"></a>00003 <span class="comment"> * This library is free software; you can redistribute it and/or</span>
<a name="l00004"></a>00004 <span class="comment"> * modify it under the terms of the GNU Lesser General Public</span>
<a name="l00005"></a>00005 <span class="comment"> * License as published by the Free Software Foundation; either</span>
<a name="l00006"></a>00006 <span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> * This library is distributed in the hope that it will be useful,</span>
<a name="l00009"></a>00009 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00010"></a>00010 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00011"></a>00011 <span class="comment"> * Lesser General Public License for more details.</span>
<a name="l00012"></a>00012 <span class="comment"> *</span>
<a name="l00013"></a>00013 <span class="comment"> * You should have received a copy of the GNU Lesser General Public</span>
<a name="l00014"></a>00014 <span class="comment"> * License along with this library; If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * Author: tasleson</span>
<a name="l00017"></a>00017 <span class="comment"> */</span>
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;<a class="code" href="lsm__convert_8hpp.html">lsm_convert.hpp</a>&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;<a class="code" href="libstoragemgmt__accessgroups_8h.html">libstoragemgmt/libstoragemgmt_accessgroups.h</a>&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;<a class="code" href="libstoragemgmt__blockrange_8h.html">libstoragemgmt/libstoragemgmt_blockrange.h</a>&quot;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &quot;<a class="code" href="libstoragemgmt__nfsexport_8h.html">libstoragemgmt/libstoragemgmt_nfsexport.h</a>&quot;</span>
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="lsm__convert_8hpp.html#a142b410e72038f4462b965d37ad9bbad">00024</a> <span class="keywordtype">bool</span> <a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(<a class="code" href="class_value.html">Value</a> &amp; obj, std::string class_name)
<a name="l00025"></a>00025 {
<a name="l00026"></a>00026     <span class="keywordflow">if</span> (obj.<a class="code" href="class_value.html#af8d0ac77ee63564b3ae101a62e38922f">valueType</a>() == <a class="code" href="class_value.html#a5b7c2b5c96c13d5b5d2842e91794f6c1aa3027a4e58556409de7c28c0eb17bafc">Value::object_t</a>) {
<a name="l00027"></a>00027         std::map &lt; std::string, Value &gt; i = obj.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00028"></a>00028         std::map &lt; std::string, Value &gt;::iterator iter = i.find(<span class="stringliteral">&quot;class&quot;</span>);
<a name="l00029"></a>00029         <span class="keywordflow">if</span> (iter != i.end() &amp;&amp; iter-&gt;second.asString() == class_name) {
<a name="l00030"></a>00030             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00031"></a>00031         }
<a name="l00032"></a>00032     }
<a name="l00033"></a>00033     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00034"></a>00034 }
<a name="l00035"></a>00035 
<a name="l00036"></a><a class="code" href="lsm__convert_8hpp.html#a69d713e6c53d9c359926c5ff3bcdb5ff">00036</a> <a class="code" href="struct__lsm__volume.html">lsm_volume</a> *<a class="code" href="lsm__convert_8cpp.html#a0efb6c840e42fc3a8fc010b928a22ff1">value_to_volume</a>(<a class="code" href="class_value.html">Value</a> &amp; vol)
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038     <a class="code" href="struct__lsm__volume.html">lsm_volume</a> *rc = NULL;
<a name="l00039"></a>00039 
<a name="l00040"></a>00040     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(vol, <a class="code" href="lsm__convert_8hpp.html#a633d7be2f6d3c814816a1d2cad8918d6">CLASS_NAME_VOLUME</a>)) {
<a name="l00041"></a>00041         std::map &lt; std::string, Value &gt; v = vol.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00042"></a>00042 
<a name="l00043"></a>00043         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a23a1c83c75920e5c7754d6c0c479cc15">lsm_volume_record_alloc</a>(v[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00044"></a>00044                                      v[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00045"></a>00045                                      v[<span class="stringliteral">&quot;vpd83&quot;</span>].asString().c_str(),
<a name="l00046"></a>00046                                      v[<span class="stringliteral">&quot;block_size&quot;</span>].asUint64_t(),
<a name="l00047"></a>00047                                      v[<span class="stringliteral">&quot;num_of_blocks&quot;</span>].asUint64_t(),
<a name="l00048"></a>00048                                      v[<span class="stringliteral">&quot;admin_state&quot;</span>].asUint32_t(),
<a name="l00049"></a>00049                                      v[<span class="stringliteral">&quot;system_id&quot;</span>].asString().c_str(),
<a name="l00050"></a>00050                                      v[<span class="stringliteral">&quot;pool_id&quot;</span>].asString().c_str(),
<a name="l00051"></a>00051                                      v[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00052"></a>00052     } <span class="keywordflow">else</span> {
<a name="l00053"></a>00053         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_volume: Not correct type&quot;</span>);
<a name="l00054"></a>00054     }
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     <span class="keywordflow">return</span> rc;
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00059"></a><a class="code" href="lsm__convert_8hpp.html#ad5d63bf8de6995439d0dde2aa3742f4e">00059</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a3a2bb9effc45e97434a4f5cf83cea612">volume_to_value</a>(<a class="code" href="struct__lsm__volume.html">lsm_volume</a> * vol)
<a name="l00060"></a>00060 {
<a name="l00061"></a>00061     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a8ea36938782c95c81b22ede3d4ceb5d7">LSM_IS_VOL</a>(vol)) {
<a name="l00062"></a>00062         std::map &lt; std::string, Value &gt; v;
<a name="l00063"></a>00063         v[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a633d7be2f6d3c814816a1d2cad8918d6">CLASS_NAME_VOLUME</a>);
<a name="l00064"></a>00064         v[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00065"></a>00065         v[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00066"></a>00066         v[<span class="stringliteral">&quot;vpd83&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#acddf599477afd58f1b18c6c7f7f1a656">vpd83</a>);
<a name="l00067"></a>00067         v[<span class="stringliteral">&quot;block_size&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#a06e04cd37a309e4f7d66014f0d9aa2be">block_size</a>);
<a name="l00068"></a>00068         v[<span class="stringliteral">&quot;num_of_blocks&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#ab6c1fa974f68e82355986b9c728221da">number_of_blocks</a>);
<a name="l00069"></a>00069         v[<span class="stringliteral">&quot;admin_state&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#ac24308bf2b5367c7708e66e79fe3fbfe">admin_state</a>);
<a name="l00070"></a>00070         v[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#adbcb53aefea45e3a3ec73b9db52b8fc0">system_id</a>);
<a name="l00071"></a>00071         v[<span class="stringliteral">&quot;pool_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#a661fc053a909f8c5d3cff89c856fed89">pool_id</a>);
<a name="l00072"></a>00072         v[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(vol-&gt;<a class="code" href="struct__lsm__volume.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00073"></a>00073         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(v);
<a name="l00074"></a>00074     }
<a name="l00075"></a>00075     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00076"></a>00076 }
<a name="l00077"></a>00077 
<a name="l00078"></a><a class="code" href="lsm__convert_8hpp.html#af80c3330b915debb975742e31a9609b7">00078</a> <span class="keywordtype">int</span> <a class="code" href="lsm__convert_8cpp.html#a08d9a32fcb85aa3ea652f2eee2551a97">value_array_to_volumes</a>(<a class="code" href="class_value.html">Value</a> &amp; volume_values, <a class="code" href="struct__lsm__volume.html">lsm_volume</a> ** volumes[],
<a name="l00079"></a>00079                            uint32_t * count)
<a name="l00080"></a>00080 {
<a name="l00081"></a>00081     <span class="keywordtype">int</span> rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2aa6e5b7f4231db2232f0d778e40a2cfb9">LSM_ERR_OK</a>;
<a name="l00082"></a>00082     <span class="keywordflow">try</span> {
<a name="l00083"></a>00083         *count = 0;
<a name="l00084"></a>00084 
<a name="l00085"></a>00085         <span class="keywordflow">if</span> (<a class="code" href="class_value.html#a5b7c2b5c96c13d5b5d2842e91794f6c1a7a92eae62ffc31f1234613d7d752c84d">Value::array_t</a> == volume_values.<a class="code" href="class_value.html#af8d0ac77ee63564b3ae101a62e38922f">valueType</a>()) {
<a name="l00086"></a>00086             std::vector &lt; Value &gt; vol = volume_values.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00087"></a>00087 
<a name="l00088"></a>00088             *count = vol.size();
<a name="l00089"></a>00089 
<a name="l00090"></a>00090             <span class="keywordflow">if</span> (vol.size()) {
<a name="l00091"></a>00091                 *volumes = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a284b580a47bfae1b6d02e8bae97efa28">lsm_volume_record_array_alloc</a>(vol.size());
<a name="l00092"></a>00092 
<a name="l00093"></a>00093                 <span class="keywordflow">if</span> (*volumes) {
<a name="l00094"></a>00094                     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; vol.size(); ++i) {
<a name="l00095"></a>00095                         (*volumes)[i] = <a class="code" href="lsm__convert_8cpp.html#a0efb6c840e42fc3a8fc010b928a22ff1">value_to_volume</a>(vol[i]);
<a name="l00096"></a>00096                         <span class="keywordflow">if</span> (!((*volumes)[i])) {
<a name="l00097"></a>00097                             rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00098"></a>00098                             <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00099"></a>00099                         }
<a name="l00100"></a>00100                     }
<a name="l00101"></a>00101                 } <span class="keywordflow">else</span> {
<a name="l00102"></a>00102                     rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00103"></a>00103                 }
<a name="l00104"></a>00104             }
<a name="l00105"></a>00105         }
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107     <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="class_value_exception.html">ValueException</a> &amp; ve) {
<a name="l00108"></a>00108         rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2ac64627333f5366a9782886af7ec8ab28">LSM_ERR_LIB_BUG</a>;
<a name="l00109"></a>00109         <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00110"></a>00110     }
<a name="l00111"></a>00111 
<a name="l00112"></a>00112   <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>:
<a name="l00113"></a>00113     <span class="keywordflow">return</span> rc;
<a name="l00114"></a>00114 
<a name="l00115"></a>00115   <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>:
<a name="l00116"></a>00116     <span class="keywordflow">if</span> (*volumes &amp;&amp; *count) {
<a name="l00117"></a>00117         <a class="code" href="libstoragemgmt__volumes_8h.html#a5e6b658933de208b14ba9a8121ba7e0c">lsm_volume_record_array_free</a>(*volumes, *count);
<a name="l00118"></a>00118         *volumes = NULL;
<a name="l00119"></a>00119         *count = 0;
<a name="l00120"></a>00120     }
<a name="l00121"></a>00121     <span class="keywordflow">goto</span> <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="lsm__convert_8hpp.html#aa358ce4baf33a549fdbf4002ff30f044">00124</a> <a class="code" href="struct__lsm__disk.html">lsm_disk</a> *<a class="code" href="lsm__convert_8cpp.html#a95605a686eb5429978752f92850f930e">value_to_disk</a>(<a class="code" href="class_value.html">Value</a> &amp; disk)
<a name="l00125"></a>00125 {
<a name="l00126"></a>00126     <a class="code" href="struct__lsm__disk.html">lsm_disk</a> *rc = NULL;
<a name="l00127"></a>00127     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(disk, <a class="code" href="lsm__convert_8hpp.html#a4ece3f8ba73da52a94cb41c49e491e93">CLASS_NAME_DISK</a>)) {
<a name="l00128"></a>00128         std::map &lt; std::string, Value &gt; d = disk.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00129"></a>00129 
<a name="l00130"></a>00130         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a956a6a7959dcba5fdb614163e75d814c">lsm_disk_record_alloc</a>(d[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00131"></a>00131                                    d[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00132"></a>00132                                    (<a class="code" href="libstoragemgmt__types_8h.html#a08b0b977ab30a5266e5ff38081123819">lsm_disk_type</a>) d[<span class="stringliteral">&quot;disk_type&quot;</span>].asInt32_t(),
<a name="l00133"></a>00133                                    d[<span class="stringliteral">&quot;block_size&quot;</span>].asUint64_t(),
<a name="l00134"></a>00134                                    d[<span class="stringliteral">&quot;num_of_blocks&quot;</span>].asUint64_t(),
<a name="l00135"></a>00135                                    d[<span class="stringliteral">&quot;status&quot;</span>].asUint64_t(),
<a name="l00136"></a>00136                                    d[<span class="stringliteral">&quot;system_id&quot;</span>].asString().c_str()
<a name="l00137"></a>00137             );
<a name="l00138"></a>00138     } <span class="keywordflow">else</span> {
<a name="l00139"></a>00139         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_disk: Not correct type&quot;</span>);
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141     <span class="keywordflow">return</span> rc;
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 
<a name="l00145"></a><a class="code" href="lsm__convert_8hpp.html#ac2966983c42e2d94f57c4ed0ee9fb17d">00145</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a1e5e136b7a224a1be8f10e31ab8d9656">disk_to_value</a>(<a class="code" href="struct__lsm__disk.html">lsm_disk</a> * disk)
<a name="l00146"></a>00146 {
<a name="l00147"></a>00147     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a6ea97a2c9019caef482f4548be05502f">LSM_IS_DISK</a>(disk)) {
<a name="l00148"></a>00148         std::map &lt; std::string, Value &gt; d;
<a name="l00149"></a>00149         d[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a4ece3f8ba73da52a94cb41c49e491e93">CLASS_NAME_DISK</a>);
<a name="l00150"></a>00150         d[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00151"></a>00151         d[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00152"></a>00152         d[<span class="stringliteral">&quot;disk_type&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#a5ed93a6b611a2af910e4918d44eda5e2">disk_type</a>);
<a name="l00153"></a>00153         d[<span class="stringliteral">&quot;block_size&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#a06e04cd37a309e4f7d66014f0d9aa2be">block_size</a>);
<a name="l00154"></a>00154         d[<span class="stringliteral">&quot;num_of_blocks&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#a814ed4ad8efe192692b4dd34cd41af54">block_count</a>);
<a name="l00155"></a>00155         d[<span class="stringliteral">&quot;status&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#adb207e956556b3d63d8bedb953810b9c">disk_status</a>);
<a name="l00156"></a>00156         d[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(disk-&gt;<a class="code" href="struct__lsm__disk.html#adbcb53aefea45e3a3ec73b9db52b8fc0">system_id</a>);
<a name="l00157"></a>00157 
<a name="l00158"></a>00158         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(d);
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00161"></a>00161 }
<a name="l00162"></a>00162 
<a name="l00163"></a><a class="code" href="lsm__convert_8hpp.html#a00dd02db9f403da93a45fdcb70ce54e2">00163</a> <span class="keywordtype">int</span> <a class="code" href="lsm__convert_8cpp.html#a6d7cb1ca7482f3ff52ed1ff6dcd335b4">value_array_to_disks</a>(<a class="code" href="class_value.html">Value</a> &amp; disk_values, <a class="code" href="struct__lsm__disk.html">lsm_disk</a> ** disks[],
<a name="l00164"></a>00164                          uint32_t * count)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <span class="keywordtype">int</span> rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2aa6e5b7f4231db2232f0d778e40a2cfb9">LSM_ERR_OK</a>;
<a name="l00167"></a>00167     <span class="keywordflow">try</span> {
<a name="l00168"></a>00168         *count = 0;
<a name="l00169"></a>00169 
<a name="l00170"></a>00170         <span class="keywordflow">if</span> (<a class="code" href="class_value.html#a5b7c2b5c96c13d5b5d2842e91794f6c1a7a92eae62ffc31f1234613d7d752c84d">Value::array_t</a> == disk_values.<a class="code" href="class_value.html#af8d0ac77ee63564b3ae101a62e38922f">valueType</a>()) {
<a name="l00171"></a>00171             std::vector &lt; Value &gt; d = disk_values.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00172"></a>00172 
<a name="l00173"></a>00173             *count = d.size();
<a name="l00174"></a>00174 
<a name="l00175"></a>00175             <span class="keywordflow">if</span> (d.size()) {
<a name="l00176"></a>00176                 *disks = <a class="code" href="libstoragemgmt__plug__interface_8h.html#ad6ea0588f9fa9376a37fbd5475f6ef84">lsm_disk_record_array_alloc</a>(d.size());
<a name="l00177"></a>00177 
<a name="l00178"></a>00178                 <span class="keywordflow">if</span> (*disks) {
<a name="l00179"></a>00179                     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; d.size(); ++i) {
<a name="l00180"></a>00180                         (*disks)[i] = <a class="code" href="lsm__convert_8cpp.html#a95605a686eb5429978752f92850f930e">value_to_disk</a>(d[i]);
<a name="l00181"></a>00181                         <span class="keywordflow">if</span> (!((*disks)[i])) {
<a name="l00182"></a>00182                             rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00183"></a>00183                             <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00184"></a>00184                         }
<a name="l00185"></a>00185                     }
<a name="l00186"></a>00186                 } <span class="keywordflow">else</span> {
<a name="l00187"></a>00187                     rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00188"></a>00188                 }
<a name="l00189"></a>00189             }
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192     <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="class_value_exception.html">ValueException</a> &amp; ve) {
<a name="l00193"></a>00193         rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2ac64627333f5366a9782886af7ec8ab28">LSM_ERR_LIB_BUG</a>;
<a name="l00194"></a>00194         <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197   <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>:
<a name="l00198"></a>00198     <span class="keywordflow">return</span> rc;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200   <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>:
<a name="l00201"></a>00201     <span class="keywordflow">if</span> (*disks &amp;&amp; *count) {
<a name="l00202"></a>00202         <a class="code" href="libstoragemgmt__disk_8h.html#a1d047a3ddb2981c3994c48a793d25084">lsm_disk_record_array_free</a>(*disks, *count);
<a name="l00203"></a>00203         *disks = NULL;
<a name="l00204"></a>00204         *count = 0;
<a name="l00205"></a>00205     }
<a name="l00206"></a>00206     <span class="keywordflow">goto</span> <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>;
<a name="l00207"></a>00207 }
<a name="l00208"></a>00208 
<a name="l00209"></a><a class="code" href="lsm__convert_8hpp.html#a8366a59e55211323a138b9a8f83129c8">00209</a> <a class="code" href="struct__lsm__pool.html">lsm_pool</a> *<a class="code" href="lsm__convert_8cpp.html#a23825482fa20087834eed9d5e737fd2c">value_to_pool</a>(<a class="code" href="class_value.html">Value</a> &amp; pool)
<a name="l00210"></a>00210 {
<a name="l00211"></a>00211     <a class="code" href="struct__lsm__pool.html">lsm_pool</a> *rc = NULL;
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(pool, <a class="code" href="lsm__convert_8hpp.html#a8450c7523304a75ca3bd9c532ef9b6fd">CLASS_NAME_POOL</a>)) {
<a name="l00214"></a>00214         std::map &lt; std::string, Value &gt; i = pool.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00215"></a>00215 
<a name="l00216"></a>00216         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#ae1abeb1f76607e20caa85c45f9ded685">lsm_pool_record_alloc</a>(i[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00217"></a>00217                                    i[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00218"></a>00218                                    i[<span class="stringliteral">&quot;element_type&quot;</span>].asUint64_t(),
<a name="l00219"></a>00219                                    i[<span class="stringliteral">&quot;unsupported_actions&quot;</span>].asUint64_t(),
<a name="l00220"></a>00220                                    i[<span class="stringliteral">&quot;total_space&quot;</span>].asUint64_t(),
<a name="l00221"></a>00221                                    i[<span class="stringliteral">&quot;free_space&quot;</span>].asUint64_t(),
<a name="l00222"></a>00222                                    i[<span class="stringliteral">&quot;status&quot;</span>].asUint64_t(),
<a name="l00223"></a>00223                                    i[<span class="stringliteral">&quot;status_info&quot;</span>].asString().c_str(),
<a name="l00224"></a>00224                                    i[<span class="stringliteral">&quot;system_id&quot;</span>].asString().c_str(),
<a name="l00225"></a>00225                                    i[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00226"></a>00226     } <span class="keywordflow">else</span> {
<a name="l00227"></a>00227         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_pool: Not correct type&quot;</span>);
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229     <span class="keywordflow">return</span> rc;
<a name="l00230"></a>00230 }
<a name="l00231"></a>00231 
<a name="l00232"></a><a class="code" href="lsm__convert_8hpp.html#a239d504fe59743534f10961cf887e9fe">00232</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#af80b3591fe77244b1ed101e3d01af195">pool_to_value</a>(<a class="code" href="struct__lsm__pool.html">lsm_pool</a> * pool)
<a name="l00233"></a>00233 {
<a name="l00234"></a>00234     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a6c1a7b0350eee43615b3a0c58cac3c77">LSM_IS_POOL</a>(pool)) {
<a name="l00235"></a>00235         std::map &lt; std::string, Value &gt; <a class="code" href="lsm__datatypes_8cpp.html#a839528ec4ac9ec17126e8e2e1d46e9fe">p</a>;
<a name="l00236"></a>00236         p[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a8450c7523304a75ca3bd9c532ef9b6fd">CLASS_NAME_POOL</a>);
<a name="l00237"></a>00237         p[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00238"></a>00238         p[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00239"></a>00239         p[<span class="stringliteral">&quot;element_type&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#a7306e75c0d40038f3bedfde1f58cc424">element_type</a>);
<a name="l00240"></a>00240         p[<span class="stringliteral">&quot;unsupported_actions&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#ab6e105ed3d01fcec2e489dd7c80921ed">unsupported_actions</a>);
<a name="l00241"></a>00241         p[<span class="stringliteral">&quot;total_space&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#a4dce9caf4986bff088cab52cef06b38b">total_space</a>);
<a name="l00242"></a>00242         p[<span class="stringliteral">&quot;free_space&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#aae4ce9805bb100f2dbbfefec7971149e">free_space</a>);
<a name="l00243"></a>00243         p[<span class="stringliteral">&quot;status&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#ac9a1085cf3683a860d926abcb7af7cfc">status</a>);
<a name="l00244"></a>00244         p[<span class="stringliteral">&quot;status_info&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#a27d33fb8c2d5e437eee7e5ed5b39d857">status_info</a>);
<a name="l00245"></a>00245         p[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#adbcb53aefea45e3a3ec73b9db52b8fc0">system_id</a>);
<a name="l00246"></a>00246         p[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(pool-&gt;<a class="code" href="struct__lsm__pool.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00247"></a>00247         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(p);
<a name="l00248"></a>00248     }
<a name="l00249"></a>00249     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00250"></a>00250 }
<a name="l00251"></a>00251 
<a name="l00252"></a><a class="code" href="lsm__convert_8hpp.html#a354474d6ebb041291f54b91bb42afb40">00252</a> <a class="code" href="struct__lsm__system.html">lsm_system</a> *<a class="code" href="lsm__convert_8cpp.html#a49198461198770e8dbd90cf6b950c121">value_to_system</a>(<a class="code" href="class_value.html">Value</a> &amp; system)
<a name="l00253"></a>00253 {
<a name="l00254"></a>00254     <a class="code" href="struct__lsm__system.html">lsm_system</a> *rc = NULL;
<a name="l00255"></a>00255     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(system, <a class="code" href="lsm__convert_8hpp.html#aee979cb6a61aa69877507cbe26410cf8">CLASS_NAME_SYSTEM</a>)) {
<a name="l00256"></a>00256         std::map &lt; std::string, Value &gt; i = system.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a43b9509e6a75c4754075c9f8558150c4">lsm_system_record_alloc</a>(i[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00259"></a>00259                                      i[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00260"></a>00260                                      i[<span class="stringliteral">&quot;status&quot;</span>].asUint32_t(),
<a name="l00261"></a>00261                                      i[<span class="stringliteral">&quot;status_info&quot;</span>].asString().c_str(),
<a name="l00262"></a>00262                                      i[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00263"></a>00263     } <span class="keywordflow">else</span> {
<a name="l00264"></a>00264         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_system: Not correct type&quot;</span>);
<a name="l00265"></a>00265     }
<a name="l00266"></a>00266     <span class="keywordflow">return</span> rc;
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a><a class="code" href="lsm__convert_8hpp.html#ad34cfebbb946cb8eb3b14195850e89d2">00269</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a64192028f7e1cd9ba79969062d17d3ea">system_to_value</a>(<a class="code" href="struct__lsm__system.html">lsm_system</a> * system)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a690e5decf5a95b077d112fd2723fde7d">LSM_IS_SYSTEM</a>(system)) {
<a name="l00272"></a>00272         std::map &lt; std::string, Value &gt; s;
<a name="l00273"></a>00273         s[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#aee979cb6a61aa69877507cbe26410cf8">CLASS_NAME_SYSTEM</a>);
<a name="l00274"></a>00274         s[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(system-&gt;<a class="code" href="struct__lsm__system.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00275"></a>00275         s[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(system-&gt;<a class="code" href="struct__lsm__system.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00276"></a>00276         s[<span class="stringliteral">&quot;status&quot;</span>] = <a class="code" href="class_value.html">Value</a>(system-&gt;<a class="code" href="struct__lsm__system.html#ade20423e91627f07e610924cb0081623">status</a>);
<a name="l00277"></a>00277         s[<span class="stringliteral">&quot;status_info&quot;</span>] = <a class="code" href="class_value.html">Value</a>(system-&gt;<a class="code" href="struct__lsm__system.html#a27d33fb8c2d5e437eee7e5ed5b39d857">status_info</a>);
<a name="l00278"></a>00278         s[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(system-&gt;<a class="code" href="struct__lsm__system.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00279"></a>00279         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(s);
<a name="l00280"></a>00280     }
<a name="l00281"></a>00281     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a><a class="code" href="lsm__convert_8hpp.html#a5b8bfefddd14dab26dd1d1d4f83aa896">00284</a> <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *<a class="code" href="lsm__convert_8cpp.html#ab5eeee745fbaa40daddfa60c77567d18">value_to_string_list</a>(<a class="code" href="class_value.html">Value</a> &amp; v)
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286     <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *il = NULL;
<a name="l00287"></a>00287 
<a name="l00288"></a>00288     <span class="keywordflow">if</span> (<a class="code" href="class_value.html#a5b7c2b5c96c13d5b5d2842e91794f6c1a7a92eae62ffc31f1234613d7d752c84d">Value::array_t</a> == v.<a class="code" href="class_value.html#af8d0ac77ee63564b3ae101a62e38922f">valueType</a>()) {
<a name="l00289"></a>00289         std::vector &lt; Value &gt; vl = v.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00290"></a>00290         uint32_t size = vl.size();
<a name="l00291"></a>00291         il = <a class="code" href="libstoragemgmt__common_8h.html#ae74bb6480d8bf5d8f7611cb1b5538943">lsm_string_list_alloc</a>(size);
<a name="l00292"></a>00292 
<a name="l00293"></a>00293         <span class="keywordflow">if</span> (il) {
<a name="l00294"></a>00294             <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; size; ++i) {
<a name="l00295"></a>00295                 <span class="keywordflow">if</span> (<a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2aa6e5b7f4231db2232f0d778e40a2cfb9">LSM_ERR_OK</a> !=
<a name="l00296"></a>00296                     <a class="code" href="libstoragemgmt__common_8h.html#a3c14a677c3228eb120dda0aca3a55bb2">lsm_string_list_elem_set</a>(il, i, vl[i].asC_str())) {
<a name="l00297"></a>00297                     <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(il);
<a name="l00298"></a>00298                     il = NULL;
<a name="l00299"></a>00299                     <span class="keywordflow">break</span>;
<a name="l00300"></a>00300                 }
<a name="l00301"></a>00301             }
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303     } <span class="keywordflow">else</span> {
<a name="l00304"></a>00304         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_string_list: Not correct type&quot;</span>);
<a name="l00305"></a>00305     }
<a name="l00306"></a>00306     <span class="keywordflow">return</span> il;
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a><a class="code" href="lsm__convert_8hpp.html#afaa3a1e996cb29ea6df4ea421bbd8546">00309</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#ab12e4a58efa188d9b9ccbad5bf4a60a9">string_list_to_value</a>(<a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> * sl)
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311     std::vector &lt; Value &gt; rc;
<a name="l00312"></a>00312     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a81a878122d8c9b89f14360e9808cf0dd">LSM_IS_STRING_LIST</a>(sl)) {
<a name="l00313"></a>00313         uint32_t size = <a class="code" href="libstoragemgmt__common_8h.html#ad34a6ddb243ad500bda1ed9221d1555f">lsm_string_list_size</a>(sl);
<a name="l00314"></a>00314         rc.reserve(size);
<a name="l00315"></a>00315 
<a name="l00316"></a>00316         <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; size; ++i) {
<a name="l00317"></a>00317             rc.push_back(<a class="code" href="class_value.html">Value</a>(<a class="code" href="libstoragemgmt__common_8h.html#a4f84263165b1bac528847364be3868f3">lsm_string_list_elem_get</a>(sl, i)));
<a name="l00318"></a>00318         }
<a name="l00319"></a>00319     }
<a name="l00320"></a>00320     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(rc);
<a name="l00321"></a>00321 }
<a name="l00322"></a>00322 
<a name="l00323"></a><a class="code" href="lsm__convert_8hpp.html#a4b5797b3c711ae997cbe2e0deb05582d">00323</a> <a class="code" href="struct__lsm__access__group.html">lsm_access_group</a> *<a class="code" href="lsm__convert_8cpp.html#a7977d143a5d88f560ff2b14f37819bb2">value_to_access_group</a>(<a class="code" href="class_value.html">Value</a> &amp; group)
<a name="l00324"></a>00324 {
<a name="l00325"></a>00325     <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *il = NULL;
<a name="l00326"></a>00326     <a class="code" href="struct__lsm__access__group.html">lsm_access_group</a> *ag = NULL;
<a name="l00327"></a>00327 
<a name="l00328"></a>00328     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(group, <a class="code" href="lsm__convert_8hpp.html#af08a5a8503a0fce095c90031bb65f430">CLASS_NAME_ACCESS_GROUP</a>)) {
<a name="l00329"></a>00329         std::map &lt; std::string, Value &gt; vAg = group.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00330"></a>00330         il = <a class="code" href="lsm__convert_8cpp.html#ab5eeee745fbaa40daddfa60c77567d18">value_to_string_list</a>(vAg[<span class="stringliteral">&quot;init_ids&quot;</span>]);
<a name="l00331"></a>00331 
<a name="l00332"></a>00332         <span class="keywordflow">if</span> (il) {
<a name="l00333"></a>00333             ag = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a4577d398e05af6bfa0821942c2c6316d">lsm_access_group_record_alloc</a>(vAg[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00334"></a>00334                                                vAg[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00335"></a>00335                                                il, (<a class="code" href="libstoragemgmt__types_8h.html#a31858ec26b8f30ad09400b567bd842db">lsm_access_group_init_type</a>)
<a name="l00336"></a>00336                                                vAg[<span class="stringliteral">&quot;init_type&quot;</span>].asInt32_t(),
<a name="l00337"></a>00337                                                vAg[<span class="stringliteral">&quot;system_id&quot;</span>].
<a name="l00338"></a>00338                                                asString().c_str(),
<a name="l00339"></a>00339                                                vAg[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00340"></a>00340         }
<a name="l00341"></a>00341         <span class="comment">/* This stuff is copied in lsm_access_group_record_alloc */</span>
<a name="l00342"></a>00342         <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(il);
<a name="l00343"></a>00343     } <span class="keywordflow">else</span> {
<a name="l00344"></a>00344         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_access_group: Not correct type&quot;</span>);
<a name="l00345"></a>00345     }
<a name="l00346"></a>00346     <span class="keywordflow">return</span> ag;
<a name="l00347"></a>00347 }
<a name="l00348"></a>00348 
<a name="l00349"></a><a class="code" href="lsm__convert_8hpp.html#a382977f90fc7d38775d1db78123c22d8">00349</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#afa1785eed2f2c143e36f29c212a0857e">access_group_to_value</a>(<a class="code" href="struct__lsm__access__group.html">lsm_access_group</a> * group)
<a name="l00350"></a>00350 {
<a name="l00351"></a>00351     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#af31bb51b0df70c84f9766bd6eb7cde06">LSM_IS_ACCESS_GROUP</a>(group)) {
<a name="l00352"></a>00352         std::map &lt; std::string, Value &gt; ag;
<a name="l00353"></a>00353         ag[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#af08a5a8503a0fce095c90031bb65f430">CLASS_NAME_ACCESS_GROUP</a>);
<a name="l00354"></a>00354         ag[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00355"></a>00355         ag[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00356"></a>00356         ag[<span class="stringliteral">&quot;init_ids&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8cpp.html#ab12e4a58efa188d9b9ccbad5bf4a60a9">string_list_to_value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#a2ab2b980ef16796467617019a096785d">initiators</a>));
<a name="l00357"></a>00357         ag[<span class="stringliteral">&quot;init_type&quot;</span>] = <a class="code" href="class_value.html">Value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#aa7376317ec0ab7a9fd3c773a85b56700">init_type</a>);
<a name="l00358"></a>00358         ag[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#adbcb53aefea45e3a3ec73b9db52b8fc0">system_id</a>);
<a name="l00359"></a>00359         ag[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(group-&gt;<a class="code" href="struct__lsm__access__group.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00360"></a>00360         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(ag);
<a name="l00361"></a>00361     }
<a name="l00362"></a>00362     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="lsm__convert_8hpp.html#a7b9a6fa5db0d852bf3e32ec61d8f0b52">00365</a> <span class="keywordtype">int</span> <a class="code" href="lsm__convert_8cpp.html#a60ea0be43225cc70251253200a2ed818">value_array_to_access_groups</a>(<a class="code" href="class_value.html">Value</a> &amp; group,
<a name="l00366"></a>00366                                  <a class="code" href="struct__lsm__access__group.html">lsm_access_group</a> ** ag_list[],
<a name="l00367"></a>00367                                  uint32_t * count)
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369     <span class="keywordtype">int</span> rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2aa6e5b7f4231db2232f0d778e40a2cfb9">LSM_ERR_OK</a>;
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     <span class="keywordflow">try</span> {
<a name="l00372"></a>00372         std::vector &lt; Value &gt; ag = group.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00373"></a>00373         *count = ag.size();
<a name="l00374"></a>00374 
<a name="l00375"></a>00375         <span class="keywordflow">if</span> (*count) {
<a name="l00376"></a>00376             *ag_list = <a class="code" href="libstoragemgmt__plug__interface_8h.html#ab9b508c56ebea569cc530d894ba5a15e">lsm_access_group_record_array_alloc</a>(*count);
<a name="l00377"></a>00377             <span class="keywordflow">if</span> (*ag_list) {
<a name="l00378"></a>00378                 uint32_t i;
<a name="l00379"></a>00379                 <span class="keywordflow">for</span> (i = 0; i &lt; *count; ++i) {
<a name="l00380"></a>00380                     (*ag_list)[i] = <a class="code" href="lsm__convert_8cpp.html#a7977d143a5d88f560ff2b14f37819bb2">value_to_access_group</a>(ag[i]);
<a name="l00381"></a>00381                     <span class="keywordflow">if</span> (!((*ag_list)[i])) {
<a name="l00382"></a>00382                         rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00383"></a>00383                         <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00384"></a>00384                     }
<a name="l00385"></a>00385                 }
<a name="l00386"></a>00386             } <span class="keywordflow">else</span> {
<a name="l00387"></a>00387                 rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00388"></a>00388             }
<a name="l00389"></a>00389         }
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391     <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="class_value_exception.html">ValueException</a> &amp; ve) {
<a name="l00392"></a>00392         rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2ac64627333f5366a9782886af7ec8ab28">LSM_ERR_LIB_BUG</a>;
<a name="l00393"></a>00393         <span class="keywordflow">goto</span> <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>;
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 
<a name="l00396"></a>00396   <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>:
<a name="l00397"></a>00397     <span class="keywordflow">return</span> rc;
<a name="l00398"></a>00398 
<a name="l00399"></a>00399   <a class="code" href="client__example_8c.html#a02a815e32ecbf068b8dc5ecefd89e296">error</a>:
<a name="l00400"></a>00400     <span class="keywordflow">if</span> (*ag_list &amp;&amp; *count) {
<a name="l00401"></a>00401         <a class="code" href="libstoragemgmt__accessgroups_8h.html#ad593cb660a6fc96fd90b70d9eb3bcb7d">lsm_access_group_record_array_free</a>(*ag_list, *count);
<a name="l00402"></a>00402         *ag_list = NULL;
<a name="l00403"></a>00403         *count = 0;
<a name="l00404"></a>00404     }
<a name="l00405"></a>00405     <span class="keywordflow">goto</span> <a class="code" href="namespacelsmcli_1_1data__display.html#aeadc08e78abd46b3b8c29953b699f91c" title="Users are reporting errors with broken pipe when piping output to another program...">out</a>;
<a name="l00406"></a>00406 }
<a name="l00407"></a>00407 
<a name="l00408"></a><a class="code" href="lsm__convert_8hpp.html#aa0d21f839085334a58ad360778b834f2">00408</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#affbc99b918ae6c5931c2be4ebd6db766">access_group_list_to_value</a>(<a class="code" href="struct__lsm__access__group.html">lsm_access_group</a> ** group, uint32_t count)
<a name="l00409"></a>00409 {
<a name="l00410"></a>00410     std::vector &lt; Value &gt; rc;
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="keywordflow">if</span> (group &amp;&amp; count) {
<a name="l00413"></a>00413         uint32_t i;
<a name="l00414"></a>00414         rc.reserve(count);
<a name="l00415"></a>00415         <span class="keywordflow">for</span> (i = 0; i &lt; count; ++i) {
<a name="l00416"></a>00416             rc.push_back(<a class="code" href="lsm__convert_8cpp.html#afa1785eed2f2c143e36f29c212a0857e">access_group_to_value</a>(group[i]));
<a name="l00417"></a>00417         }
<a name="l00418"></a>00418     }
<a name="l00419"></a>00419     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(rc);
<a name="l00420"></a>00420 }
<a name="l00421"></a>00421 
<a name="l00422"></a><a class="code" href="lsm__convert_8hpp.html#aefe916147d4d79b472e91b9d58588f67">00422</a> <a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> *<a class="code" href="lsm__convert_8cpp.html#a0a8b905122236b482248b103c7c650ee">value_to_block_range</a>(<a class="code" href="class_value.html">Value</a> &amp; br)
<a name="l00423"></a>00423 {
<a name="l00424"></a>00424     <a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> *rc = NULL;
<a name="l00425"></a>00425     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(br, <a class="code" href="lsm__convert_8hpp.html#a011a1de98fe43ef7d3cfe8fe52d78645">CLASS_NAME_BLOCK_RANGE</a>)) {
<a name="l00426"></a>00426         std::map &lt; std::string, Value &gt; range = br.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00427"></a>00427 
<a name="l00428"></a>00428         rc = <a class="code" href="libstoragemgmt__blockrange_8h.html#a95267306cb49ef9d856c031dd0f69867">lsm_block_range_record_alloc</a>(range[<span class="stringliteral">&quot;src_block&quot;</span>].asUint64_t(),
<a name="l00429"></a>00429                                           range[<span class="stringliteral">&quot;dest_block&quot;</span>].asUint64_t(),
<a name="l00430"></a>00430                                           range[<span class="stringliteral">&quot;block_count&quot;</span>].asUint64_t());
<a name="l00431"></a>00431     } <span class="keywordflow">else</span> {
<a name="l00432"></a>00432         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_block_range: Not correct type&quot;</span>);
<a name="l00433"></a>00433     }
<a name="l00434"></a>00434     <span class="keywordflow">return</span> rc;
<a name="l00435"></a>00435 }
<a name="l00436"></a>00436 
<a name="l00437"></a><a class="code" href="lsm__convert_8hpp.html#a6f014d11e67049f7baa997f9715b188c">00437</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a333d15f6396e1cc7a7d16daa911259e9">block_range_to_value</a>(<a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> * br)
<a name="l00438"></a>00438 {
<a name="l00439"></a>00439     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a890badf5037c7eb0b3e59332f386bb79">LSM_IS_BLOCK_RANGE</a>(br)) {
<a name="l00440"></a>00440         std::map &lt; std::string, Value &gt; r;
<a name="l00441"></a>00441         r[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a011a1de98fe43ef7d3cfe8fe52d78645">CLASS_NAME_BLOCK_RANGE</a>);
<a name="l00442"></a>00442         r[<span class="stringliteral">&quot;src_block&quot;</span>] = <a class="code" href="class_value.html">Value</a>(br-&gt;<a class="code" href="struct__lsm__block__range.html#a173f9a058d8b26964b0b67072766700c">source_start</a>);
<a name="l00443"></a>00443         r[<span class="stringliteral">&quot;dest_block&quot;</span>] = <a class="code" href="class_value.html">Value</a>(br-&gt;<a class="code" href="struct__lsm__block__range.html#a872e61666c0a0732e3fe194b1454a0b1">dest_start</a>);
<a name="l00444"></a>00444         r[<span class="stringliteral">&quot;block_count&quot;</span>] = <a class="code" href="class_value.html">Value</a>(br-&gt;<a class="code" href="struct__lsm__block__range.html#a814ed4ad8efe192692b4dd34cd41af54">block_count</a>);
<a name="l00445"></a>00445         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(r);
<a name="l00446"></a>00446     }
<a name="l00447"></a>00447     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00448"></a>00448 }
<a name="l00449"></a>00449 
<a name="l00450"></a><a class="code" href="lsm__convert_8hpp.html#a3c22a0b83c21328d60982f0bb34697f9">00450</a> <a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> **<a class="code" href="lsm__convert_8cpp.html#a51a29cecee9f41acf8278106802a9c00">value_to_block_range_list</a>(<a class="code" href="class_value.html">Value</a> &amp; brl, uint32_t * count)
<a name="l00451"></a>00451 {
<a name="l00452"></a>00452     <a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> **rc = NULL;
<a name="l00453"></a>00453     std::vector &lt; Value &gt; r = brl.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00454"></a>00454     *count = r.size();
<a name="l00455"></a>00455     <span class="keywordflow">if</span> (*count) {
<a name="l00456"></a>00456         rc = <a class="code" href="libstoragemgmt__blockrange_8h.html#a4e57003925f97a4a99fd7d8edb962e0c">lsm_block_range_record_array_alloc</a>(*count);
<a name="l00457"></a>00457         <span class="keywordflow">if</span> (rc) {
<a name="l00458"></a>00458             <span class="keywordflow">for</span> (uint32_t i = 0; i &lt; *count; ++i) {
<a name="l00459"></a>00459                 rc[i] = <a class="code" href="lsm__convert_8cpp.html#a0a8b905122236b482248b103c7c650ee">value_to_block_range</a>(r[i]);
<a name="l00460"></a>00460                 <span class="keywordflow">if</span> (!rc[i]) {
<a name="l00461"></a>00461                     <a class="code" href="libstoragemgmt__blockrange_8h.html#ad2b483b9743937c1e1aa7cbca6dac496">lsm_block_range_record_array_free</a>(rc, i);
<a name="l00462"></a>00462                     rc = NULL;
<a name="l00463"></a>00463                     <span class="keywordflow">break</span>;
<a name="l00464"></a>00464                 }
<a name="l00465"></a>00465             }
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468     <span class="keywordflow">return</span> rc;
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="lsm__convert_8hpp.html#add6a0428ba40fbb65f5b9d8184efdd7d">00471</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#af18efaa31b0a3e0c1c9fe28b044b6912">block_range_list_to_value</a>(<a class="code" href="struct__lsm__block__range.html">lsm_block_range</a> ** brl, uint32_t count)
<a name="l00472"></a>00472 {
<a name="l00473"></a>00473     std::vector &lt; Value &gt; r;
<a name="l00474"></a>00474     <span class="keywordflow">if</span> (brl &amp;&amp; count) {
<a name="l00475"></a>00475         uint32_t i = 0;
<a name="l00476"></a>00476         r.reserve(count);
<a name="l00477"></a>00477         <span class="keywordflow">for</span> (i = 0; i &lt; count; ++i) {
<a name="l00478"></a>00478             r.push_back(<a class="code" href="lsm__convert_8cpp.html#a333d15f6396e1cc7a7d16daa911259e9">block_range_to_value</a>(brl[i]));
<a name="l00479"></a>00479         }
<a name="l00480"></a>00480     }
<a name="l00481"></a>00481     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(r);
<a name="l00482"></a>00482 }
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="lsm__convert_8hpp.html#a1bcc5638cfc11ef7f14ce085928c8cb9">00484</a> <a class="code" href="struct__lsm__fs.html">lsm_fs</a> *<a class="code" href="lsm__convert_8cpp.html#a4524b752397b802dd48ff9ba2ec9db49">value_to_fs</a>(<a class="code" href="class_value.html">Value</a> &amp; fs)
<a name="l00485"></a>00485 {
<a name="l00486"></a>00486     <a class="code" href="struct__lsm__fs.html">lsm_fs</a> *rc = NULL;
<a name="l00487"></a>00487     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(fs, <a class="code" href="lsm__convert_8hpp.html#ab6f99c4814431bb0466e00bc2754c526">CLASS_NAME_FILE_SYSTEM</a>)) {
<a name="l00488"></a>00488         std::map &lt; std::string, Value &gt; f = fs.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a4115b155d3fa3bec1f2f62985d414cda">lsm_fs_record_alloc</a>(f[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00491"></a>00491                                  f[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00492"></a>00492                                  f[<span class="stringliteral">&quot;total_space&quot;</span>].asUint64_t(),
<a name="l00493"></a>00493                                  f[<span class="stringliteral">&quot;free_space&quot;</span>].asUint64_t(),
<a name="l00494"></a>00494                                  f[<span class="stringliteral">&quot;pool_id&quot;</span>].asString().c_str(),
<a name="l00495"></a>00495                                  f[<span class="stringliteral">&quot;system_id&quot;</span>].asString().c_str(),
<a name="l00496"></a>00496                                  f[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00497"></a>00497     } <span class="keywordflow">else</span> {
<a name="l00498"></a>00498         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_fs: Not correct type&quot;</span>);
<a name="l00499"></a>00499     }
<a name="l00500"></a>00500     <span class="keywordflow">return</span> rc;
<a name="l00501"></a>00501 }
<a name="l00502"></a>00502 
<a name="l00503"></a><a class="code" href="lsm__convert_8hpp.html#a28fca3d8f8904ccd2ce8cc10b62dd5d3">00503</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a78748fff4e31bd57c1c899024677dbaf">fs_to_value</a>(<a class="code" href="struct__lsm__fs.html">lsm_fs</a> * fs)
<a name="l00504"></a>00504 {
<a name="l00505"></a>00505     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#ac6c84aca55b5121f0771751d73195d34">LSM_IS_FS</a>(fs)) {
<a name="l00506"></a>00506         std::map &lt; std::string, Value &gt; f;
<a name="l00507"></a>00507         f[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#ab6f99c4814431bb0466e00bc2754c526">CLASS_NAME_FILE_SYSTEM</a>);
<a name="l00508"></a>00508         f[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00509"></a>00509         f[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00510"></a>00510         f[<span class="stringliteral">&quot;total_space&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#a4dce9caf4986bff088cab52cef06b38b">total_space</a>);
<a name="l00511"></a>00511         f[<span class="stringliteral">&quot;free_space&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#aae4ce9805bb100f2dbbfefec7971149e">free_space</a>);
<a name="l00512"></a>00512         f[<span class="stringliteral">&quot;pool_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#a661fc053a909f8c5d3cff89c856fed89">pool_id</a>);
<a name="l00513"></a>00513         f[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#adbcb53aefea45e3a3ec73b9db52b8fc0">system_id</a>);
<a name="l00514"></a>00514         f[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(fs-&gt;<a class="code" href="struct__lsm__fs.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00515"></a>00515         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(f);
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00518"></a>00518 }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520 
<a name="l00521"></a><a class="code" href="lsm__convert_8hpp.html#a380329886c03e675bb80fc487ebb7177">00521</a> <a class="code" href="struct__lsm__fs__ss.html">lsm_fs_ss</a> *<a class="code" href="lsm__convert_8cpp.html#a6018acc6f5e2ae46dfa37a94f17b347b">value_to_ss</a>(<a class="code" href="class_value.html">Value</a> &amp; ss)
<a name="l00522"></a>00522 {
<a name="l00523"></a>00523     <a class="code" href="struct__lsm__fs__ss.html">lsm_fs_ss</a> *rc = NULL;
<a name="l00524"></a>00524     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(ss, <a class="code" href="lsm__convert_8hpp.html#a78189bfc1ac638165ed7df9778d0b32a">CLASS_NAME_FS_SNAPSHOT</a>)) {
<a name="l00525"></a>00525         std::map &lt; std::string, Value &gt; f = ss.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00526"></a>00526 
<a name="l00527"></a>00527         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#ad0e0152a5768ddd97b5bf14626c51405">lsm_fs_ss_record_alloc</a>(f[<span class="stringliteral">&quot;id&quot;</span>].asString().c_str(),
<a name="l00528"></a>00528                                     f[<span class="stringliteral">&quot;name&quot;</span>].asString().c_str(),
<a name="l00529"></a>00529                                     f[<span class="stringliteral">&quot;ts&quot;</span>].asUint64_t(),
<a name="l00530"></a>00530                                     f[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00531"></a>00531     } <span class="keywordflow">else</span> {
<a name="l00532"></a>00532         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_ss: Not correct type&quot;</span>);
<a name="l00533"></a>00533     }
<a name="l00534"></a>00534     <span class="keywordflow">return</span> rc;
<a name="l00535"></a>00535 }
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="lsm__convert_8hpp.html#aa2604453fb9a838719a9090100bf4011">00537</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#ac8379996cc9809a020beb41156e400e0">ss_to_value</a>(<a class="code" href="struct__lsm__fs__ss.html">lsm_fs_ss</a> * ss)
<a name="l00538"></a>00538 {
<a name="l00539"></a>00539     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a37dae4d4d2db3247d87103986edcff3c">LSM_IS_SS</a>(ss)) {
<a name="l00540"></a>00540         std::map &lt; std::string, Value &gt; f;
<a name="l00541"></a>00541         f[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a78189bfc1ac638165ed7df9778d0b32a">CLASS_NAME_FS_SNAPSHOT</a>);
<a name="l00542"></a>00542         f[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(ss-&gt;<a class="code" href="struct__lsm__fs__ss.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00543"></a>00543         f[<span class="stringliteral">&quot;name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(ss-&gt;<a class="code" href="struct__lsm__fs__ss.html#a5ac083a645d964373f022d03df4849c8">name</a>);
<a name="l00544"></a>00544         f[<span class="stringliteral">&quot;ts&quot;</span>] = <a class="code" href="class_value.html">Value</a>(ss-&gt;<a class="code" href="struct__lsm__fs__ss.html#a131a989fbc337ab14b4d6b81de3506a6">ts</a>);
<a name="l00545"></a>00545         f[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(ss-&gt;<a class="code" href="struct__lsm__fs__ss.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00546"></a>00546         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(f);
<a name="l00547"></a>00547     }
<a name="l00548"></a>00548     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00549"></a>00549 }
<a name="l00550"></a>00550 
<a name="l00551"></a><a class="code" href="lsm__convert_8hpp.html#a6f1110053d87b194e70fe3167b9b6acc">00551</a> <a class="code" href="struct__lsm__nfs__export.html">lsm_nfs_export</a> *<a class="code" href="lsm__convert_8cpp.html#aa230aa3280cfdd3ddb65372710954a3f">value_to_nfs_export</a>(<a class="code" href="class_value.html">Value</a> &amp; exp)
<a name="l00552"></a>00552 {
<a name="l00553"></a>00553     <a class="code" href="struct__lsm__nfs__export.html">lsm_nfs_export</a> *rc = NULL;
<a name="l00554"></a>00554     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(exp, <a class="code" href="lsm__convert_8hpp.html#a1039b145b05714ba7349baa6d89488af">CLASS_NAME_FS_EXPORT</a>)) {
<a name="l00555"></a>00555         <span class="keywordtype">int</span> ok = 0;
<a name="l00556"></a>00556         <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *root = NULL;
<a name="l00557"></a>00557         <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *rw = NULL;
<a name="l00558"></a>00558         <a class="code" href="struct__lsm__string__list.html">lsm_string_list</a> *ro = NULL;
<a name="l00559"></a>00559 
<a name="l00560"></a>00560         std::map &lt; std::string, Value &gt; i = exp.<a class="code" href="class_value.html#a3c222a89b5735e557bef01119328c50c">asObject</a>();
<a name="l00561"></a>00561 
<a name="l00562"></a>00562         <span class="comment">/* Check all the arrays for successful allocation */</span>
<a name="l00563"></a>00563         root = <a class="code" href="lsm__convert_8cpp.html#ab5eeee745fbaa40daddfa60c77567d18">value_to_string_list</a>(i[<span class="stringliteral">&quot;root&quot;</span>]);
<a name="l00564"></a>00564         <span class="keywordflow">if</span> (root) {
<a name="l00565"></a>00565             rw = <a class="code" href="lsm__convert_8cpp.html#ab5eeee745fbaa40daddfa60c77567d18">value_to_string_list</a>(i[<span class="stringliteral">&quot;rw&quot;</span>]);
<a name="l00566"></a>00566             <span class="keywordflow">if</span> (rw) {
<a name="l00567"></a>00567                 ro = <a class="code" href="lsm__convert_8cpp.html#ab5eeee745fbaa40daddfa60c77567d18">value_to_string_list</a>(i[<span class="stringliteral">&quot;ro&quot;</span>]);
<a name="l00568"></a>00568                 <span class="keywordflow">if</span> (!ro) {
<a name="l00569"></a>00569                     <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(rw);
<a name="l00570"></a>00570                     <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(root);
<a name="l00571"></a>00571                     rw = NULL;
<a name="l00572"></a>00572                     root = NULL;
<a name="l00573"></a>00573                 } <span class="keywordflow">else</span> {
<a name="l00574"></a>00574                     ok = 1;
<a name="l00575"></a>00575                 }
<a name="l00576"></a>00576             } <span class="keywordflow">else</span> {
<a name="l00577"></a>00577                 <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(root);
<a name="l00578"></a>00578                 root = NULL;
<a name="l00579"></a>00579             }
<a name="l00580"></a>00580         }
<a name="l00581"></a>00581 
<a name="l00582"></a>00582         <span class="keywordflow">if</span> (ok) {
<a name="l00583"></a>00583             rc = <a class="code" href="libstoragemgmt__nfsexport_8h.html#a77b9131d25585c7ae45d47624978832b">lsm_nfs_export_record_alloc</a>(i[<span class="stringliteral">&quot;id&quot;</span>].asC_str(),
<a name="l00584"></a>00584                                              i[<span class="stringliteral">&quot;fs_id&quot;</span>].asC_str(),
<a name="l00585"></a>00585                                              i[<span class="stringliteral">&quot;export_path&quot;</span>].asC_str(),
<a name="l00586"></a>00586                                              i[<span class="stringliteral">&quot;auth&quot;</span>].asC_str(),
<a name="l00587"></a>00587                                              root,
<a name="l00588"></a>00588                                              rw,
<a name="l00589"></a>00589                                              ro,
<a name="l00590"></a>00590                                              i[<span class="stringliteral">&quot;anonuid&quot;</span>].asUint64_t(),
<a name="l00591"></a>00591                                              i[<span class="stringliteral">&quot;anongid&quot;</span>].asUint64_t(),
<a name="l00592"></a>00592                                              i[<span class="stringliteral">&quot;options&quot;</span>].asC_str(),
<a name="l00593"></a>00593                                              i[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00594"></a>00594 
<a name="l00595"></a>00595             <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(root);
<a name="l00596"></a>00596             <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(rw);
<a name="l00597"></a>00597             <a class="code" href="libstoragemgmt__common_8h.html#a0042977fcc59a5907892dcd5e907b891">lsm_string_list_free</a>(ro);
<a name="l00598"></a>00598         }
<a name="l00599"></a>00599     } <span class="keywordflow">else</span> {
<a name="l00600"></a>00600         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_nfs_export: Not correct type&quot;</span>);
<a name="l00601"></a>00601     }
<a name="l00602"></a>00602     <span class="keywordflow">return</span> rc;
<a name="l00603"></a>00603 }
<a name="l00604"></a>00604 
<a name="l00605"></a><a class="code" href="lsm__convert_8hpp.html#ae28859b404cc31d2882ac564081e4397">00605</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#aecf21606b00030de94f75103d312cba0">nfs_export_to_value</a>(<a class="code" href="struct__lsm__nfs__export.html">lsm_nfs_export</a> * exp)
<a name="l00606"></a>00606 {
<a name="l00607"></a>00607     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#a12393f4cf6c858d933aff5a72f71b8d7">LSM_IS_NFS_EXPORT</a>(exp)) {
<a name="l00608"></a>00608         std::map &lt; std::string, Value &gt; f;
<a name="l00609"></a>00609         f[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a1039b145b05714ba7349baa6d89488af">CLASS_NAME_FS_EXPORT</a>);
<a name="l00610"></a>00610         f[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#aecb3b0d045ada529257a2fbf8f829599">id</a>);
<a name="l00611"></a>00611         f[<span class="stringliteral">&quot;fs_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a4a87b08681254cd602bc147e5864ae9a">fs_id</a>);
<a name="l00612"></a>00612         f[<span class="stringliteral">&quot;export_path&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#ac37a3d3d79441a72373824e7afd738bf">export_path</a>);
<a name="l00613"></a>00613         f[<span class="stringliteral">&quot;auth&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a33ce157d9d115f061286d399648e8c92">auth_type</a>);
<a name="l00614"></a>00614         f[<span class="stringliteral">&quot;root&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8cpp.html#ab12e4a58efa188d9b9ccbad5bf4a60a9">string_list_to_value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a6c649eaed0b396edcd549ea93c9f9003">root</a>));
<a name="l00615"></a>00615         f[<span class="stringliteral">&quot;rw&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8cpp.html#ab12e4a58efa188d9b9ccbad5bf4a60a9">string_list_to_value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a0c7041077a8ee6605d32a65d0f483b89">rw</a>));
<a name="l00616"></a>00616         f[<span class="stringliteral">&quot;ro&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8cpp.html#ab12e4a58efa188d9b9ccbad5bf4a60a9">string_list_to_value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a9c5a035f6759852ded3de5fb3cfd62e0">ro</a>));
<a name="l00617"></a>00617         f[<span class="stringliteral">&quot;anonuid&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a81725ed5790c9f2d71fae6d76e67c026">anonuid</a>);
<a name="l00618"></a>00618         f[<span class="stringliteral">&quot;anongid&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#aecbfa85ca4467b390eec9ae4b4cf03f5">anongid</a>);
<a name="l00619"></a>00619         f[<span class="stringliteral">&quot;options&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#ad358cb7ece4fc65136f8d20cf6b12816">options</a>);
<a name="l00620"></a>00620         f[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(exp-&gt;<a class="code" href="struct__lsm__nfs__export.html#a106989f4c82e470fac30447a3fb29be3">plugin_data</a>);
<a name="l00621"></a>00621         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(f);
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 }
<a name="l00626"></a>00626 
<a name="l00627"></a><a class="code" href="lsm__convert_8hpp.html#a7f979320dc55e061723623a10436153d">00627</a> <a class="code" href="struct__lsm__storage__capabilities.html">lsm_storage_capabilities</a> *<a class="code" href="lsm__convert_8cpp.html#af939e3d9e018e658a393fff22cf95256">value_to_capabilities</a>(<a class="code" href="class_value.html">Value</a> &amp; exp)
<a name="l00628"></a>00628 {
<a name="l00629"></a>00629     <a class="code" href="struct__lsm__storage__capabilities.html">lsm_storage_capabilities</a> *rc = NULL;
<a name="l00630"></a>00630     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(exp, <a class="code" href="lsm__convert_8hpp.html#abefd05c5c259e963052dc597b490d590">CLASS_NAME_CAPABILITIES</a>)) {
<a name="l00631"></a>00631         <span class="keyword">const</span> <span class="keywordtype">char</span> *val = exp[<span class="stringliteral">&quot;cap&quot;</span>].<a class="code" href="class_value.html#a0886eb191cb3d5f35daef2e5f1dca079">asC_str</a>();
<a name="l00632"></a>00632         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a90589ade474e967778346d2bf535025f">lsm_capability_record_alloc</a>(val);
<a name="l00633"></a>00633     } <span class="keywordflow">else</span> {
<a name="l00634"></a>00634         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_capabilities: Not correct type&quot;</span>);
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636     <span class="keywordflow">return</span> rc;
<a name="l00637"></a>00637 }
<a name="l00638"></a>00638 
<a name="l00639"></a><a class="code" href="lsm__convert_8hpp.html#afbf97bd3776989fe80300731d1bed6a4">00639</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#ad2a19637be28627243da17ac6f4b5343">capabilities_to_value</a>(<a class="code" href="struct__lsm__storage__capabilities.html">lsm_storage_capabilities</a> * cap)
<a name="l00640"></a>00640 {
<a name="l00641"></a>00641     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#ade8da308a7805789f46a37df671037d9">LSM_IS_CAPABILITIY</a>(cap)) {
<a name="l00642"></a>00642         std::map &lt; std::string, Value &gt; c;
<a name="l00643"></a>00643         <span class="keywordtype">char</span> *t = <a class="code" href="lsm__datatypes_8hpp.html#a762c41893ec222115fa1a8cf511b8e29">capability_string</a>(cap);
<a name="l00644"></a>00644         c[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#abefd05c5c259e963052dc597b490d590">CLASS_NAME_CAPABILITIES</a>);
<a name="l00645"></a>00645         c[<span class="stringliteral">&quot;cap&quot;</span>] = <a class="code" href="class_value.html">Value</a>(t);
<a name="l00646"></a>00646         free(t);
<a name="l00647"></a>00647         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(c);
<a name="l00648"></a>00648     }
<a name="l00649"></a>00649     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00650"></a>00650 }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652 
<a name="l00653"></a><a class="code" href="lsm__convert_8hpp.html#a1bb45c28ec1b7fa836cfb4d3da7a31a8">00653</a> lsm_target_port *<a class="code" href="lsm__convert_8cpp.html#a8147ed8ed6311fdac25bcaa1010ce3db">value_to_target_port</a>(<a class="code" href="class_value.html">Value</a> &amp; <a class="code" href="lsm__plugin__ipc_8cpp.html#a70a32bd2be98dd0919402d512789b467">tp</a>)
<a name="l00654"></a>00654 {
<a name="l00655"></a>00655     lsm_target_port *rc = NULL;
<a name="l00656"></a>00656     <span class="keywordflow">if</span> (<a class="code" href="lsm__convert_8cpp.html#a6feccb6882b08bd4343d1bb53c3fe523">is_expected_object</a>(tp, <a class="code" href="lsm__convert_8hpp.html#a5227589143e5cff2e6ab2635b02d8737">CLASS_NAME_TARGET_PORT</a>)) {
<a name="l00657"></a>00657         rc = <a class="code" href="libstoragemgmt__plug__interface_8h.html#a81e235086f9eb6133e4269b85b46025f">lsm_target_port_record_alloc</a>(tp[<span class="stringliteral">&quot;id&quot;</span>].asC_str(),
<a name="l00658"></a>00658                                           (<a class="code" href="libstoragemgmt__types_8h.html#a940ab50a3061647459a7d3b4cb5e5109">lsm_target_port_type</a>)
<a name="l00659"></a>00659                                           tp[<span class="stringliteral">&quot;port_type&quot;</span>].asInt32_t(),
<a name="l00660"></a>00660                                           tp[<span class="stringliteral">&quot;service_address&quot;</span>].asC_str(),
<a name="l00661"></a>00661                                           tp[<span class="stringliteral">&quot;network_address&quot;</span>].asC_str(),
<a name="l00662"></a>00662                                           tp[<span class="stringliteral">&quot;physical_address&quot;</span>].asC_str(),
<a name="l00663"></a>00663                                           tp[<span class="stringliteral">&quot;physical_name&quot;</span>].asC_str(),
<a name="l00664"></a>00664                                           tp[<span class="stringliteral">&quot;system_id&quot;</span>].asC_str(),
<a name="l00665"></a>00665                                           tp[<span class="stringliteral">&quot;plugin_data&quot;</span>].asC_str());
<a name="l00666"></a>00666     } <span class="keywordflow">else</span> {
<a name="l00667"></a>00667         <span class="keywordflow">throw</span> <a class="code" href="class_value_exception.html">ValueException</a>(<span class="stringliteral">&quot;value_to_target_port: Not correct type&quot;</span>);
<a name="l00668"></a>00668     }
<a name="l00669"></a>00669     <span class="keywordflow">return</span> rc;
<a name="l00670"></a>00670 }
<a name="l00671"></a>00671 
<a name="l00672"></a><a class="code" href="lsm__convert_8hpp.html#af6cc4593720b89aed7efbcce336da555">00672</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#acd3168d0063036adb4d348a83fdf91ae">target_port_to_value</a>(lsm_target_port * <a class="code" href="lsm__plugin__ipc_8cpp.html#a70a32bd2be98dd0919402d512789b467">tp</a>)
<a name="l00673"></a>00673 {
<a name="l00674"></a>00674     <span class="keywordflow">if</span> (<a class="code" href="lsm__datatypes_8hpp.html#aa90df4cdb792647ecc160f8f8fa491fc">LSM_IS_TARGET_PORT</a>(tp)) {
<a name="l00675"></a>00675         std::map &lt; std::string, Value &gt; <a class="code" href="lsm__datatypes_8cpp.html#a839528ec4ac9ec17126e8e2e1d46e9fe">p</a>;
<a name="l00676"></a>00676         p[<span class="stringliteral">&quot;class&quot;</span>] = <a class="code" href="class_value.html">Value</a>(<a class="code" href="lsm__convert_8hpp.html#a5227589143e5cff2e6ab2635b02d8737">CLASS_NAME_TARGET_PORT</a>);
<a name="l00677"></a>00677         p[<span class="stringliteral">&quot;id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;id);
<a name="l00678"></a>00678         p[<span class="stringliteral">&quot;port_type&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;port_type);
<a name="l00679"></a>00679         p[<span class="stringliteral">&quot;service_address&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;service_address);
<a name="l00680"></a>00680         p[<span class="stringliteral">&quot;network_address&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;network_address);
<a name="l00681"></a>00681         p[<span class="stringliteral">&quot;physical_address&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;physical_address);
<a name="l00682"></a>00682         p[<span class="stringliteral">&quot;physical_name&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;physical_name);
<a name="l00683"></a>00683         p[<span class="stringliteral">&quot;system_id&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;system_id);
<a name="l00684"></a>00684         p[<span class="stringliteral">&quot;plugin_data&quot;</span>] = <a class="code" href="class_value.html">Value</a>(tp-&gt;plugin_data);
<a name="l00685"></a>00685         <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>(p);
<a name="l00686"></a>00686     }
<a name="l00687"></a>00687     <span class="keywordflow">return</span> <a class="code" href="class_value.html">Value</a>();
<a name="l00688"></a>00688 }
<a name="l00689"></a>00689 
<a name="l00690"></a><a class="code" href="lsm__convert_8hpp.html#a43a82e30631ffc25d1fd210ed6afda40">00690</a> <span class="keywordtype">int</span> <a class="code" href="lsm__convert_8cpp.html#a258000126e651dcaf2a019cd3a012dc4">values_to_uint32_array</a>(<a class="code" href="class_value.html">Value</a> &amp; value, uint32_t ** uint32_array,
<a name="l00691"></a>00691                            uint32_t * count)
<a name="l00692"></a>00692 {
<a name="l00693"></a>00693     <span class="keywordtype">int</span> rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2aa6e5b7f4231db2232f0d778e40a2cfb9">LSM_ERR_OK</a>;
<a name="l00694"></a>00694     *count = 0;
<a name="l00695"></a>00695     <span class="keywordflow">try</span> {
<a name="l00696"></a>00696         std::vector &lt; Value &gt; data = value.<a class="code" href="class_value.html#aa71bbb95edbd20e16fa01374cccb6268">asArray</a>();
<a name="l00697"></a>00697         *count = data.size();
<a name="l00698"></a>00698         <span class="keywordflow">if</span> (*count) {
<a name="l00699"></a>00699             *uint32_array = (uint32_t *) malloc(<span class="keyword">sizeof</span>(uint32_t) * *count);
<a name="l00700"></a>00700             <span class="keywordflow">if</span> (*uint32_array) {
<a name="l00701"></a>00701                 uint32_t i;
<a name="l00702"></a>00702                 <span class="keywordflow">for</span> (i = 0; i &lt; *count; i++) {
<a name="l00703"></a>00703                     (*uint32_array)[i] = data[i].asUint32_t();
<a name="l00704"></a>00704                 }
<a name="l00705"></a>00705             } <span class="keywordflow">else</span> {
<a name="l00706"></a>00706                 rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2a8ee2028c76795f31458b96762c86ac44">LSM_ERR_NO_MEMORY</a>;
<a name="l00707"></a>00707             }
<a name="l00708"></a>00708         }
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710     <span class="keywordflow">catch</span>(<span class="keyword">const</span> <a class="code" href="class_value_exception.html">ValueException</a> &amp; ve) {
<a name="l00711"></a>00711         <span class="keywordflow">if</span> (*count) {
<a name="l00712"></a>00712             free(*uint32_array);
<a name="l00713"></a>00713             *uint32_array = NULL;
<a name="l00714"></a>00714             *count = 0;
<a name="l00715"></a>00715         }
<a name="l00716"></a>00716         rc = <a class="code" href="libstoragemgmt__error_8h.html#ab4e2804e401f62fc5e0b73b88929cff2ac64627333f5366a9782886af7ec8ab28">LSM_ERR_LIB_BUG</a>;
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718     <span class="keywordflow">return</span> rc;
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a><a class="code" href="lsm__convert_8hpp.html#a7d26f4c30414e6b120d0b7521d5ac24e">00721</a> <a class="code" href="class_value.html">Value</a> <a class="code" href="lsm__convert_8cpp.html#a87a3bbc131dd293e1d8bf61b31cde137">uint32_array_to_value</a>(uint32_t * uint32_array, uint32_t count)
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723     std::vector &lt; Value &gt; rc;
<a name="l00724"></a>00724     <span class="keywordflow">if</span> (uint32_array &amp;&amp; count) {
<a name="l00725"></a>00725         uint32_t i;
<a name="l00726"></a>00726         rc.reserve(count);
<a name="l00727"></a>00727         <span class="keywordflow">for</span> (i = 0; i &lt; count; i++) {
<a name="l00728"></a>00728             rc.push_back(uint32_array[i]);
<a name="l00729"></a>00729         }
<a name="l00730"></a>00730     }
<a name="l00731"></a>00731     <span class="keywordflow">return</span> rc;
<a name="l00732"></a>00732 }
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 9 Jul 2015 for libStorageMgmt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
