<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libStorageMgmt: cmdline.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>cmdline.py</h1><a href="cmdline_8py.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a><a class="code" href="namespacelsmcli_1_1cmdline.html">00001</a> <span class="comment"># Copyright (C) 2012-2014 Red Hat, Inc.</span>
<a name="l00002"></a>00002 <span class="comment"># This library is free software; you can redistribute it and/or</span>
<a name="l00003"></a>00003 <span class="comment"># modify it under the terms of the GNU Lesser General Public</span>
<a name="l00004"></a>00004 <span class="comment"># License as published by the Free Software Foundation; either</span>
<a name="l00005"></a>00005 <span class="comment"># version 2.1 of the License, or any later version.</span>
<a name="l00006"></a>00006 <span class="comment">#</span>
<a name="l00007"></a>00007 <span class="comment"># This library is distributed in the hope that it will be useful,</span>
<a name="l00008"></a>00008 <span class="comment"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00009"></a>00009 <span class="comment"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
<a name="l00010"></a>00010 <span class="comment"># Lesser General Public License for more details.</span>
<a name="l00011"></a>00011 <span class="comment">#</span>
<a name="l00012"></a>00012 <span class="comment"># You should have received a copy of the GNU Lesser General Public</span>
<a name="l00013"></a>00013 <span class="comment"># License along with this library; If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="l00014"></a>00014 <span class="comment">#</span>
<a name="l00015"></a>00015 <span class="comment"># Author: tasleson</span>
<a name="l00016"></a>00016 <span class="comment">#         Gris Ge &lt;fge@redhat.com&gt;</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="keyword">import</span> os
<a name="l00019"></a>00019 <span class="keyword">import</span> sys
<a name="l00020"></a>00020 <span class="keyword">import</span> getpass
<a name="l00021"></a>00021 <span class="keyword">import</span> time
<a name="l00022"></a>00022 <span class="keyword">import</span> tty
<a name="l00023"></a>00023 <span class="keyword">import</span> termios
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 <span class="keywordflow">try</span>:
<a name="l00026"></a>00026     <span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict
<a name="l00027"></a>00027 <span class="keywordflow">except</span> ImportError:
<a name="l00028"></a>00028     <span class="comment"># python 2.6 or earlier, use backport</span>
<a name="l00029"></a>00029     <span class="keyword">from</span> ordereddict <span class="keyword">import</span> OrderedDict
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="keyword">from</span> argparse <span class="keyword">import</span> ArgumentParser
<a name="l00032"></a>00032 <span class="keyword">from</span> argparse <span class="keyword">import</span> RawTextHelpFormatter
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="keyword">from</span> lsm <span class="keyword">import</span> (Client, Pool, VERSION, LsmError, Disk,
<a name="l00035"></a>00035                  Volume, JobStatus, ErrorNumber, BlockRange,
<a name="l00036"></a>00036                  uri_parse, Proxy, size_human_2_size_bytes,
<a name="l00037"></a>00037                  AccessGroup, FileSystem, NfsExport, TargetPort)
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">from</span> lsm.lsmcli.data_display <span class="keyword">import</span> (
<a name="l00040"></a>00040     DisplayData, PlugData, out,
<a name="l00041"></a>00041     vol_provision_str_to_type, vol_rep_type_str_to_type, VolumeRAIDInfo,
<a name="l00042"></a>00042     PoolRAIDInfo, VcrCap)
<a name="l00043"></a>00043 
<a name="l00044"></a>00044 
<a name="l00045"></a>00045 <span class="comment">## Wraps the invocation to the command line</span>
<a name="l00046"></a>00046 <span class="comment"># @param    c   Object to invoke calls on (optional)</span>
<a name="l00047"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a31682a41bbe2b58bc7f844d9b42331df">00047</a> <span class="keyword">def </span><a class="code" href="namespacelsmcli_1_1cmdline.html#a31682a41bbe2b58bc7f844d9b42331df" title="Wraps the invocation to the command line.">cmd_line_wrapper</a>(c=None):
<a name="l00048"></a>00048     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00049"></a>00049 <span class="stringliteral">    Common command line code, called.</span>
<a name="l00050"></a>00050 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00051"></a>00051     err_exit = 0
<a name="l00052"></a>00052     cli = <span class="keywordtype">None</span>
<a name="l00053"></a>00053 
<a name="l00054"></a>00054     <span class="keywordflow">try</span>:
<a name="l00055"></a>00055         cli = CmdLine()
<a name="l00056"></a>00056         cli.process(c)
<a name="l00057"></a>00057     <span class="keywordflow">except</span> ArgError <span class="keyword">as</span> ae:
<a name="l00058"></a>00058         sys.stderr.write(str(ae))
<a name="l00059"></a>00059         sys.stderr.flush()
<a name="l00060"></a>00060         err_exit = 2
<a name="l00061"></a>00061     <span class="keywordflow">except</span> LsmError <span class="keyword">as</span> le:
<a name="l00062"></a>00062         sys.stderr.write(str(le) + <span class="stringliteral">&quot;\n&quot;</span>)
<a name="l00063"></a>00063         sys.stderr.flush()
<a name="l00064"></a>00064         err_exit = 4
<a name="l00065"></a>00065     <span class="keywordflow">except</span> KeyboardInterrupt:
<a name="l00066"></a>00066         err_exit = 1
<a name="l00067"></a>00067     <span class="keywordflow">except</span> SystemExit <span class="keyword">as</span> se:
<a name="l00068"></a>00068         <span class="comment"># argparse raises a SystemExit</span>
<a name="l00069"></a>00069         err_exit = se.code
<a name="l00070"></a>00070     <span class="keywordflow">except</span>:
<a name="l00071"></a>00071         <span class="comment"># We get *any* other exception don&apos;t return a successful error code</span>
<a name="l00072"></a>00072         err_exit = 2
<a name="l00073"></a>00073     <span class="keywordflow">finally</span>:
<a name="l00074"></a>00074         <span class="comment"># Regardless of what happens, we will try to close the connection if</span>
<a name="l00075"></a>00075         <span class="comment"># possible to allow the plugin to clean up gracefully.</span>
<a name="l00076"></a>00076         <span class="keywordflow">if</span> cli:
<a name="l00077"></a>00077             <span class="keywordflow">try</span>:
<a name="l00078"></a>00078                 <span class="comment"># This will exit if are successful</span>
<a name="l00079"></a>00079                 cli.shutdown(err_exit)
<a name="l00080"></a>00080             <span class="keywordflow">except</span> Exception:
<a name="l00081"></a>00081                 <span class="keywordflow">pass</span>
<a name="l00082"></a>00082         sys.exit(err_exit)
<a name="l00083"></a>00083 
<a name="l00084"></a>00084 
<a name="l00085"></a>00085 <span class="comment">## Get a character from stdin without needing a return key pressed.</span>
<a name="l00086"></a>00086 <span class="comment"># Returns the character pressed</span>
<a name="l00087"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a8987abef1d1f0de679829b37d0c6a4f8">00087</a> <span class="keyword">def </span><a class="code" href="namespacelsmcli_1_1cmdline.html#a8987abef1d1f0de679829b37d0c6a4f8" title="Get a character from stdin without needing a return key pressed.">getch</a>():
<a name="l00088"></a>00088     fd = sys.stdin.fileno()
<a name="l00089"></a>00089     prev = termios.tcgetattr(fd)
<a name="l00090"></a>00090     <span class="keywordflow">try</span>:
<a name="l00091"></a>00091         tty.setraw(sys.stdin.fileno())
<a name="l00092"></a>00092         ch = sys.stdin.read(1)
<a name="l00093"></a>00093     <span class="keywordflow">finally</span>:
<a name="l00094"></a>00094         termios.tcsetattr(fd, termios.TCSADRAIN, prev)
<a name="l00095"></a>00095     <span class="keywordflow">return</span> ch
<a name="l00096"></a>00096 
<a name="l00097"></a>00097 
<a name="l00098"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a7181486f2da101df0b29af092cc4f910">00098</a> <span class="keyword">def </span><a class="code" href="namespacelsmcli_1_1cmdline.html#a7181486f2da101df0b29af092cc4f910">parse_convert_init</a>(init_id):
<a name="l00099"></a>00099     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00100"></a>00100 <span class="stringliteral">    If init_id is a WWPN, convert it into LSM standard version:</span>
<a name="l00101"></a>00101 <span class="stringliteral">        (?:[0-9a-f]{2}:){7}[0-9a-f]{2}</span>
<a name="l00102"></a>00102 <span class="stringliteral"></span>
<a name="l00103"></a>00103 <span class="stringliteral">    Return (converted_init_id, lsm_init_type)</span>
<a name="l00104"></a>00104 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00105"></a>00105     valid, init_type, init_id = AccessGroup.initiator_id_verify(init_id)
<a name="l00106"></a>00106 
<a name="l00107"></a>00107     <span class="keywordflow">if</span> valid:
<a name="l00108"></a>00108         <span class="keywordflow">return</span> (init_id, init_type)
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;--init-id %s is not a valid WWPN or iSCSI IQN&quot;</span> % init_id)
<a name="l00111"></a>00111 
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 <span class="comment">## This class represents a command line argument error</span>
<a name="l00114"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html">00114</a> <span class="keyword">class </span><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html" title="This class represents a command line argument error.">ArgError</a>(Exception):
<a name="l00115"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#ac775ee34451fdfa742b318538164070e">00115</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#ac775ee34451fdfa742b318538164070e">__init__</a>(self, message, *args, **kwargs):
<a name="l00116"></a>00116         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00117"></a>00117 <span class="stringliteral">        Class represents an error.</span>
<a name="l00118"></a>00118 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l00119"></a>00119         Exception.__init__(self, *args, **kwargs)
<a name="l00120"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#a10a0f35066079abd150539d0d13dbf3e">00120</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#a10a0f35066079abd150539d0d13dbf3e">msg</a> = message
<a name="l00121"></a>00121 
<a name="l00122"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#aa7a4b9bc0941308e362738503137460e">00122</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#aa7a4b9bc0941308e362738503137460e">__str__</a>(self):
<a name="l00123"></a>00123         <span class="keywordflow">return</span> <span class="stringliteral">&quot;%s: error: %s\n&quot;</span> % (os.path.basename(sys.argv[0]), self.<a class="code" href="classlsmcli_1_1cmdline_1_1_arg_error.html#a10a0f35066079abd150539d0d13dbf3e">msg</a>)
<a name="l00124"></a>00124 
<a name="l00125"></a>00125 
<a name="l00126"></a>00126 <span class="comment">## Finds an item based on the id.  Each list item requires a member &quot;id&quot;</span>
<a name="l00127"></a>00127 <span class="comment"># @param    l       list to search</span>
<a name="l00128"></a>00128 <span class="comment"># @param    the_id  the id to match</span>
<a name="l00129"></a>00129 <span class="comment"># @param    friendly_name - name to put in the exception saying what we</span>
<a name="l00130"></a>00130 <span class="comment">#           couldn&apos;t find</span>
<a name="l00131"></a>00131 <span class="keyword">def </span>_get_item(l, the_id, friendly_name=&apos;item&apos;, raise_error=True):
<a name="l00132"></a>00132     <span class="keywordflow">for</span> item <span class="keywordflow">in</span> l:
<a name="l00133"></a>00133         <span class="keywordflow">if</span> item.id == the_id:
<a name="l00134"></a>00134             <span class="keywordflow">return</span> item
<a name="l00135"></a>00135     <span class="keywordflow">if</span> raise_error:
<a name="l00136"></a>00136         <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&apos;%s with ID %s not found!&apos;</span> % (friendly_name, the_id))
<a name="l00137"></a>00137     <span class="keywordflow">else</span>:
<a name="l00138"></a>00138         <span class="keywordflow">return</span> <span class="keywordtype">None</span>
<a name="l00139"></a>00139 
<a name="l00140"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a825d781fb5e345da0109d684213bd4d7">00140</a> list_choices = [<span class="stringliteral">&apos;VOLUMES&apos;</span>, <span class="stringliteral">&apos;POOLS&apos;</span>, <span class="stringliteral">&apos;FS&apos;</span>, <span class="stringliteral">&apos;SNAPSHOTS&apos;</span>,
<a name="l00141"></a>00141                 <span class="stringliteral">&apos;EXPORTS&apos;</span>, <span class="stringliteral">&quot;NFS_CLIENT_AUTH&quot;</span>, <span class="stringliteral">&apos;ACCESS_GROUPS&apos;</span>,
<a name="l00142"></a>00142                 <span class="stringliteral">&apos;SYSTEMS&apos;</span>, <span class="stringliteral">&apos;DISKS&apos;</span>, <span class="stringliteral">&apos;PLUGINS&apos;</span>, <span class="stringliteral">&apos;TARGET_PORTS&apos;</span>]
<a name="l00143"></a>00143 
<a name="l00144"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a0298e55c71e9792ed0109afe8afe381a">00144</a> provision_types = (<span class="stringliteral">&apos;DEFAULT&apos;</span>, <span class="stringliteral">&apos;THIN&apos;</span>, <span class="stringliteral">&apos;FULL&apos;</span>)
<a name="l00145"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a7d90847c72286d09ab9c1b869e333fc3">00145</a> provision_help = <span class="stringliteral">&quot;provisioning type: &quot;</span> + <span class="stringliteral">&quot;, &quot;</span>.join(provision_types)
<a name="l00146"></a>00146 
<a name="l00147"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#acb3ec32cff10724b03124bb86e7393d4">00147</a> replicate_types = (<span class="stringliteral">&apos;CLONE&apos;</span>, <span class="stringliteral">&apos;COPY&apos;</span>, <span class="stringliteral">&apos;MIRROR_ASYNC&apos;</span>, <span class="stringliteral">&apos;MIRROR_SYNC&apos;</span>)
<a name="l00148"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#ac03e779408113168a4cd8320cb6ccad6">00148</a> replicate_help = <span class="stringliteral">&quot;replication type: &quot;</span> + <span class="stringliteral">&quot;, &quot;</span>.join(replicate_types)
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a82774e735e5f31f026d24ef4f549dfb5">00150</a> size_help = <span class="stringliteral">&apos;Can use B, KiB, MiB, GiB, TiB, PiB postfix (IEC sizing)&apos;</span>
<a name="l00151"></a>00151 
<a name="l00152"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#ae845e85d37e9c5d66871f17526cc101f">00152</a> sys_id_opt = dict(name=<span class="stringliteral">&apos;--sys&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;SYS_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;System ID&apos;</span>)
<a name="l00153"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a3614efae26b82fdcb4f2705e55d83cb0">00153</a> sys_id_filter_opt = sys_id_opt.copy()
<a name="l00154"></a>00154 sys_id_filter_opt[<span class="stringliteral">&apos;help&apos;</span>] = <span class="stringliteral">&apos;Search by System ID&apos;</span>
<a name="l00155"></a>00155 
<a name="l00156"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a69ecd583916b78d7395059c2ce536613">00156</a> pool_id_opt = dict(name=<span class="stringliteral">&apos;--pool&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;POOL_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Pool ID&apos;</span>)
<a name="l00157"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a73de310cb7e95278458718071ab15e69">00157</a> pool_id_filter_opt = pool_id_opt.copy()
<a name="l00158"></a>00158 pool_id_filter_opt[<span class="stringliteral">&apos;help&apos;</span>] = <span class="stringliteral">&apos;Search by Pool ID&apos;</span>
<a name="l00159"></a>00159 
<a name="l00160"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a7d3fb456d1cae8a7541f68c301a08421">00160</a> vol_id_opt = dict(name=<span class="stringliteral">&apos;--vol&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;VOL_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Volume ID&apos;</span>)
<a name="l00161"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a02d85f517cf229eb5b69efe31f74ad4b">00161</a> vol_id_filter_opt = vol_id_opt.copy()
<a name="l00162"></a>00162 vol_id_filter_opt[<span class="stringliteral">&apos;help&apos;</span>] = <span class="stringliteral">&apos;Search by Volume ID&apos;</span>
<a name="l00163"></a>00163 
<a name="l00164"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a8c07bb7e45c0229bc8889877af4258b6">00164</a> fs_id_opt = dict(name=<span class="stringliteral">&apos;--fs&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;FS_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;File System ID&apos;</span>)
<a name="l00165"></a>00165 
<a name="l00166"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a100b933761142623d1a12b352b0e6f6c">00166</a> ag_id_opt = dict(name=<span class="stringliteral">&apos;--ag&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;AG_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Access Group ID&apos;</span>)
<a name="l00167"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#ac64dca77c6a3c17f3670b731c4876911">00167</a> ag_id_filter_opt = ag_id_opt.copy()
<a name="l00168"></a>00168 ag_id_filter_opt[<span class="stringliteral">&apos;help&apos;</span>] = <span class="stringliteral">&apos;Search by Access Group ID&apos;</span>
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a11b2b3681e3aab5f2cc93b4e377ea2a3">00170</a> init_id_opt = dict(name=<span class="stringliteral">&apos;--init&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;INIT_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Initiator ID&apos;</span>)
<a name="l00171"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a38e4ccf9031d7e57c97c70276ed5f026">00171</a> snap_id_opt = dict(name=<span class="stringliteral">&apos;--snap&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;SNAP_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Snapshot ID&apos;</span>)
<a name="l00172"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#af1c09ca98bd74311af5111c593780f27">00172</a> export_id_opt = dict(name=<span class="stringliteral">&apos;--export&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;EXPORT_ID&gt;&apos;</span>, help=<span class="stringliteral">&apos;Export ID&apos;</span>)
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#aa5191bd4a314d07754ee14466256d53e">00174</a> nfs_export_id_filter_opt = dict(
<a name="l00175"></a>00175     name=<span class="stringliteral">&apos;--nfs-export&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;NFS_EXPORT_ID&gt;&apos;</span>,
<a name="l00176"></a>00176     help=<span class="stringliteral">&apos;Search by NFS Export ID&apos;</span>)
<a name="l00177"></a>00177 
<a name="l00178"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a96a0733d45338395ea98924ebdbdd177">00178</a> disk_id_filter_opt = dict(name=<span class="stringliteral">&apos;--disk&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;DISK_ID&gt;&apos;</span>,
<a name="l00179"></a>00179                           help=<span class="stringliteral">&apos;Search by Disk ID&apos;</span>)
<a name="l00180"></a>00180 
<a name="l00181"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#aa3618ca1978f4204111fce9da9f6d832">00181</a> size_opt = dict(name=<span class="stringliteral">&apos;--size&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;SIZE&gt;&apos;</span>, help=size_help)
<a name="l00182"></a>00182 
<a name="l00183"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#ace55f2e1b26bbdcc58ee73abaa998f5a">00183</a> tgt_id_opt = dict(name=<span class="stringliteral">&quot;--tgt&quot;</span>, help=<span class="stringliteral">&quot;Search by target port ID&quot;</span>,
<a name="l00184"></a>00184                   metavar=<span class="stringliteral">&apos;&lt;TGT_ID&gt;&apos;</span>)
<a name="l00185"></a>00185 
<a name="l00186"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#a390fde3066bdbb33fdc0a49ee8638c18">00186</a> cmds = (
<a name="l00187"></a>00187     dict(
<a name="l00188"></a>00188         name=<span class="stringliteral">&apos;list&apos;</span>,
<a name="l00189"></a>00189         help=<span class="stringliteral">&quot;List records of different types&quot;</span>,
<a name="l00190"></a>00190         args=[
<a name="l00191"></a>00191             dict(name=<span class="stringliteral">&apos;--type&apos;</span>,
<a name="l00192"></a>00192                  help=<span class="stringliteral">&quot;List records of type:\n    &quot;</span> +
<a name="l00193"></a>00193                       <span class="stringliteral">&quot;\n    &quot;</span>.join(list_choices) +
<a name="l00194"></a>00194                       <span class="stringliteral">&quot;\n\nWhen listing SNAPSHOTS, it requires --fs &lt;FS_ID&gt;.&quot;</span>,
<a name="l00195"></a>00195                  metavar=<span class="stringliteral">&apos;&lt;TYPE&gt;&apos;</span>,
<a name="l00196"></a>00196                  choices=list_choices,
<a name="l00197"></a>00197                  type=str.upper),
<a name="l00198"></a>00198         ],
<a name="l00199"></a>00199         optional=[
<a name="l00200"></a>00200             dict(sys_id_filter_opt),
<a name="l00201"></a>00201             dict(pool_id_filter_opt),
<a name="l00202"></a>00202             dict(vol_id_filter_opt),
<a name="l00203"></a>00203             dict(disk_id_filter_opt),
<a name="l00204"></a>00204             dict(ag_id_filter_opt),
<a name="l00205"></a>00205             dict(fs_id_opt),
<a name="l00206"></a>00206             dict(nfs_export_id_filter_opt),
<a name="l00207"></a>00207             dict(tgt_id_opt),
<a name="l00208"></a>00208         ],
<a name="l00209"></a>00209     ),
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     dict(
<a name="l00212"></a>00212         name=<span class="stringliteral">&apos;job-status&apos;</span>,
<a name="l00213"></a>00213         help=<span class="stringliteral">&apos;Retrieve information about a job&apos;</span>,
<a name="l00214"></a>00214         args=[
<a name="l00215"></a>00215             dict(name=<span class="stringliteral">&quot;--job&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;JOB_ID&gt;&quot;</span>, help=<span class="stringliteral">&apos;job status id&apos;</span>),
<a name="l00216"></a>00216         ],
<a name="l00217"></a>00217     ),
<a name="l00218"></a>00218 
<a name="l00219"></a>00219     dict(
<a name="l00220"></a>00220         name=<span class="stringliteral">&apos;capabilities&apos;</span>,
<a name="l00221"></a>00221         help=<span class="stringliteral">&apos;Retrieves array capabilities&apos;</span>,
<a name="l00222"></a>00222         args=[
<a name="l00223"></a>00223             dict(sys_id_opt),
<a name="l00224"></a>00224         ],
<a name="l00225"></a>00225     ),
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     dict(
<a name="l00228"></a>00228         name=<span class="stringliteral">&apos;plugin-info&apos;</span>,
<a name="l00229"></a>00229         help=<span class="stringliteral">&apos;Retrieves plugin description and version&apos;</span>,
<a name="l00230"></a>00230     ),
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     dict(
<a name="l00233"></a>00233         name=<span class="stringliteral">&apos;volume-create&apos;</span>,
<a name="l00234"></a>00234         help=<span class="stringliteral">&apos;Creates a volume (logical unit)&apos;</span>,
<a name="l00235"></a>00235         args=[
<a name="l00236"></a>00236             dict(name=<span class="stringliteral">&quot;--name&quot;</span>, help=<span class="stringliteral">&apos;volume name&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;NAME&gt;&apos;</span>),
<a name="l00237"></a>00237             dict(size_opt),
<a name="l00238"></a>00238             dict(pool_id_opt),
<a name="l00239"></a>00239         ],
<a name="l00240"></a>00240         optional=[
<a name="l00241"></a>00241             dict(name=<span class="stringliteral">&quot;--provisioning&quot;</span>, help=provision_help,
<a name="l00242"></a>00242                  default=<span class="stringliteral">&apos;DEFAULT&apos;</span>,
<a name="l00243"></a>00243                  choices=provision_types,
<a name="l00244"></a>00244                  type=str.upper),
<a name="l00245"></a>00245         ],
<a name="l00246"></a>00246     ),
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     dict(
<a name="l00249"></a>00249         name=<span class="stringliteral">&apos;volume-raid-create&apos;</span>,
<a name="l00250"></a>00250         help=<span class="stringliteral">&apos;Creates a RAIDed volume on hardware RAID&apos;</span>,
<a name="l00251"></a>00251         args=[
<a name="l00252"></a>00252             dict(name=<span class="stringliteral">&quot;--name&quot;</span>, help=<span class="stringliteral">&apos;volume name&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;NAME&gt;&apos;</span>),
<a name="l00253"></a>00253             dict(name=<span class="stringliteral">&quot;--disk&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;DISK&gt;&apos;</span>,
<a name="l00254"></a>00254                  help=<span class="stringliteral">&apos;Free disks for new RAIDed volume.\n&apos;</span>
<a name="l00255"></a>00255                       <span class="stringliteral">&apos;This is repeatable argument.&apos;</span>,
<a name="l00256"></a>00256                  action=<span class="stringliteral">&apos;append&apos;</span>),
<a name="l00257"></a>00257             dict(name=<span class="stringliteral">&quot;--raid-type&quot;</span>,
<a name="l00258"></a>00258                  help=<span class="stringliteral">&quot;RAID type for the new RAID group. &quot;</span>
<a name="l00259"></a>00259                       <span class="stringliteral">&quot;Should be one of these:\n    %s&quot;</span> %
<a name="l00260"></a>00260                       <span class="stringliteral">&quot;\n    &quot;</span>.
<a name="l00261"></a>00261                       join(VolumeRAIDInfo.VOL_CREATE_RAID_TYPES_STR),
<a name="l00262"></a>00262                  choices=VolumeRAIDInfo.VOL_CREATE_RAID_TYPES_STR,
<a name="l00263"></a>00263                  type=str.upper),
<a name="l00264"></a>00264         ],
<a name="l00265"></a>00265         optional=[
<a name="l00266"></a>00266             dict(name=<span class="stringliteral">&quot;--strip-size&quot;</span>,
<a name="l00267"></a>00267                  help=<span class="stringliteral">&quot;Strip size. &quot;</span> + size_help),
<a name="l00268"></a>00268         ],
<a name="l00269"></a>00269     ),
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     dict(
<a name="l00272"></a>00272         name=<span class="stringliteral">&apos;volume-raid-create-cap&apos;</span>,
<a name="l00273"></a>00273         help=<span class="stringliteral">&apos;Query capablity of creating a RAIDed volume on hardware RAID&apos;</span>,
<a name="l00274"></a>00274         args=[
<a name="l00275"></a>00275             dict(sys_id_opt),
<a name="l00276"></a>00276         ],
<a name="l00277"></a>00277     ),
<a name="l00278"></a>00278 
<a name="l00279"></a>00279     dict(
<a name="l00280"></a>00280         name=<span class="stringliteral">&apos;volume-delete&apos;</span>,
<a name="l00281"></a>00281         help=<span class="stringliteral">&apos;Deletes a volume given its id&apos;</span>,
<a name="l00282"></a>00282         args=[
<a name="l00283"></a>00283             dict(vol_id_opt),
<a name="l00284"></a>00284         ],
<a name="l00285"></a>00285     ),
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     dict(
<a name="l00288"></a>00288         name=<span class="stringliteral">&apos;volume-resize&apos;</span>,
<a name="l00289"></a>00289         help=<span class="stringliteral">&apos;Re-sizes a volume&apos;</span>,
<a name="l00290"></a>00290         args=[
<a name="l00291"></a>00291             dict(vol_id_opt),
<a name="l00292"></a>00292             dict(name=<span class="stringliteral">&apos;--size&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;NEW_SIZE&gt;&apos;</span>,
<a name="l00293"></a>00293                  help=<span class="stringliteral">&quot;New size. %s&quot;</span> % size_help),
<a name="l00294"></a>00294         ],
<a name="l00295"></a>00295     ),
<a name="l00296"></a>00296 
<a name="l00297"></a>00297     dict(
<a name="l00298"></a>00298         name=<span class="stringliteral">&apos;volume-replicate&apos;</span>,
<a name="l00299"></a>00299         help=<span class="stringliteral">&apos;Creates a new volume and replicates provided volume to it.&apos;</span>,
<a name="l00300"></a>00300         args=[
<a name="l00301"></a>00301             dict(vol_id_opt),
<a name="l00302"></a>00302             dict(name=<span class="stringliteral">&quot;--name&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;NEW_VOL_NAME&gt;&apos;</span>,
<a name="l00303"></a>00303                  help=<span class="stringliteral">&apos;The name for New replicated volume&apos;</span>),
<a name="l00304"></a>00304             dict(name=<span class="stringliteral">&quot;--rep-type&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;REPL_TYPE&gt;&apos;</span>,
<a name="l00305"></a>00305                  help=replicate_help, choices=replicate_types),
<a name="l00306"></a>00306         ],
<a name="l00307"></a>00307         optional=[
<a name="l00308"></a>00308             dict(name=<span class="stringliteral">&quot;--pool&quot;</span>,
<a name="l00309"></a>00309                  help=<span class="stringliteral">&apos;Pool ID to contain the new volume.\nBy default, &apos;</span>
<a name="l00310"></a>00310                       <span class="stringliteral">&apos;new volume will be created in the same pool.&apos;</span>),
<a name="l00311"></a>00311         ],
<a name="l00312"></a>00312     ),
<a name="l00313"></a>00313 
<a name="l00314"></a>00314     dict(
<a name="l00315"></a>00315         name=<span class="stringliteral">&apos;volume-replicate-range&apos;</span>,
<a name="l00316"></a>00316         help=<span class="stringliteral">&apos;Replicates a portion of a volume&apos;</span>,
<a name="l00317"></a>00317         args=[
<a name="l00318"></a>00318             dict(name=<span class="stringliteral">&quot;--src-vol&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;SRC_VOL_ID&gt;&apos;</span>,
<a name="l00319"></a>00319                  help=<span class="stringliteral">&apos;Source volume id&apos;</span>),
<a name="l00320"></a>00320             dict(name=<span class="stringliteral">&quot;--dst-vol&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;DST_VOL_ID&gt;&apos;</span>,
<a name="l00321"></a>00321                  help=<span class="stringliteral">&apos;Destination volume id&apos;</span>),
<a name="l00322"></a>00322             dict(name=<span class="stringliteral">&quot;--rep-type&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;REP_TYPE&gt;&apos;</span>, help=replicate_help,
<a name="l00323"></a>00323                  choices=replicate_types),
<a name="l00324"></a>00324             dict(name=<span class="stringliteral">&quot;--src-start&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;SRC_START_BLK&gt;&apos;</span>,
<a name="l00325"></a>00325                  help=<span class="stringliteral">&apos;Source volume start block number.\n&apos;</span>
<a name="l00326"></a>00326                       <span class="stringliteral">&apos;This is repeatable argument.&apos;</span>,
<a name="l00327"></a>00327                  action=<span class="stringliteral">&apos;append&apos;</span>),
<a name="l00328"></a>00328             dict(name=<span class="stringliteral">&quot;--dst-start&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;DST_START_BLK&gt;&apos;</span>,
<a name="l00329"></a>00329                  help=<span class="stringliteral">&apos;Destination volume start block number.\n&apos;</span>
<a name="l00330"></a>00330                       <span class="stringliteral">&apos;This is repeatable argument.&apos;</span>,
<a name="l00331"></a>00331                  action=<span class="stringliteral">&apos;append&apos;</span>),
<a name="l00332"></a>00332             dict(name=<span class="stringliteral">&quot;--count&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;BLK_COUNT&gt;&apos;</span>,
<a name="l00333"></a>00333                  help=<span class="stringliteral">&apos;Number of blocks to replicate.\n&apos;</span>
<a name="l00334"></a>00334                       <span class="stringliteral">&apos;This is repeatable argument.&apos;</span>,
<a name="l00335"></a>00335                  action=<span class="stringliteral">&apos;append&apos;</span>),
<a name="l00336"></a>00336         ],
<a name="l00337"></a>00337     ),
<a name="l00338"></a>00338 
<a name="l00339"></a>00339     dict(
<a name="l00340"></a>00340         name=<span class="stringliteral">&apos;volume-replicate-range-block-size&apos;</span>,
<a name="l00341"></a>00341         help=<span class="stringliteral">&apos;Size of each replicated block on a system in bytes&apos;</span>,
<a name="l00342"></a>00342         args=[
<a name="l00343"></a>00343             dict(sys_id_opt),
<a name="l00344"></a>00344         ],
<a name="l00345"></a>00345     ),
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     dict(
<a name="l00348"></a>00348         name=<span class="stringliteral">&apos;volume-dependants&apos;</span>,
<a name="l00349"></a>00349         help=<span class="stringliteral">&apos;Returns True if volume has a dependant child, like replication&apos;</span>,
<a name="l00350"></a>00350         args=[
<a name="l00351"></a>00351             dict(vol_id_opt),
<a name="l00352"></a>00352         ],
<a name="l00353"></a>00353     ),
<a name="l00354"></a>00354 
<a name="l00355"></a>00355     dict(
<a name="l00356"></a>00356         name=<span class="stringliteral">&apos;volume-dependants-rm&apos;</span>,
<a name="l00357"></a>00357         help=<span class="stringliteral">&apos;Removes dependencies&apos;</span>,
<a name="l00358"></a>00358         args=[
<a name="l00359"></a>00359             dict(vol_id_opt),
<a name="l00360"></a>00360         ],
<a name="l00361"></a>00361     ),
<a name="l00362"></a>00362 
<a name="l00363"></a>00363     dict(
<a name="l00364"></a>00364         name=<span class="stringliteral">&apos;volume-access-group&apos;</span>,
<a name="l00365"></a>00365         help=<span class="stringliteral">&apos;Lists the access group(s) that have access to volume&apos;</span>,
<a name="l00366"></a>00366         args=[
<a name="l00367"></a>00367             dict(vol_id_opt),
<a name="l00368"></a>00368         ],
<a name="l00369"></a>00369     ),
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     dict(
<a name="l00372"></a>00372         name=<span class="stringliteral">&apos;volume-mask&apos;</span>,
<a name="l00373"></a>00373         help=<span class="stringliteral">&apos;Grants access to an access group to a volume, &apos;</span>
<a name="l00374"></a>00374              <span class="stringliteral">&apos;like LUN Masking&apos;</span>,
<a name="l00375"></a>00375         args=[
<a name="l00376"></a>00376             dict(vol_id_opt),
<a name="l00377"></a>00377             dict(ag_id_opt),
<a name="l00378"></a>00378         ],
<a name="l00379"></a>00379     ),
<a name="l00380"></a>00380 
<a name="l00381"></a>00381     dict(
<a name="l00382"></a>00382         name=<span class="stringliteral">&apos;volume-unmask&apos;</span>,
<a name="l00383"></a>00383         help=<span class="stringliteral">&apos;Revoke the access of specified access group to a volume&apos;</span>,
<a name="l00384"></a>00384         args=[
<a name="l00385"></a>00385             dict(ag_id_opt),
<a name="l00386"></a>00386             dict(vol_id_opt),
<a name="l00387"></a>00387         ],
<a name="l00388"></a>00388     ),
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     dict(
<a name="l00391"></a>00391         name=<span class="stringliteral">&apos;volume-enable&apos;</span>,
<a name="l00392"></a>00392         help=<span class="stringliteral">&apos;Enable block access of a volume&apos;</span>,
<a name="l00393"></a>00393         args=[
<a name="l00394"></a>00394             dict(vol_id_opt),
<a name="l00395"></a>00395         ],
<a name="l00396"></a>00396     ),
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     dict(
<a name="l00399"></a>00399         name=<span class="stringliteral">&apos;volume-disable&apos;</span>,
<a name="l00400"></a>00400         help=<span class="stringliteral">&apos;Disable block access of a volume&apos;</span>,
<a name="l00401"></a>00401         args=[
<a name="l00402"></a>00402             dict(vol_id_opt),
<a name="l00403"></a>00403         ],
<a name="l00404"></a>00404     ),
<a name="l00405"></a>00405 
<a name="l00406"></a>00406     dict(
<a name="l00407"></a>00407         name=<span class="stringliteral">&apos;volume-raid-info&apos;</span>,
<a name="l00408"></a>00408         help=<span class="stringliteral">&apos;Query volume RAID infomation&apos;</span>,
<a name="l00409"></a>00409         args=[
<a name="l00410"></a>00410             dict(vol_id_opt),
<a name="l00411"></a>00411         ],
<a name="l00412"></a>00412     ),
<a name="l00413"></a>00413 
<a name="l00414"></a>00414     dict(
<a name="l00415"></a>00415         name=<span class="stringliteral">&apos;pool-member-info&apos;</span>,
<a name="l00416"></a>00416         help=<span class="stringliteral">&apos;Query Pool membership infomation&apos;</span>,
<a name="l00417"></a>00417         args=[
<a name="l00418"></a>00418             dict(pool_id_opt),
<a name="l00419"></a>00419         ],
<a name="l00420"></a>00420     ),
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     dict(
<a name="l00423"></a>00423         name=<span class="stringliteral">&apos;access-group-create&apos;</span>,
<a name="l00424"></a>00424         help=<span class="stringliteral">&apos;Create an access group&apos;</span>,
<a name="l00425"></a>00425         args=[
<a name="l00426"></a>00426             dict(name=<span class="stringliteral">&apos;--name&apos;</span>, metavar=<span class="stringliteral">&apos;&lt;AG_NAME&gt;&apos;</span>,
<a name="l00427"></a>00427                  help=<span class="stringliteral">&quot;Human readable name for access group&quot;</span>),
<a name="l00428"></a>00428             <span class="comment"># TODO: _client.py access_group_create should support multiple</span>
<a name="l00429"></a>00429             <span class="comment">#       initiators when creating.</span>
<a name="l00430"></a>00430             dict(init_id_opt),
<a name="l00431"></a>00431             dict(sys_id_opt),
<a name="l00432"></a>00432         ],
<a name="l00433"></a>00433     ),
<a name="l00434"></a>00434 
<a name="l00435"></a>00435     dict(
<a name="l00436"></a>00436         name=<span class="stringliteral">&apos;access-group-add&apos;</span>,
<a name="l00437"></a>00437         help=<span class="stringliteral">&apos;Add an initiator into existing access group&apos;</span>,
<a name="l00438"></a>00438         args=[
<a name="l00439"></a>00439             dict(ag_id_opt),
<a name="l00440"></a>00440             dict(init_id_opt),
<a name="l00441"></a>00441         ],
<a name="l00442"></a>00442     ),
<a name="l00443"></a>00443     dict(
<a name="l00444"></a>00444         name=<span class="stringliteral">&apos;access-group-remove&apos;</span>,
<a name="l00445"></a>00445         help=<span class="stringliteral">&apos;Remove an initiator from existing access group&apos;</span>,
<a name="l00446"></a>00446         args=[
<a name="l00447"></a>00447             dict(ag_id_opt),
<a name="l00448"></a>00448             dict(init_id_opt),
<a name="l00449"></a>00449         ],
<a name="l00450"></a>00450     ),
<a name="l00451"></a>00451 
<a name="l00452"></a>00452     dict(
<a name="l00453"></a>00453         name=<span class="stringliteral">&apos;access-group-delete&apos;</span>,
<a name="l00454"></a>00454         help=<span class="stringliteral">&apos;Deletes an access group&apos;</span>,
<a name="l00455"></a>00455         args=[
<a name="l00456"></a>00456             dict(ag_id_opt),
<a name="l00457"></a>00457         ],
<a name="l00458"></a>00458     ),
<a name="l00459"></a>00459 
<a name="l00460"></a>00460     dict(
<a name="l00461"></a>00461         name=<span class="stringliteral">&apos;access-group-volumes&apos;</span>,
<a name="l00462"></a>00462         help=<span class="stringliteral">&apos;Lists the volumes that the access group has&apos;</span>
<a name="l00463"></a>00463              <span class="stringliteral">&apos; been granted access to&apos;</span>,
<a name="l00464"></a>00464         args=[
<a name="l00465"></a>00465             dict(ag_id_opt),
<a name="l00466"></a>00466         ],
<a name="l00467"></a>00467     ),
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     dict(
<a name="l00470"></a>00470         name=<span class="stringliteral">&apos;iscsi-chap&apos;</span>,
<a name="l00471"></a>00471         help=<span class="stringliteral">&apos;Configures iSCSI inbound/outbound CHAP authentication&apos;</span>,
<a name="l00472"></a>00472         args=[
<a name="l00473"></a>00473             dict(init_id_opt),
<a name="l00474"></a>00474         ],
<a name="l00475"></a>00475         optional=[
<a name="l00476"></a>00476             dict(name=<span class="stringliteral">&quot;--in-user&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;IN_USER&gt;&apos;</span>,
<a name="l00477"></a>00477                  help=<span class="stringliteral">&apos;Inbound chap user name&apos;</span>),
<a name="l00478"></a>00478             dict(name=<span class="stringliteral">&quot;--in-pass&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;IN_PASS&gt;&apos;</span>,
<a name="l00479"></a>00479                  help=<span class="stringliteral">&apos;Inbound chap password&apos;</span>),
<a name="l00480"></a>00480             dict(name=<span class="stringliteral">&quot;--out-user&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;OUT_USER&gt;&apos;</span>,
<a name="l00481"></a>00481                  help=<span class="stringliteral">&apos;Outbound chap user name&apos;</span>),
<a name="l00482"></a>00482             dict(name=<span class="stringliteral">&quot;--out-pass&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;OUT_PASS&gt;&apos;</span>,
<a name="l00483"></a>00483                  help=<span class="stringliteral">&apos;Outbound chap password&apos;</span>),
<a name="l00484"></a>00484         ],
<a name="l00485"></a>00485     ),
<a name="l00486"></a>00486 
<a name="l00487"></a>00487     dict(
<a name="l00488"></a>00488         name=<span class="stringliteral">&apos;fs-create&apos;</span>,
<a name="l00489"></a>00489         help=<span class="stringliteral">&apos;Creates a file system&apos;</span>,
<a name="l00490"></a>00490         args=[
<a name="l00491"></a>00491             dict(name=<span class="stringliteral">&quot;--name&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;FS_NAME&gt;&apos;</span>,
<a name="l00492"></a>00492                  help=<span class="stringliteral">&apos;name of the file system&apos;</span>),
<a name="l00493"></a>00493             dict(size_opt),
<a name="l00494"></a>00494             dict(pool_id_opt),
<a name="l00495"></a>00495         ],
<a name="l00496"></a>00496     ),
<a name="l00497"></a>00497 
<a name="l00498"></a>00498     dict(
<a name="l00499"></a>00499         name=<span class="stringliteral">&apos;fs-delete&apos;</span>,
<a name="l00500"></a>00500         help=<span class="stringliteral">&apos;Delete a filesystem&apos;</span>,
<a name="l00501"></a>00501         args=[
<a name="l00502"></a>00502             dict(fs_id_opt)
<a name="l00503"></a>00503         ],
<a name="l00504"></a>00504     ),
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     dict(
<a name="l00507"></a>00507         name=<span class="stringliteral">&apos;fs-resize&apos;</span>,
<a name="l00508"></a>00508         help=<span class="stringliteral">&apos;Re-sizes a filesystem&apos;</span>,
<a name="l00509"></a>00509         args=[
<a name="l00510"></a>00510             dict(fs_id_opt),
<a name="l00511"></a>00511             dict(name=<span class="stringliteral">&quot;--size&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;NEW_SIZE&gt;&quot;</span>,
<a name="l00512"></a>00512                  help=<span class="stringliteral">&quot;New size. %s&quot;</span> % size_help),
<a name="l00513"></a>00513         ],
<a name="l00514"></a>00514     ),
<a name="l00515"></a>00515 
<a name="l00516"></a>00516     dict(
<a name="l00517"></a>00517         name=<span class="stringliteral">&apos;fs-export&apos;</span>,
<a name="l00518"></a>00518         help=<span class="stringliteral">&apos;Export a filesystem via NFS.&apos;</span>,
<a name="l00519"></a>00519         args=[
<a name="l00520"></a>00520             dict(fs_id_opt),
<a name="l00521"></a>00521         ],
<a name="l00522"></a>00522         optional=[
<a name="l00523"></a>00523             dict(name=<span class="stringliteral">&quot;--exportpath&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;EXPORT_PATH&gt;&apos;</span>,
<a name="l00524"></a>00524                  help=<span class="stringliteral">&quot;NFS server export path. e.g. &apos;/foo/bar&apos;.&quot;</span>),
<a name="l00525"></a>00525             dict(name=<span class="stringliteral">&quot;--anonuid&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;ANON_UID&gt;&apos;</span>,
<a name="l00526"></a>00526                  help=<span class="stringliteral">&apos;UID(User ID) to map to anonymous user&apos;</span>,
<a name="l00527"></a>00527                  default=NfsExport.ANON_UID_GID_NA,
<a name="l00528"></a>00528                  type=long),
<a name="l00529"></a>00529             dict(name=<span class="stringliteral">&quot;--anongid&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;ANON_GID&gt;&apos;</span>,
<a name="l00530"></a>00530                  help=<span class="stringliteral">&apos;GID(Group ID) to map to anonymous user&apos;</span>,
<a name="l00531"></a>00531                  default=NfsExport.ANON_UID_GID_NA,
<a name="l00532"></a>00532                  type=long),
<a name="l00533"></a>00533             dict(name=<span class="stringliteral">&quot;--auth-type&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;AUTH_TYPE&gt;&apos;</span>,
<a name="l00534"></a>00534                  help=<span class="stringliteral">&apos;NFS client authentication type&apos;</span>),
<a name="l00535"></a>00535             dict(name=<span class="stringliteral">&quot;--root-host&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;ROOT_HOST&gt;&apos;</span>,
<a name="l00536"></a>00536                  help=<span class="stringliteral">&quot;The host/IP has root access.\n&quot;</span>
<a name="l00537"></a>00537                       <span class="stringliteral">&quot;This is repeatable argument.&quot;</span>,
<a name="l00538"></a>00538                  action=<span class="stringliteral">&apos;append&apos;</span>,
<a name="l00539"></a>00539                  default=[]),
<a name="l00540"></a>00540             dict(name=<span class="stringliteral">&quot;--ro-host&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;RO_HOST&gt;&apos;</span>,
<a name="l00541"></a>00541                  help=<span class="stringliteral">&quot;The host/IP has readonly access.\n&quot;</span>
<a name="l00542"></a>00542                       <span class="stringliteral">&quot;This is repeatable argument.&quot;</span>,
<a name="l00543"></a>00543                  action=<span class="stringliteral">&apos;append&apos;</span>, default=[]),
<a name="l00544"></a>00544             dict(name=<span class="stringliteral">&quot;--rw-host&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;RW_HOST&gt;&apos;</span>,
<a name="l00545"></a>00545                  help=<span class="stringliteral">&quot;The host/IP has readwrite access.\n&quot;</span>
<a name="l00546"></a>00546                       <span class="stringliteral">&quot;This is repeatable argument.&quot;</span>,
<a name="l00547"></a>00547                  action=<span class="stringliteral">&apos;append&apos;</span>, default=[]),
<a name="l00548"></a>00548         ],
<a name="l00549"></a>00549     ),
<a name="l00550"></a>00550 
<a name="l00551"></a>00551     dict(
<a name="l00552"></a>00552         name=<span class="stringliteral">&apos;fs-unexport&apos;</span>,
<a name="l00553"></a>00553         help=<span class="stringliteral">&apos;Remove an NFS export&apos;</span>,
<a name="l00554"></a>00554         args=[
<a name="l00555"></a>00555             dict(export_id_opt),
<a name="l00556"></a>00556         ],
<a name="l00557"></a>00557     ),
<a name="l00558"></a>00558 
<a name="l00559"></a>00559     dict(
<a name="l00560"></a>00560         name=<span class="stringliteral">&apos;fs-clone&apos;</span>,
<a name="l00561"></a>00561         help=<span class="stringliteral">&apos;Creates a file system clone&apos;</span>,
<a name="l00562"></a>00562         args=[
<a name="l00563"></a>00563             dict(name=<span class="stringliteral">&quot;--src-fs&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;SRC_FS_ID&gt;&apos;</span>,
<a name="l00564"></a>00564                  help=<span class="stringliteral">&apos;The ID of existing source file system.&apos;</span>),
<a name="l00565"></a>00565             dict(name=<span class="stringliteral">&quot;--dst-name&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;DST_FS_NAME&gt;&apos;</span>,
<a name="l00566"></a>00566                  help=<span class="stringliteral">&apos;The name for newly created destination file system.&apos;</span>),
<a name="l00567"></a>00567         ],
<a name="l00568"></a>00568         optional=[
<a name="l00569"></a>00569             dict(name=<span class="stringliteral">&quot;--backing-snapshot&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;BE_SS_ID&gt;&apos;</span>,
<a name="l00570"></a>00570                  help=<span class="stringliteral">&apos;backing snapshot id&apos;</span>),
<a name="l00571"></a>00571         ],
<a name="l00572"></a>00572     ),
<a name="l00573"></a>00573 
<a name="l00574"></a>00574     dict(
<a name="l00575"></a>00575         name=<span class="stringliteral">&apos;fs-snap-create&apos;</span>,
<a name="l00576"></a>00576         help=<span class="stringliteral">&apos;Creates a snapshot&apos;</span>,
<a name="l00577"></a>00577         args=[
<a name="l00578"></a>00578             dict(name=<span class="stringliteral">&quot;--name&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;SNAP_NAME&gt;&quot;</span>,
<a name="l00579"></a>00579                  help=<span class="stringliteral">&apos;The human friendly name of new snapshot&apos;</span>),
<a name="l00580"></a>00580             dict(fs_id_opt),
<a name="l00581"></a>00581         ],
<a name="l00582"></a>00582     ),
<a name="l00583"></a>00583 
<a name="l00584"></a>00584     dict(
<a name="l00585"></a>00585         name=<span class="stringliteral">&apos;fs-snap-delete&apos;</span>,
<a name="l00586"></a>00586         help=<span class="stringliteral">&apos;Deletes a snapshot&apos;</span>,
<a name="l00587"></a>00587         args=[
<a name="l00588"></a>00588             dict(snap_id_opt),
<a name="l00589"></a>00589             dict(fs_id_opt),        <span class="comment"># TODO: why we need filesystem ID?</span>
<a name="l00590"></a>00590         ],
<a name="l00591"></a>00591     ),
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     dict(
<a name="l00594"></a>00594         name=<span class="stringliteral">&apos;fs-snap-restore&apos;</span>,
<a name="l00595"></a>00595         help=<span class="stringliteral">&apos;Restores a FS or specified files to &apos;</span>
<a name="l00596"></a>00596              <span class="stringliteral">&apos;previous snapshot state&apos;</span>,
<a name="l00597"></a>00597         args=[
<a name="l00598"></a>00598             dict(snap_id_opt),
<a name="l00599"></a>00599             dict(fs_id_opt),
<a name="l00600"></a>00600         ],
<a name="l00601"></a>00601         optional=[
<a name="l00602"></a>00602             dict(name=<span class="stringliteral">&quot;--file&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;FILE_PATH&gt;&quot;</span>,
<a name="l00603"></a>00603                  help=<span class="stringliteral">&quot;Only restore provided file\n&quot;</span>
<a name="l00604"></a>00604                       <span class="stringliteral">&quot;Without this argument, all files will be restored\n&quot;</span>
<a name="l00605"></a>00605                       <span class="stringliteral">&quot;This is a repeatable argument.&quot;</span>,
<a name="l00606"></a>00606                  action=<span class="stringliteral">&apos;append&apos;</span>, default=[]),
<a name="l00607"></a>00607             dict(name=<span class="stringliteral">&quot;--fileas&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;NEW_FILE_PATH&gt;&quot;</span>,
<a name="l00608"></a>00608                  help=<span class="stringliteral">&quot;store restore file name to another name.\n&quot;</span>
<a name="l00609"></a>00609                       <span class="stringliteral">&quot;This is a repeatable argument.&quot;</span>,
<a name="l00610"></a>00610                  action=<span class="stringliteral">&apos;append&apos;</span>,
<a name="l00611"></a>00611                  default=[]),
<a name="l00612"></a>00612         ],
<a name="l00613"></a>00613     ),
<a name="l00614"></a>00614 
<a name="l00615"></a>00615     dict(
<a name="l00616"></a>00616         name=<span class="stringliteral">&apos;fs-dependants&apos;</span>,
<a name="l00617"></a>00617         help=<span class="stringliteral">&apos;Returns True if filesystem has a child &apos;</span>
<a name="l00618"></a>00618              <span class="stringliteral">&apos;dependency(clone/snapshot) exists&apos;</span>,
<a name="l00619"></a>00619         args=[
<a name="l00620"></a>00620             dict(fs_id_opt),
<a name="l00621"></a>00621         ],
<a name="l00622"></a>00622         optional=[
<a name="l00623"></a>00623             dict(name=<span class="stringliteral">&quot;--file&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;FILE_PATH&gt;&quot;</span>,
<a name="l00624"></a>00624                  action=<span class="stringliteral">&quot;append&quot;</span>, default=[],
<a name="l00625"></a>00625                  help=<span class="stringliteral">&quot;For file check\nThis is a repeatable argument.&quot;</span>),
<a name="l00626"></a>00626         ],
<a name="l00627"></a>00627     ),
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     dict(
<a name="l00630"></a>00630         name=<span class="stringliteral">&apos;fs-dependants-rm&apos;</span>,
<a name="l00631"></a>00631         help=<span class="stringliteral">&apos;Removes file system dependencies&apos;</span>,
<a name="l00632"></a>00632         args=[
<a name="l00633"></a>00633             dict(fs_id_opt),
<a name="l00634"></a>00634         ],
<a name="l00635"></a>00635         optional=[
<a name="l00636"></a>00636             dict(name=<span class="stringliteral">&quot;--file&quot;</span>, action=<span class="stringliteral">&apos;append&apos;</span>, default=[],
<a name="l00637"></a>00637                  help=<span class="stringliteral">&apos;File or files to remove dependencies for.\n&apos;</span>
<a name="l00638"></a>00638                       <span class="stringliteral">&quot;This is a repeatable argument.&quot;</span>,),
<a name="l00639"></a>00639         ],
<a name="l00640"></a>00640     ),
<a name="l00641"></a>00641 
<a name="l00642"></a>00642 
<a name="l00643"></a>00643     dict(
<a name="l00644"></a>00644         name=<span class="stringliteral">&apos;file-clone&apos;</span>,
<a name="l00645"></a>00645         help=<span class="stringliteral">&apos;Creates a clone of a file (thin provisioned)&apos;</span>,
<a name="l00646"></a>00646         args=[
<a name="l00647"></a>00647             dict(fs_id_opt),
<a name="l00648"></a>00648             dict(name=<span class="stringliteral">&quot;--src&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;SRC_FILE_PATH&gt;&quot;</span>,
<a name="l00649"></a>00649                  help=<span class="stringliteral">&apos;source file to clone (relative path)\n&apos;</span>
<a name="l00650"></a>00650                       <span class="stringliteral">&quot;This is a repeatable argument.&quot;</span>,),
<a name="l00651"></a>00651             dict(name=<span class="stringliteral">&quot;--dst&quot;</span>, metavar=<span class="stringliteral">&quot;&lt;DST_FILE_PATH&gt;&quot;</span>,
<a name="l00652"></a>00652                  help=<span class="stringliteral">&apos;Destination file (relative path)&apos;</span>
<a name="l00653"></a>00653                       <span class="stringliteral">&quot;, this is a repeatable argument.&quot;</span>),
<a name="l00654"></a>00654         ],
<a name="l00655"></a>00655         optional=[
<a name="l00656"></a>00656             dict(name=<span class="stringliteral">&quot;--backing-snapshot&quot;</span>, help=<span class="stringliteral">&apos;backing snapshot id&apos;</span>),
<a name="l00657"></a>00657         ],
<a name="l00658"></a>00658     ),
<a name="l00659"></a>00659 
<a name="l00660"></a>00660 )
<a name="l00661"></a>00661 
<a name="l00662"></a><a class="code" href="namespacelsmcli_1_1cmdline.html#ac97c72b3e16458e99137fd9f9ab1953c">00662</a> aliases = (
<a name="l00663"></a>00663     [<span class="stringliteral">&apos;ls&apos;</span>, <span class="stringliteral">&apos;list --type systems&apos;</span>],
<a name="l00664"></a>00664     [<span class="stringliteral">&apos;lp&apos;</span>, <span class="stringliteral">&apos;list --type pools&apos;</span>],
<a name="l00665"></a>00665     [<span class="stringliteral">&apos;lv&apos;</span>, <span class="stringliteral">&apos;list --type volumes&apos;</span>],
<a name="l00666"></a>00666     [<span class="stringliteral">&apos;ld&apos;</span>, <span class="stringliteral">&apos;list --type disks&apos;</span>],
<a name="l00667"></a>00667     [<span class="stringliteral">&apos;la&apos;</span>, <span class="stringliteral">&apos;list --type access_groups&apos;</span>],
<a name="l00668"></a>00668     [<span class="stringliteral">&apos;lf&apos;</span>, <span class="stringliteral">&apos;list --type fs&apos;</span>],
<a name="l00669"></a>00669     [<span class="stringliteral">&apos;lt&apos;</span>, <span class="stringliteral">&apos;list --type target_ports&apos;</span>],
<a name="l00670"></a>00670     [<span class="stringliteral">&apos;c&apos;</span>, <span class="stringliteral">&apos;capabilities&apos;</span>],
<a name="l00671"></a>00671     [<span class="stringliteral">&apos;p&apos;</span>, <span class="stringliteral">&apos;plugin-info&apos;</span>],
<a name="l00672"></a>00672     [<span class="stringliteral">&apos;vc&apos;</span>, <span class="stringliteral">&apos;volume-create&apos;</span>],
<a name="l00673"></a>00673     [<span class="stringliteral">&apos;vrc&apos;</span>, <span class="stringliteral">&apos;volume-raid-create&apos;</span>],
<a name="l00674"></a>00674     [<span class="stringliteral">&apos;vrcc&apos;</span>, <span class="stringliteral">&apos;volume-raid-create-cap&apos;</span>],
<a name="l00675"></a>00675     [<span class="stringliteral">&apos;vd&apos;</span>, <span class="stringliteral">&apos;volume-delete&apos;</span>],
<a name="l00676"></a>00676     [<span class="stringliteral">&apos;vr&apos;</span>, <span class="stringliteral">&apos;volume-resize&apos;</span>],
<a name="l00677"></a>00677     [<span class="stringliteral">&apos;vm&apos;</span>, <span class="stringliteral">&apos;volume-mask&apos;</span>],
<a name="l00678"></a>00678     [<span class="stringliteral">&apos;vu&apos;</span>, <span class="stringliteral">&apos;volume-unmask&apos;</span>],
<a name="l00679"></a>00679     [<span class="stringliteral">&apos;ve&apos;</span>, <span class="stringliteral">&apos;volume-enable&apos;</span>],
<a name="l00680"></a>00680     [<span class="stringliteral">&apos;vi&apos;</span>, <span class="stringliteral">&apos;volume-disable&apos;</span>],
<a name="l00681"></a>00681     [<span class="stringliteral">&apos;ac&apos;</span>, <span class="stringliteral">&apos;access-group-create&apos;</span>],
<a name="l00682"></a>00682     [<span class="stringliteral">&apos;aa&apos;</span>, <span class="stringliteral">&apos;access-group-add&apos;</span>],
<a name="l00683"></a>00683     [<span class="stringliteral">&apos;ar&apos;</span>, <span class="stringliteral">&apos;access-group-remove&apos;</span>],
<a name="l00684"></a>00684     [<span class="stringliteral">&apos;ad&apos;</span>, <span class="stringliteral">&apos;access-group-delete&apos;</span>],
<a name="l00685"></a>00685     [<span class="stringliteral">&apos;vri&apos;</span>, <span class="stringliteral">&apos;volume-raid-info&apos;</span>],
<a name="l00686"></a>00686     [<span class="stringliteral">&apos;pmi&apos;</span>, <span class="stringliteral">&apos;pool-member-info&apos;</span>],
<a name="l00687"></a>00687 )
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 
<a name="l00690"></a>00690 <span class="comment">## Class that encapsulates the command line arguments for lsmcli</span>
<a name="l00691"></a>00691 <span class="comment"># Note: This class is used by lsmcli and any python plug-ins.</span>
<a name="l00692"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html">00692</a> <span class="keyword">class </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html" title="Class that encapsulates the command line arguments for lsmcli Note: This class is...">CmdLine</a>:
<a name="l00693"></a>00693     <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00694"></a>00694 <span class="stringliteral">    Command line interface class.</span>
<a name="l00695"></a>00695 <span class="stringliteral">    &quot;&quot;&quot;</span>
<a name="l00696"></a>00696 
<a name="l00697"></a>00697     <span class="comment">##</span>
<a name="l00698"></a>00698     <span class="comment"># Warn of imminent data loss</span>
<a name="l00699"></a>00699     <span class="comment"># @param    deleting    Indicate data will be lost vs. may be lost</span>
<a name="l00700"></a>00700     <span class="comment">#                       (re-size)</span>
<a name="l00701"></a>00701     <span class="comment"># @return True if operation confirmed, else False</span>
<a name="l00702"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004">00702</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(self, deleting):
<a name="l00703"></a>00703         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00704"></a>00704 <span class="stringliteral">        Give the user a chance to bail.</span>
<a name="l00705"></a>00705 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l00706"></a>00706         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.force:
<a name="l00707"></a>00707             msg = <span class="stringliteral">&quot;will&quot;</span> <span class="keywordflow">if</span> deleting <span class="keywordflow">else</span> <span class="stringliteral">&quot;may&quot;</span>
<a name="l00708"></a>00708             out(<span class="stringliteral">&quot;Warning: You are about to do an operation that %s cause data &quot;</span>
<a name="l00709"></a>00709                 <span class="stringliteral">&quot;to be lost!\nPress [Y|y] to continue, any other key to abort&quot;</span>
<a name="l00710"></a>00710                 % msg)
<a name="l00711"></a>00711 
<a name="l00712"></a>00712             pressed = getch()
<a name="l00713"></a>00713             <span class="keywordflow">if</span> pressed.upper() == <span class="stringliteral">&apos;Y&apos;</span>:
<a name="l00714"></a>00714                 <span class="keywordflow">return</span> <span class="keyword">True</span>
<a name="l00715"></a>00715             <span class="keywordflow">else</span>:
<a name="l00716"></a>00716                 out(<span class="stringliteral">&apos;Operation aborted!&apos;</span>)
<a name="l00717"></a>00717                 <span class="keywordflow">return</span> <span class="keyword">False</span>
<a name="l00718"></a>00718         <span class="keywordflow">else</span>:
<a name="l00719"></a>00719             <span class="keywordflow">return</span> <span class="keyword">True</span>
<a name="l00720"></a>00720 
<a name="l00721"></a>00721     <span class="comment">##</span>
<a name="l00722"></a>00722     <span class="comment"># Tries to make the output better when it varies considerably from</span>
<a name="l00723"></a>00723     <span class="comment"># plug-in to plug-in.</span>
<a name="l00724"></a>00724     <span class="comment"># @param    objects    Data, first row is header all other data.</span>
<a name="l00725"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158">00725</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self, objects):
<a name="l00726"></a>00726         display_all = <span class="keyword">False</span>
<a name="l00727"></a>00727 
<a name="l00728"></a>00728         <span class="keywordflow">if</span> len(objects) == 0:
<a name="l00729"></a>00729             <span class="keywordflow">return</span>
<a name="l00730"></a>00730 
<a name="l00731"></a>00731         display_way = DisplayData.DISPLAY_WAY_DEFAULT
<a name="l00732"></a>00732 
<a name="l00733"></a>00733         flag_with_header = <span class="keyword">True</span>
<a name="l00734"></a>00734         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep:
<a name="l00735"></a>00735             flag_with_header = <span class="keyword">False</span>
<a name="l00736"></a>00736         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.header:
<a name="l00737"></a>00737             flag_with_header = <span class="keyword">True</span>
<a name="l00738"></a>00738 
<a name="l00739"></a>00739         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.script:
<a name="l00740"></a>00740             display_way = DisplayData.DISPLAY_WAY_SCRIPT
<a name="l00741"></a>00741 
<a name="l00742"></a>00742         DisplayData.display_data(
<a name="l00743"></a>00743             objects, display_way=display_way, flag_human=self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.human,
<a name="l00744"></a>00744             flag_enum=self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.enum,
<a name="l00745"></a>00745             splitter=self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep, flag_with_header=flag_with_header,
<a name="l00746"></a>00746             flag_dsp_all_data=display_all)
<a name="l00747"></a>00747 
<a name="l00748"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b7922c41c26fb5a903362a6b26beb26">00748</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b7922c41c26fb5a903362a6b26beb26">display_available_plugins</a>(self):
<a name="l00749"></a>00749         d = []
<a name="l00750"></a>00750         sep = <span class="stringliteral">&apos;&lt;}{&gt;&apos;</span>
<a name="l00751"></a>00751         plugins = Client.available_plugins(sep)
<a name="l00752"></a>00752 
<a name="l00753"></a>00753         <span class="keywordflow">for</span> p <span class="keywordflow">in</span> plugins:
<a name="l00754"></a>00754             desc, version = p.split(sep)
<a name="l00755"></a>00755             d.append(PlugData(desc, version))
<a name="l00756"></a>00756 
<a name="l00757"></a>00757         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(d)
<a name="l00758"></a>00758 
<a name="l00759"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2ec8fb4faccf7ffdd9bf225ff43fdf4c">00759</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2ec8fb4faccf7ffdd9bf225ff43fdf4c">handle_alias</a>(self, args):
<a name="l00760"></a>00760         cmd_arguments = args.cmd
<a name="l00761"></a>00761         cmd_arguments.extend(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3afcab76f1db5dda05ca54af8e79d06">unknown_args</a>)
<a name="l00762"></a>00762         new_args = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a90eee7a4677ca8b1ed116364a24367f9">parser</a>.parse_args(cmd_arguments)
<a name="l00763"></a>00763         new_args.func(new_args)
<a name="l00764"></a>00764 
<a name="l00765"></a>00765     <span class="comment">## All the command line arguments and options are created in this method</span>
<a name="l00766"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7f649901800e4188b62b0917de103629">00766</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7f649901800e4188b62b0917de103629" title="All the command line arguments and options are created in this method.">cli</a>(self):
<a name="l00767"></a>00767         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00768"></a>00768 <span class="stringliteral">        Command line interface parameters</span>
<a name="l00769"></a>00769 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l00770"></a>00770         parent_parser = ArgumentParser(add_help=<span class="keyword">False</span>)
<a name="l00771"></a>00771 
<a name="l00772"></a>00772         parent_parser.add_argument(
<a name="l00773"></a>00773             <span class="stringliteral">&apos;-v&apos;</span>, <span class="stringliteral">&apos;--version&apos;</span>, action=<span class="stringliteral">&apos;version&apos;</span>,
<a name="l00774"></a>00774             version=<span class="stringliteral">&quot;%s %s&quot;</span> % (sys.argv[0], VERSION))
<a name="l00775"></a>00775 
<a name="l00776"></a>00776         parent_parser.add_argument(
<a name="l00777"></a>00777             <span class="stringliteral">&apos;-u&apos;</span>, <span class="stringliteral">&apos;--uri&apos;</span>, action=<span class="stringliteral">&quot;store&quot;</span>, type=str, metavar=<span class="stringliteral">&apos;&lt;URI&gt;&apos;</span>,
<a name="l00778"></a>00778             dest=<span class="stringliteral">&quot;uri&quot;</span>, help=<span class="stringliteral">&apos;Uniform resource identifier (env LSMCLI_URI)&apos;</span>)
<a name="l00779"></a>00779 
<a name="l00780"></a>00780         parent_parser.add_argument(
<a name="l00781"></a>00781             <span class="stringliteral">&apos;-P&apos;</span>, <span class="stringliteral">&apos;--prompt&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;prompt&quot;</span>,
<a name="l00782"></a>00782             help=<span class="stringliteral">&apos;Prompt for password (env LSMCLI_PASSWORD)&apos;</span>)
<a name="l00783"></a>00783 
<a name="l00784"></a>00784         parent_parser.add_argument(
<a name="l00785"></a>00785             <span class="stringliteral">&apos;-H&apos;</span>, <span class="stringliteral">&apos;--human&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;human&quot;</span>,
<a name="l00786"></a>00786             help=<span class="stringliteral">&apos;Print sizes in human readable format\n&apos;</span>
<a name="l00787"></a>00787                  <span class="stringliteral">&apos;(e.g., MiB, GiB, TiB)&apos;</span>)
<a name="l00788"></a>00788 
<a name="l00789"></a>00789         parent_parser.add_argument(
<a name="l00790"></a>00790             <span class="stringliteral">&apos;-t&apos;</span>, <span class="stringliteral">&apos;--terse&apos;</span>, action=<span class="stringliteral">&quot;store&quot;</span>, dest=<span class="stringliteral">&quot;sep&quot;</span>, metavar=<span class="stringliteral">&apos;&lt;SEP&gt;&apos;</span>,
<a name="l00791"></a>00791             help=<span class="stringliteral">&apos;Print output in terse form with &quot;SEP&quot; &apos;</span>
<a name="l00792"></a>00792                  <span class="stringliteral">&apos;as a record separator&apos;</span>)
<a name="l00793"></a>00793 
<a name="l00794"></a>00794         parent_parser.add_argument(
<a name="l00795"></a>00795             <span class="stringliteral">&apos;-e&apos;</span>, <span class="stringliteral">&apos;--enum&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;enum&quot;</span>, default=<span class="keyword">False</span>,
<a name="l00796"></a>00796             help=<span class="stringliteral">&apos;Display enumerated types as numbers instead of text&apos;</span>)
<a name="l00797"></a>00797 
<a name="l00798"></a>00798         parent_parser.add_argument(
<a name="l00799"></a>00799             <span class="stringliteral">&apos;-f&apos;</span>, <span class="stringliteral">&apos;--force&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;force&quot;</span>, default=<span class="keyword">False</span>,
<a name="l00800"></a>00800             help=<span class="stringliteral">&apos;Bypass confirmation prompt for data loss operations&apos;</span>)
<a name="l00801"></a>00801 
<a name="l00802"></a>00802         parent_parser.add_argument(
<a name="l00803"></a>00803             <span class="stringliteral">&apos;-w&apos;</span>, <span class="stringliteral">&apos;--wait&apos;</span>, action=<span class="stringliteral">&quot;store&quot;</span>, type=int, dest=<span class="stringliteral">&quot;wait&quot;</span>,
<a name="l00804"></a>00804             default=30000, help=<span class="stringliteral">&quot;Command timeout value in ms (default = 30s)&quot;</span>)
<a name="l00805"></a>00805 
<a name="l00806"></a>00806         parent_parser.add_argument(
<a name="l00807"></a>00807             <span class="stringliteral">&apos;--header&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;header&quot;</span>,
<a name="l00808"></a>00808             help=<span class="stringliteral">&apos;Include the header with terse&apos;</span>)
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         parent_parser.add_argument(
<a name="l00811"></a>00811             <span class="stringliteral">&apos;-b&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;async&quot;</span>, default=<span class="keyword">False</span>,
<a name="l00812"></a>00812             help=<span class="stringliteral">&apos;Run the command async. Instead of waiting for completion.\n &apos;</span>
<a name="l00813"></a>00813                  <span class="stringliteral">&apos;Command will exit(7) and job id written to stdout.&apos;</span>)
<a name="l00814"></a>00814 
<a name="l00815"></a>00815         parent_parser.add_argument(
<a name="l00816"></a>00816             <span class="stringliteral">&apos;-s&apos;</span>, <span class="stringliteral">&apos;--script&apos;</span>, action=<span class="stringliteral">&quot;store_true&quot;</span>, dest=<span class="stringliteral">&quot;script&quot;</span>,
<a name="l00817"></a>00817             default=<span class="keyword">False</span>, help=<span class="stringliteral">&apos;Displaying data in script friendly way.&apos;</span>)
<a name="l00818"></a>00818 
<a name="l00819"></a>00819         parser = ArgumentParser(
<a name="l00820"></a>00820             description=<span class="stringliteral">&apos;The libStorageMgmt command line interface.&apos;</span>
<a name="l00821"></a>00821                         <span class="stringliteral">&apos; Run %(prog)s &lt;command&gt; -h for more on each command.&apos;</span>,
<a name="l00822"></a>00822             epilog=<span class="stringliteral">&apos;Copyright 2012-2015 Red Hat, Inc.\n&apos;</span>
<a name="l00823"></a>00823                    <span class="stringliteral">&apos;Please report bugs to &apos;</span>
<a name="l00824"></a>00824                    <span class="stringliteral">&apos;&lt;libstoragemgmt-devel@lists.fedorahosted.org&gt;\n&apos;</span>,
<a name="l00825"></a>00825             formatter_class=RawTextHelpFormatter,
<a name="l00826"></a>00826             parents=[parent_parser])
<a name="l00827"></a>00827 
<a name="l00828"></a>00828         subparsers = parser.add_subparsers(metavar=<span class="stringliteral">&quot;command&quot;</span>)
<a name="l00829"></a>00829 
<a name="l00830"></a>00830         <span class="comment"># Walk the command list and add all of them to the parser</span>
<a name="l00831"></a>00831         <span class="keywordflow">for</span> cmd <span class="keywordflow">in</span> cmds:
<a name="l00832"></a>00832             sub_parser = subparsers.add_parser(
<a name="l00833"></a>00833                 cmd[<span class="stringliteral">&apos;name&apos;</span>], help=cmd[<span class="stringliteral">&apos;help&apos;</span>], parents=[parent_parser],
<a name="l00834"></a>00834                 formatter_class=RawTextHelpFormatter)
<a name="l00835"></a>00835 
<a name="l00836"></a>00836             group = sub_parser.add_argument_group(<span class="stringliteral">&quot;cmd required arguments&quot;</span>)
<a name="l00837"></a>00837             <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> cmd.get(<span class="stringliteral">&apos;args&apos;</span>, []):
<a name="l00838"></a>00838                 name = arg[<span class="stringliteral">&apos;name&apos;</span>]
<a name="l00839"></a>00839                 del arg[<span class="stringliteral">&apos;name&apos;</span>]
<a name="l00840"></a>00840                 group.add_argument(name, required=<span class="keyword">True</span>, **arg)
<a name="l00841"></a>00841 
<a name="l00842"></a>00842             group = sub_parser.add_argument_group(<span class="stringliteral">&quot;cmd optional arguments&quot;</span>)
<a name="l00843"></a>00843             <span class="keywordflow">for</span> arg <span class="keywordflow">in</span> cmd.get(<span class="stringliteral">&apos;optional&apos;</span>, []):
<a name="l00844"></a>00844                 flags = arg[<span class="stringliteral">&apos;name&apos;</span>]
<a name="l00845"></a>00845                 del arg[<span class="stringliteral">&apos;name&apos;</span>]
<a name="l00846"></a>00846                 <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(flags, tuple):
<a name="l00847"></a>00847                     flags = (flags,)
<a name="l00848"></a>00848                 group.add_argument(*flags, **arg)
<a name="l00849"></a>00849 
<a name="l00850"></a>00850             sub_parser.set_defaults(
<a name="l00851"></a>00851                 func=getattr(self, cmd[<span class="stringliteral">&apos;name&apos;</span>].replace(<span class="stringliteral">&quot;-&quot;</span>, <span class="stringliteral">&quot;_&quot;</span>)))
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <span class="keywordflow">for</span> alias <span class="keywordflow">in</span> aliases:
<a name="l00854"></a>00854             sub_parser = subparsers.add_parser(
<a name="l00855"></a>00855                 alias[0], help=<span class="stringliteral">&quot;Alias of &apos;%s&apos;&quot;</span> % alias[1],
<a name="l00856"></a>00856                 parents=[parent_parser],
<a name="l00857"></a>00857                 formatter_class=RawTextHelpFormatter, add_help=<span class="keyword">False</span>)
<a name="l00858"></a>00858             sub_parser.set_defaults(
<a name="l00859"></a>00859                 cmd=alias[1].split(<span class="stringliteral">&quot; &quot;</span>), func=self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2ec8fb4faccf7ffdd9bf225ff43fdf4c">handle_alias</a>)
<a name="l00860"></a>00860 
<a name="l00861"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a90eee7a4677ca8b1ed116364a24367f9">00861</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a90eee7a4677ca8b1ed116364a24367f9">parser</a> = parser
<a name="l00862"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3afcab76f1db5dda05ca54af8e79d06">00862</a>         known_agrs, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3afcab76f1db5dda05ca54af8e79d06">unknown_args</a> = parser.parse_known_args()
<a name="l00863"></a>00863         <span class="keywordflow">return</span> known_agrs
<a name="l00864"></a>00864 
<a name="l00865"></a>00865     <span class="comment">## Display the types of nfs client authentication that are supported.</span>
<a name="l00866"></a>00866     <span class="comment"># @return None</span>
<a name="l00867"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a5691f36be3bfb9551ba0d651701ab391">00867</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a5691f36be3bfb9551ba0d651701ab391" title="Display the types of nfs client authentication that are supported.">display_nfs_client_authentication</a>(self):
<a name="l00868"></a>00868         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l00869"></a>00869 <span class="stringliteral">        Dump the supported nfs client authentication types</span>
<a name="l00870"></a>00870 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l00871"></a>00871         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep:
<a name="l00872"></a>00872             out(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep.join(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.export_auth()))
<a name="l00873"></a>00873         <span class="keywordflow">else</span>:
<a name="l00874"></a>00874             out(<span class="stringliteral">&quot;, &quot;</span>.join(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.export_auth()))
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="comment">## Method that calls the appropriate method based on what the list type is</span>
<a name="l00877"></a>00877     <span class="comment"># @param    args    Argparse argument object</span>
<a name="l00878"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b522b4ef7526bfa60b78fe735caa55c">00878</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b522b4ef7526bfa60b78fe735caa55c" title="Method that calls the appropriate method based on what the list type is.">list</a>(self, args):
<a name="l00879"></a>00879         search_key = <span class="keywordtype">None</span>
<a name="l00880"></a>00880         search_value = <span class="keywordtype">None</span>
<a name="l00881"></a>00881         <span class="keywordflow">if</span> args.sys:
<a name="l00882"></a>00882             search_key = <span class="stringliteral">&apos;system_id&apos;</span>
<a name="l00883"></a>00883             search_value = args.sys
<a name="l00884"></a>00884         <span class="keywordflow">if</span> args.pool:
<a name="l00885"></a>00885             search_key = <span class="stringliteral">&apos;pool_id&apos;</span>
<a name="l00886"></a>00886             search_value = args.pool
<a name="l00887"></a>00887         <span class="keywordflow">if</span> args.vol:
<a name="l00888"></a>00888             search_key = <span class="stringliteral">&apos;volume_id&apos;</span>
<a name="l00889"></a>00889             search_value = args.vol
<a name="l00890"></a>00890         <span class="keywordflow">if</span> args.disk:
<a name="l00891"></a>00891             search_key = <span class="stringliteral">&apos;disk_id&apos;</span>
<a name="l00892"></a>00892             search_value = args.disk
<a name="l00893"></a>00893         <span class="keywordflow">if</span> args.ag:
<a name="l00894"></a>00894             search_key = <span class="stringliteral">&apos;access_group_id&apos;</span>
<a name="l00895"></a>00895             search_value = args.ag
<a name="l00896"></a>00896         <span class="keywordflow">if</span> args.fs:
<a name="l00897"></a>00897             search_key = <span class="stringliteral">&apos;fs_id&apos;</span>
<a name="l00898"></a>00898             search_value = args.ag
<a name="l00899"></a>00899         <span class="keywordflow">if</span> args.nfs_export:
<a name="l00900"></a>00900             search_key = <span class="stringliteral">&apos;nfs_export_id&apos;</span>
<a name="l00901"></a>00901             search_value = args.nfs_export
<a name="l00902"></a>00902         <span class="keywordflow">if</span> args.tgt:
<a name="l00903"></a>00903             search_key = <span class="stringliteral">&apos;tgt_port_id&apos;</span>
<a name="l00904"></a>00904             search_value = args.tgt
<a name="l00905"></a>00905 
<a name="l00906"></a>00906         <span class="keywordflow">if</span> args.type == <span class="stringliteral">&apos;VOLUMES&apos;</span>:
<a name="l00907"></a>00907             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;volume_id&apos;</span>:
<a name="l00908"></a>00908                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00909"></a>00909             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;access_group_id&apos;</span>:
<a name="l00910"></a>00910                 lsm_ag = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups(), args.ag,
<a name="l00911"></a>00911                                    <span class="stringliteral">&quot;Access Group&quot;</span>, raise_error=<span class="keyword">False</span>)
<a name="l00912"></a>00912                 <span class="keywordflow">if</span> lsm_ag:
<a name="l00913"></a>00913                     <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00914"></a>00914                         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes_accessible_by_access_group(lsm_ag))
<a name="l00915"></a>00915                 <span class="keywordflow">else</span>:
<a name="l00916"></a>00916                     <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([])
<a name="l00917"></a>00917             <span class="keywordflow">elif</span> search_key <span class="keywordflow">and</span> search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> Volume.SUPPORTED_SEARCH_KEYS:
<a name="l00918"></a>00918                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00919"></a>00919                                <span class="stringliteral">&quot;volume listing.&quot;</span> % search_key)
<a name="l00920"></a>00920             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(search_key, search_value))
<a name="l00921"></a>00921         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;POOLS&apos;</span>:
<a name="l00922"></a>00922             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;pool_id&apos;</span>:
<a name="l00923"></a>00923                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00924"></a>00924             <span class="keywordflow">if</span> search_key <span class="keywordflow">and</span> search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> Pool.SUPPORTED_SEARCH_KEYS:
<a name="l00925"></a>00925                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00926"></a>00926                                <span class="stringliteral">&quot;pool listing.&quot;</span> % search_key)
<a name="l00927"></a>00927             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00928"></a>00928                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pools(search_key, search_value))
<a name="l00929"></a>00929         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;FS&apos;</span>:
<a name="l00930"></a>00930             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;fs_id&apos;</span>:
<a name="l00931"></a>00931                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00932"></a>00932             <span class="keywordflow">if</span> search_key <span class="keywordflow">and</span> \
<a name="l00933"></a>00933                search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> FileSystem.SUPPORTED_SEARCH_KEYS:
<a name="l00934"></a>00934                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00935"></a>00935                                <span class="stringliteral">&quot;volume listing.&quot;</span> % search_key)
<a name="l00936"></a>00936             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(search_key, search_value))
<a name="l00937"></a>00937         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;SNAPSHOTS&apos;</span>:
<a name="l00938"></a>00938             <span class="keywordflow">if</span> args.fs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l00939"></a>00939                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;--fs &lt;file system id&gt; required&quot;</span>)
<a name="l00940"></a>00940             fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&apos;File System&apos;</span>)
<a name="l00941"></a>00941             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshots(fs))
<a name="l00942"></a>00942         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;EXPORTS&apos;</span>:
<a name="l00943"></a>00943             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;nfs_export_id&apos;</span>:
<a name="l00944"></a>00944                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00945"></a>00945             <span class="keywordflow">if</span> search_key <span class="keywordflow">and</span> \
<a name="l00946"></a>00946                search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> NfsExport.SUPPORTED_SEARCH_KEYS:
<a name="l00947"></a>00947                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00948"></a>00948                                <span class="stringliteral">&quot;NFS Export listing&quot;</span> % search_key)
<a name="l00949"></a>00949             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.exports(search_key, search_value))
<a name="l00950"></a>00950         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;NFS_CLIENT_AUTH&apos;</span>:
<a name="l00951"></a>00951             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a5691f36be3bfb9551ba0d651701ab391" title="Display the types of nfs client authentication that are supported.">display_nfs_client_authentication</a>()
<a name="l00952"></a>00952         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;ACCESS_GROUPS&apos;</span>:
<a name="l00953"></a>00953             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;access_group_id&apos;</span>:
<a name="l00954"></a>00954                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00955"></a>00955             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;volume_id&apos;</span>:
<a name="l00956"></a>00956                 lsm_vol = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol,
<a name="l00957"></a>00957                                     <span class="stringliteral">&quot;Volume&quot;</span>, raise_error=<span class="keyword">False</span>)
<a name="l00958"></a>00958                 <span class="keywordflow">if</span> lsm_vol:
<a name="l00959"></a>00959                     <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00960"></a>00960                         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups_granted_to_volume(lsm_vol))
<a name="l00961"></a>00961                 <span class="keywordflow">else</span>:
<a name="l00962"></a>00962                     <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([])
<a name="l00963"></a>00963             <span class="keywordflow">elif</span> (search_key <span class="keywordflow">and</span>
<a name="l00964"></a>00964                   search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> AccessGroup.SUPPORTED_SEARCH_KEYS):
<a name="l00965"></a>00965                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00966"></a>00966                                <span class="stringliteral">&quot;Access Group listing&quot;</span> % search_key)
<a name="l00967"></a>00967             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00968"></a>00968                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups(search_key, search_value))
<a name="l00969"></a>00969         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;SYSTEMS&apos;</span>:
<a name="l00970"></a>00970             <span class="keywordflow">if</span> search_key:
<a name="l00971"></a>00971                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;System listing with search is not supported&quot;</span>)
<a name="l00972"></a>00972             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.systems())
<a name="l00973"></a>00973         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;DISKS&apos;</span>:
<a name="l00974"></a>00974             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;disk_id&apos;</span>:
<a name="l00975"></a>00975                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00976"></a>00976             <span class="keywordflow">if</span> search_key <span class="keywordflow">and</span> search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> Disk.SUPPORTED_SEARCH_KEYS:
<a name="l00977"></a>00977                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00978"></a>00978                                <span class="stringliteral">&quot;disk listing&quot;</span> % search_key)
<a name="l00979"></a>00979             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00980"></a>00980                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.disks(search_key, search_value))
<a name="l00981"></a>00981         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;TARGET_PORTS&apos;</span>:
<a name="l00982"></a>00982             <span class="keywordflow">if</span> search_key == <span class="stringliteral">&apos;tgt_port_id&apos;</span>:
<a name="l00983"></a>00983                 search_key = <span class="stringliteral">&apos;id&apos;</span>
<a name="l00984"></a>00984             <span class="keywordflow">if</span> search_key <span class="keywordflow">and</span> \
<a name="l00985"></a>00985                search_key <span class="keywordflow">not</span> <span class="keywordflow">in</span> TargetPort.SUPPORTED_SEARCH_KEYS:
<a name="l00986"></a>00986                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Search key &apos;%s&apos; is not supported by &quot;</span>
<a name="l00987"></a>00987                                <span class="stringliteral">&quot;target port listing&quot;</span> % search_key)
<a name="l00988"></a>00988             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l00989"></a>00989                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.target_ports(search_key, search_value))
<a name="l00990"></a>00990         <span class="keywordflow">elif</span> args.type == <span class="stringliteral">&apos;PLUGINS&apos;</span>:
<a name="l00991"></a>00991             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b7922c41c26fb5a903362a6b26beb26">display_available_plugins</a>()
<a name="l00992"></a>00992         <span class="keywordflow">else</span>:
<a name="l00993"></a>00993             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;unsupported listing type=%s&quot;</span> % args.type)
<a name="l00994"></a>00994 
<a name="l00995"></a>00995     <span class="comment">## Creates an access group.</span>
<a name="l00996"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af63a602f74f6962c3e221f95139b6ec9">00996</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af63a602f74f6962c3e221f95139b6ec9" title="Creates an access group.">access_group_create</a>(self, args):
<a name="l00997"></a>00997         system = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.systems(), args.sys, <span class="stringliteral">&quot;System&quot;</span>)
<a name="l00998"></a>00998         (init_id, init_type) = parse_convert_init(args.init)
<a name="l00999"></a>00999         access_group = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_group_create(args.name, init_id,
<a name="l01000"></a>01000                                                   init_type, system)
<a name="l01001"></a>01001         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([access_group])
<a name="l01002"></a>01002 
<a name="l01003"></a>01003     <span class="keyword">def </span>_add_rm_access_grp_init(self, args, op):
<a name="l01004"></a>01004         lsm_ag = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups(), args.ag, <span class="stringliteral">&quot;Access Group&quot;</span>)
<a name="l01005"></a>01005         (init_id, init_type) = parse_convert_init(args.init)
<a name="l01006"></a>01006 
<a name="l01007"></a>01007         <span class="keywordflow">if</span> op:
<a name="l01008"></a>01008             <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_group_initiator_add(lsm_ag, init_id,
<a name="l01009"></a>01009                                                      init_type)
<a name="l01010"></a>01010         <span class="keywordflow">else</span>:
<a name="l01011"></a>01011             <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_group_initiator_delete(lsm_ag, init_id,
<a name="l01012"></a>01012                                                         init_type)
<a name="l01013"></a>01013 
<a name="l01014"></a>01014     <span class="comment">## Adds an initiator from an access group</span>
<a name="l01015"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a16fe3f9c9cd93f759fc954139c488c42">01015</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a16fe3f9c9cd93f759fc954139c488c42" title="Adds an initiator from an access group.">access_group_add</a>(self, args):
<a name="l01016"></a>01016         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a508e26a840706142a4f7bf17e574407c">_add_rm_access_grp_init</a>(args, <span class="keyword">True</span>)])
<a name="l01017"></a>01017 
<a name="l01018"></a>01018     <span class="comment">## Removes an initiator from an access group</span>
<a name="l01019"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9ad5541a6c2f21e3e2c087ba5b33b744">01019</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9ad5541a6c2f21e3e2c087ba5b33b744" title="Removes an initiator from an access group.">access_group_remove</a>(self, args):
<a name="l01020"></a>01020         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a508e26a840706142a4f7bf17e574407c">_add_rm_access_grp_init</a>(args, <span class="keyword">False</span>)])
<a name="l01021"></a>01021 
<a name="l01022"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aff2034c612157f32740e337ebae5f3f9">01022</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aff2034c612157f32740e337ebae5f3f9">access_group_volumes</a>(self, args):
<a name="l01023"></a>01023         agl = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups()
<a name="l01024"></a>01024         group = _get_item(agl, args.ag, <span class="stringliteral">&quot;Access Group&quot;</span>)
<a name="l01025"></a>01025         vols = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes_accessible_by_access_group(group)
<a name="l01026"></a>01026         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(vols)
<a name="l01027"></a>01027 
<a name="l01028"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a799b6cea920018f1d83a08d3db42b2d4">01028</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a799b6cea920018f1d83a08d3db42b2d4">iscsi_chap</a>(self, args):
<a name="l01029"></a>01029         (init_id, init_type) = parse_convert_init(args.init)
<a name="l01030"></a>01030         <span class="keywordflow">if</span> init_type != AccessGroup.INIT_TYPE_ISCSI_IQN:
<a name="l01031"></a>01031             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;--init-id %s is not a valid iSCSI IQN&quot;</span> % args.init)
<a name="l01032"></a>01032 
<a name="l01033"></a>01033         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.iscsi_chap_auth(init_id, args.in_user,
<a name="l01034"></a>01034                                self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.in_pass,
<a name="l01035"></a>01035                                self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.out_user,
<a name="l01036"></a>01036                                self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.out_pass)
<a name="l01037"></a>01037 
<a name="l01038"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af2994fe7ab94e2398ec4fda8a4669837">01038</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af2994fe7ab94e2398ec4fda8a4669837">volume_access_group</a>(self, args):
<a name="l01039"></a>01039         vol = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01040"></a>01040         groups = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups_granted_to_volume(vol)
<a name="l01041"></a>01041         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(groups)
<a name="l01042"></a>01042 
<a name="l01043"></a>01043     <span class="comment">## Used to delete access group</span>
<a name="l01044"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aba0f6f045f87fd8f6fe322a8793e6a69">01044</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aba0f6f045f87fd8f6fe322a8793e6a69" title="Used to delete access group.">access_group_delete</a>(self, args):
<a name="l01045"></a>01045         agl = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups()
<a name="l01046"></a>01046         group = _get_item(agl, args.ag, <span class="stringliteral">&quot;Access Group&quot;</span>)
<a name="l01047"></a>01047         <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_group_delete(group)
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <span class="comment">## Used to delete a file system</span>
<a name="l01050"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a3d6ad99bdaf903dc771c3f82f94a812f">01050</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a3d6ad99bdaf903dc771c3f82f94a812f" title="Used to delete a file system.">fs_delete</a>(self, args):
<a name="l01051"></a>01051         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01052"></a>01052         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">True</span>):
<a name="l01053"></a>01053             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;fs-delete&quot;</span>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_delete(fs), <span class="keywordtype">None</span>)
<a name="l01054"></a>01054 
<a name="l01055"></a>01055     <span class="comment">## Used to create a file system</span>
<a name="l01056"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a3524bdbbe612872536d978a2c82cf02b">01056</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a3524bdbbe612872536d978a2c82cf02b" title="Used to create a file system.">fs_create</a>(self, args):
<a name="l01057"></a>01057         p = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pools(), args.pool, <span class="stringliteral">&quot;Pool&quot;</span>)
<a name="l01058"></a>01058         fs = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;fs-create&quot;</span>,
<a name="l01059"></a>01059                                *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_create(p, args.name,
<a name="l01060"></a>01060                                                  self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a32d46a370231146113ec4853762dc50c" title="Converts a size parameter into the appropriate number of bytes.">_size</a>(args.size)))
<a name="l01061"></a>01061         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([fs])
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     <span class="comment">## Used to resize a file system</span>
<a name="l01064"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a59de229f82d74c0dc6c5bb890491a06d">01064</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a59de229f82d74c0dc6c5bb890491a06d" title="Used to resize a file system.">fs_resize</a>(self, args):
<a name="l01065"></a>01065         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01066"></a>01066         size = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a32d46a370231146113ec4853762dc50c" title="Converts a size parameter into the appropriate number of bytes.">_size</a>(args.size)
<a name="l01067"></a>01067 
<a name="l01068"></a>01068         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">False</span>):
<a name="l01069"></a>01069             fs = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;fs-resize&quot;</span>,
<a name="l01070"></a>01070                                    *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_resize(fs, size))
<a name="l01071"></a>01071             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([fs])
<a name="l01072"></a>01072 
<a name="l01073"></a>01073     <span class="comment">## Used to clone a file system</span>
<a name="l01074"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a359ed1df01a4ef2fc9a4121583b7dfbc">01074</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a359ed1df01a4ef2fc9a4121583b7dfbc" title="Used to clone a file system.">fs_clone</a>(self, args):
<a name="l01075"></a>01075         src_fs = _get_item(
<a name="l01076"></a>01076             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.src_fs, <span class="stringliteral">&quot;Source File System&quot;</span>)
<a name="l01077"></a>01077 
<a name="l01078"></a>01078         ss = <span class="keywordtype">None</span>
<a name="l01079"></a>01079         <span class="keywordflow">if</span> args.backing_snapshot:
<a name="l01080"></a>01080             <span class="comment">#go get the snapshot</span>
<a name="l01081"></a>01081             ss = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshots(src_fs),
<a name="l01082"></a>01082                            args.backing_snapshot, <span class="stringliteral">&quot;Snapshot&quot;</span>)
<a name="l01083"></a>01083 
<a name="l01084"></a>01084         fs = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(
<a name="l01085"></a>01085             <span class="stringliteral">&quot;fs_clone&quot;</span>, *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_clone(src_fs, args.dst_name, ss))
<a name="l01086"></a>01086         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([fs])
<a name="l01087"></a>01087 
<a name="l01088"></a>01088     <span class="comment">## Used to clone a file(s)</span>
<a name="l01089"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a618f2b2b4a0d5398f3b486bc17e145ac">01089</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a618f2b2b4a0d5398f3b486bc17e145ac" title="Used to clone a file(s).">file_clone</a>(self, args):
<a name="l01090"></a>01090         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01091"></a>01091         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.backing_snapshot:
<a name="l01092"></a>01092             <span class="comment">#go get the snapshot</span>
<a name="l01093"></a>01093             ss = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshots(fs),
<a name="l01094"></a>01094                            args.backing_snapshot, <span class="stringliteral">&quot;Snapshot&quot;</span>)
<a name="l01095"></a>01095         <span class="keywordflow">else</span>:
<a name="l01096"></a>01096             ss = <span class="keywordtype">None</span>
<a name="l01097"></a>01097 
<a name="l01098"></a>01098         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(
<a name="l01099"></a>01099             <span class="stringliteral">&quot;fs_file_clone&quot;</span>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_file_clone(fs, args.src, args.dst, ss),
<a name="l01100"></a>01100             <span class="keywordtype">None</span>)
<a name="l01101"></a>01101 
<a name="l01102"></a>01102     <span class="comment">##Converts a size parameter into the appropriate number of bytes</span>
<a name="l01103"></a>01103     <span class="comment"># @param    s   Size to convert to bytes handles B, K, M, G, T, P postfix</span>
<a name="l01104"></a>01104     <span class="comment"># @return Size in bytes</span>
<a name="l01105"></a>01105     @staticmethod
<a name="l01106"></a>01106     <span class="keyword">def </span>_size(s):
<a name="l01107"></a>01107         size_bytes = size_human_2_size_bytes(s)
<a name="l01108"></a>01108         <span class="keywordflow">if</span> size_bytes &lt;= 0:
<a name="l01109"></a>01109             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Incorrect size argument format: &apos;%s&apos;&quot;</span> % s)
<a name="l01110"></a>01110         <span class="keywordflow">return</span> size_bytes
<a name="l01111"></a>01111 
<a name="l01112"></a>01112     <span class="keyword">def </span>_cp(self, cap, val):
<a name="l01113"></a>01113         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01114"></a>01114             s = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep
<a name="l01115"></a>01115         <span class="keywordflow">else</span>:
<a name="l01116"></a>01116             s = <span class="stringliteral">&apos;:&apos;</span>
<a name="l01117"></a>01117 
<a name="l01118"></a>01118         <span class="keywordflow">if</span> val:
<a name="l01119"></a>01119             v = <span class="stringliteral">&quot;SUPPORTED&quot;</span>
<a name="l01120"></a>01120         <span class="keywordflow">else</span>:
<a name="l01121"></a>01121             v = <span class="stringliteral">&quot;UNSUPPORTED&quot;</span>
<a name="l01122"></a>01122 
<a name="l01123"></a>01123         out(<span class="stringliteral">&quot;%s%s%s&quot;</span> % (cap, s, v))
<a name="l01124"></a>01124 
<a name="l01125"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3b7358ada9758fe36dcf0d70c872148">01125</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3b7358ada9758fe36dcf0d70c872148">capabilities</a>(self, args):
<a name="l01126"></a>01126         s = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.systems(), args.sys, <span class="stringliteral">&quot;System&quot;</span>)
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         cap = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.capabilities(s)
<a name="l01129"></a>01129         sup_caps = sorted(cap.get_supported().values())
<a name="l01130"></a>01130         all_caps = sorted(cap.get_supported(<span class="keyword">True</span>).values())
<a name="l01131"></a>01131 
<a name="l01132"></a>01132         sep = DisplayData.DEFAULT_SPLITTER
<a name="l01133"></a>01133         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01134"></a>01134             sep = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.sep
<a name="l01135"></a>01135 
<a name="l01136"></a>01136         cap_data = OrderedDict()
<a name="l01137"></a>01137         <span class="comment"># Show support capabilities first</span>
<a name="l01138"></a>01138         <span class="keywordflow">for</span> v <span class="keywordflow">in</span> sup_caps:
<a name="l01139"></a>01139             cap_data[v] = <span class="stringliteral">&apos;SUPPORTED&apos;</span>
<a name="l01140"></a>01140 
<a name="l01141"></a>01141         <span class="keywordflow">for</span> v <span class="keywordflow">in</span> all_caps:
<a name="l01142"></a>01142             <span class="keywordflow">if</span> v <span class="keywordflow">not</span> <span class="keywordflow">in</span> sup_caps:
<a name="l01143"></a>01143                 cap_data[v] = <span class="stringliteral">&apos;UNSUPPORTED&apos;</span>
<a name="l01144"></a>01144 
<a name="l01145"></a>01145         DisplayData.display_data_script_way([cap_data], sep)
<a name="l01146"></a>01146 
<a name="l01147"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aa10cf6df537af5edef9ebc7b1cc731db">01147</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aa10cf6df537af5edef9ebc7b1cc731db">plugin_info</a>(self, args):
<a name="l01148"></a>01148         desc, version = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.plugin_info()
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="keywordflow">if</span> args.sep:
<a name="l01151"></a>01151             out(<span class="stringliteral">&quot;%s%s%s&quot;</span> % (desc, args.sep, version))
<a name="l01152"></a>01152         <span class="keywordflow">else</span>:
<a name="l01153"></a>01153             out(<span class="stringliteral">&quot;Description: %s Version: %s&quot;</span> % (desc, version))
<a name="l01154"></a>01154 
<a name="l01155"></a>01155     <span class="comment">## Creates a volume</span>
<a name="l01156"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a720c825bce313b878e3d1839bbee6984">01156</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a720c825bce313b878e3d1839bbee6984" title="Creates a volume.">volume_create</a>(self, args):
<a name="l01157"></a>01157         <span class="comment">#Get pool</span>
<a name="l01158"></a>01158         p = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pools(), args.pool, <span class="stringliteral">&quot;Pool&quot;</span>)
<a name="l01159"></a>01159         vol = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(
<a name="l01160"></a>01160             <span class="stringliteral">&quot;volume-create&quot;</span>,
<a name="l01161"></a>01161             *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_create(
<a name="l01162"></a>01162                 p,
<a name="l01163"></a>01163                 args.name,
<a name="l01164"></a>01164                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a32d46a370231146113ec4853762dc50c" title="Converts a size parameter into the appropriate number of bytes.">_size</a>(args.size),
<a name="l01165"></a>01165                 vol_provision_str_to_type(args.provisioning)))
<a name="l01166"></a>01166         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([vol])
<a name="l01167"></a>01167 
<a name="l01168"></a>01168     <span class="comment">## Creates a snapshot</span>
<a name="l01169"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aac5fbc8cea4ec3187960e6337ab99957">01169</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aac5fbc8cea4ec3187960e6337ab99957" title="Creates a snapshot.">fs_snap_create</a>(self, args):
<a name="l01170"></a>01170         <span class="comment">#Get fs</span>
<a name="l01171"></a>01171         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01172"></a>01172         ss = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;snapshot-create&quot;</span>,
<a name="l01173"></a>01173                                *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshot_create(
<a name="l01174"></a>01174                                    fs,
<a name="l01175"></a>01175                                    args.name))
<a name="l01176"></a>01176 
<a name="l01177"></a>01177         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([ss])
<a name="l01178"></a>01178 
<a name="l01179"></a>01179     <span class="comment">## Restores a snap shot</span>
<a name="l01180"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a106582724ae76bc8d5110b21af0286dd">01180</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a106582724ae76bc8d5110b21af0286dd" title="Restores a snap shot.">fs_snap_restore</a>(self, args):
<a name="l01181"></a>01181         <span class="comment">#Get snapshot</span>
<a name="l01182"></a>01182         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01183"></a>01183         ss = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshots(fs), args.snap, <span class="stringliteral">&quot;Snapshot&quot;</span>)
<a name="l01184"></a>01184 
<a name="l01185"></a>01185         flag_all_files = <span class="keyword">True</span>
<a name="l01186"></a>01186 
<a name="l01187"></a>01187         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.file:
<a name="l01188"></a>01188             flag_all_files = <span class="keyword">False</span>
<a name="l01189"></a>01189             <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.fileas:
<a name="l01190"></a>01190                 <span class="keywordflow">if</span> len(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.file) != len(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.fileas):
<a name="l01191"></a>01191                     <span class="keywordflow">raise</span> ArgError(
<a name="l01192"></a>01192                         <span class="stringliteral">&quot;number of --file not equal to --fileas&quot;</span>)
<a name="l01193"></a>01193 
<a name="l01194"></a>01194         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">True</span>):
<a name="l01195"></a>01195             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(
<a name="l01196"></a>01196                 <span class="stringliteral">&apos;fs-snap-restore&apos;</span>,
<a name="l01197"></a>01197                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshot_restore(
<a name="l01198"></a>01198                     fs, ss, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.file, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.fileas, flag_all_files),
<a name="l01199"></a>01199                 <span class="keywordtype">None</span>)
<a name="l01200"></a>01200 
<a name="l01201"></a>01201     <span class="comment">## Deletes a volume</span>
<a name="l01202"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae3cdf39f9436c7f2bd0dfc6d372d17fb">01202</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae3cdf39f9436c7f2bd0dfc6d372d17fb" title="Deletes a volume.">volume_delete</a>(self, args):
<a name="l01203"></a>01203         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01204"></a>01204         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">True</span>):
<a name="l01205"></a>01205             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;volume-delete&quot;</span>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_delete(v),
<a name="l01206"></a>01206                               <span class="keywordtype">None</span>)
<a name="l01207"></a>01207 
<a name="l01208"></a>01208     <span class="comment">## Deletes a snap shot</span>
<a name="l01209"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aa8785d49bb940a97951de649b699c3f3">01209</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aa8785d49bb940a97951de649b699c3f3" title="Deletes a snap shot.">fs_snap_delete</a>(self, args):
<a name="l01210"></a>01210         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01211"></a>01211         ss = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshots(fs), args.snap, <span class="stringliteral">&quot;Snapshot&quot;</span>)
<a name="l01212"></a>01212 
<a name="l01213"></a>01213         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">True</span>):
<a name="l01214"></a>01214             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;fs_snap_delete&quot;</span>,
<a name="l01215"></a>01215                               self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_snapshot_delete(fs, ss), <span class="keywordtype">None</span>)
<a name="l01216"></a>01216 
<a name="l01217"></a>01217     <span class="comment">## Waits for an operation to complete by polling for the status of the</span>
<a name="l01218"></a>01218     <span class="comment"># operations.</span>
<a name="l01219"></a>01219     <span class="comment"># @param    msg     Message to display if this job fails</span>
<a name="l01220"></a>01220     <span class="comment"># @param    job     The job id to wait on</span>
<a name="l01221"></a>01221     <span class="comment"># @param    item    The item that could be available now if there is no job</span>
<a name="l01222"></a>01222     <span class="keyword">def </span>_wait_for_it(self, msg, job, item):
<a name="l01223"></a>01223         <span class="keywordflow">if</span> <span class="keywordflow">not</span> job:
<a name="l01224"></a>01224             <span class="keywordflow">return</span> item
<a name="l01225"></a>01225         <span class="keywordflow">else</span>:
<a name="l01226"></a>01226             <span class="comment">#If a user doesn&apos;t want to wait, return the job id to stdout</span>
<a name="l01227"></a>01227             <span class="comment">#and exit with job in progress</span>
<a name="l01228"></a>01228             <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.async:
<a name="l01229"></a>01229                 out(job)
<a name="l01230"></a>01230                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abbc72568e192ffdeda9cfed44cce64ff" title="Does appropriate clean-up.">shutdown</a>(ErrorNumber.JOB_STARTED)
<a name="l01231"></a>01231 
<a name="l01232"></a>01232             <span class="keywordflow">while</span> <span class="keyword">True</span>:
<a name="l01233"></a>01233                 (s, percent, item) = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.job_status(job)
<a name="l01234"></a>01234 
<a name="l01235"></a>01235                 <span class="keywordflow">if</span> s == JobStatus.INPROGRESS:
<a name="l01236"></a>01236                     <span class="comment">#Add an option to spit out progress?</span>
<a name="l01237"></a>01237                     <span class="comment">#print &quot;%s - Percent %s complete&quot; % (job, percent)</span>
<a name="l01238"></a>01238                     time.sleep(0.25)
<a name="l01239"></a>01239                 <span class="keywordflow">elif</span> s == JobStatus.COMPLETE:
<a name="l01240"></a>01240                     self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.job_free(job)
<a name="l01241"></a>01241                     <span class="keywordflow">return</span> item
<a name="l01242"></a>01242                 <span class="keywordflow">else</span>:
<a name="l01243"></a>01243                     <span class="comment">#Something better to do here?</span>
<a name="l01244"></a>01244                     <span class="keywordflow">raise</span> ArgError(msg + <span class="stringliteral">&quot; job error code= &quot;</span> + str(s))
<a name="l01245"></a>01245 
<a name="l01246"></a>01246     <span class="comment">## Retrieves the status of the specified job</span>
<a name="l01247"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a929de62122ccee78ed9f38cb27d894bd">01247</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a929de62122ccee78ed9f38cb27d894bd" title="Retrieves the status of the specified job.">job_status</a>(self, args):
<a name="l01248"></a>01248         (s, percent, item) = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.job_status(args.job)
<a name="l01249"></a>01249 
<a name="l01250"></a>01250         <span class="keywordflow">if</span> s == JobStatus.COMPLETE:
<a name="l01251"></a>01251             <span class="keywordflow">if</span> item:
<a name="l01252"></a>01252                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([item])
<a name="l01253"></a>01253 
<a name="l01254"></a>01254             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.job_free(args.job)
<a name="l01255"></a>01255         <span class="keywordflow">else</span>:
<a name="l01256"></a>01256             out(str(percent))
<a name="l01257"></a>01257             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abbc72568e192ffdeda9cfed44cce64ff" title="Does appropriate clean-up.">shutdown</a>(ErrorNumber.JOB_STARTED)
<a name="l01258"></a>01258 
<a name="l01259"></a>01259     <span class="comment">## Replicates a volume</span>
<a name="l01260"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a54ffcd18c3d421dd510c033f1bcfe917">01260</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a54ffcd18c3d421dd510c033f1bcfe917" title="Replicates a volume.">volume_replicate</a>(self, args):
<a name="l01261"></a>01261         p = <span class="keywordtype">None</span>
<a name="l01262"></a>01262         <span class="keywordflow">if</span> args.pool:
<a name="l01263"></a>01263             p = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pools(), args.pool, <span class="stringliteral">&quot;Pool&quot;</span>)
<a name="l01264"></a>01264 
<a name="l01265"></a>01265         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01266"></a>01266 
<a name="l01267"></a>01267         rep_type = vol_rep_type_str_to_type(args.rep_type)
<a name="l01268"></a>01268         <span class="keywordflow">if</span> rep_type == Volume.REPLICATE_UNKNOWN:
<a name="l01269"></a>01269             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;invalid replication type= %s&quot;</span> % rep_type)
<a name="l01270"></a>01270 
<a name="l01271"></a>01271         vol = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(
<a name="l01272"></a>01272             <span class="stringliteral">&quot;replicate volume&quot;</span>,
<a name="l01273"></a>01273             *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_replicate(p, rep_type, v, args.name))
<a name="l01274"></a>01274         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([vol])
<a name="l01275"></a>01275 
<a name="l01276"></a>01276     <span class="comment">## Replicates a range of a volume</span>
<a name="l01277"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3b1c179c79ff051c98baddf734513a0">01277</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3b1c179c79ff051c98baddf734513a0" title="Replicates a range of a volume.">volume_replicate_range</a>(self, args):
<a name="l01278"></a>01278         src = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.src_vol, <span class="stringliteral">&quot;Source Volume&quot;</span>)
<a name="l01279"></a>01279         dst = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.dst_vol,
<a name="l01280"></a>01280                         <span class="stringliteral">&quot;Destination Volume&quot;</span>)
<a name="l01281"></a>01281 
<a name="l01282"></a>01282         rep_type = vol_rep_type_str_to_type(args.rep_type)
<a name="l01283"></a>01283         <span class="keywordflow">if</span> rep_type == Volume.REPLICATE_UNKNOWN:
<a name="l01284"></a>01284             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;invalid replication type= %s&quot;</span> % rep_type)
<a name="l01285"></a>01285 
<a name="l01286"></a>01286         src_starts = args.src_start
<a name="l01287"></a>01287         dst_starts = args.dst_start
<a name="l01288"></a>01288         counts = args.count
<a name="l01289"></a>01289 
<a name="l01290"></a>01290         <span class="keywordflow">if</span> <span class="keywordflow">not</span> len(src_starts) \
<a name="l01291"></a>01291                 <span class="keywordflow">or</span> <span class="keywordflow">not</span> (len(src_starts) == len(dst_starts) == len(counts)):
<a name="l01292"></a>01292             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;Differing numbers of src_start, dest_start, &quot;</span>
<a name="l01293"></a>01293                            <span class="stringliteral">&quot;and count parameters&quot;</span>)
<a name="l01294"></a>01294 
<a name="l01295"></a>01295         ranges = []
<a name="l01296"></a>01296         <span class="keywordflow">for</span> b <span class="keywordflow">in</span> range(len(src_starts)):
<a name="l01297"></a>01297             ranges.append(BlockRange(src_starts[b], dst_starts[b], counts[b]))
<a name="l01298"></a>01298 
<a name="l01299"></a>01299         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">False</span>):
<a name="l01300"></a>01300             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_replicate_range(rep_type, src, dst, ranges)
<a name="l01301"></a>01301 
<a name="l01302"></a>01302     <span class="comment">##</span>
<a name="l01303"></a>01303     <span class="comment"># Returns the block size in bytes for each block represented in</span>
<a name="l01304"></a>01304     <span class="comment"># volume_replicate_range</span>
<a name="l01305"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a91e16c71d64f6ff5cef2dc6d300c8550">01305</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a91e16c71d64f6ff5cef2dc6d300c8550" title="Returns the block size in bytes for each block represented in volume_replicate_range...">volume_replicate_range_block_size</a>(self, args):
<a name="l01306"></a>01306         s = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.systems(), args.sys, <span class="stringliteral">&quot;System&quot;</span>)
<a name="l01307"></a>01307         out(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_replicate_range_block_size(s))
<a name="l01308"></a>01308 
<a name="l01309"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a11e89b0a224501a5633ff3976b26b974">01309</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a11e89b0a224501a5633ff3976b26b974">volume_mask</a>(self, args):
<a name="l01310"></a>01310         vol = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&apos;Volume&apos;</span>)
<a name="l01311"></a>01311         ag = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups(), args.ag, <span class="stringliteral">&apos;Access Group&apos;</span>)
<a name="l01312"></a>01312         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_mask(ag, vol)
<a name="l01313"></a>01313 
<a name="l01314"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af7608f5de545237cfa4f0b24e82387b9">01314</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af7608f5de545237cfa4f0b24e82387b9">volume_unmask</a>(self, args):
<a name="l01315"></a>01315         ag = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.access_groups(), args.ag, <span class="stringliteral">&quot;Access Group&quot;</span>)
<a name="l01316"></a>01316         vol = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01317"></a>01317         <span class="keywordflow">return</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_unmask(ag, vol)
<a name="l01318"></a>01318 
<a name="l01319"></a>01319     <span class="comment">## Re-sizes a volume</span>
<a name="l01320"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aaafb0e081a5a7bd012d35f53b14e1e1a">01320</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aaafb0e081a5a7bd012d35f53b14e1e1a" title="Re-sizes a volume.">volume_resize</a>(self, args):
<a name="l01321"></a>01321         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01322"></a>01322         size = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a32d46a370231146113ec4853762dc50c" title="Converts a size parameter into the appropriate number of bytes.">_size</a>(args.size)
<a name="l01323"></a>01323 
<a name="l01324"></a>01324         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#af496749a8c9f1a19d1a915809d06d004" title="Warn of imminent data loss.">confirm_prompt</a>(<span class="keyword">False</span>):
<a name="l01325"></a>01325             vol = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;resize&quot;</span>,
<a name="l01326"></a>01326                                     *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_resize(v, size))
<a name="l01327"></a>01327             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([vol])
<a name="l01328"></a>01328 
<a name="l01329"></a>01329     <span class="comment">## Enable a volume</span>
<a name="l01330"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7dd5e96204c6df692dc9de8e6c2628d4">01330</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7dd5e96204c6df692dc9de8e6c2628d4" title="Enable a volume.">volume_enable</a>(self, args):
<a name="l01331"></a>01331         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01332"></a>01332         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_enable(v)
<a name="l01333"></a>01333 
<a name="l01334"></a>01334     <span class="comment">## Disable a volume</span>
<a name="l01335"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4800245aeca1e7f88a0725df176d87a4">01335</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4800245aeca1e7f88a0725df176d87a4" title="Disable a volume.">volume_disable</a>(self, args):
<a name="l01336"></a>01336         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01337"></a>01337         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_disable(v)
<a name="l01338"></a>01338 
<a name="l01339"></a>01339     <span class="comment">## Removes a nfs export</span>
<a name="l01340"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0e6566740210e44dc3c101e7859fedc7">01340</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0e6566740210e44dc3c101e7859fedc7" title="Removes a nfs export.">fs_unexport</a>(self, args):
<a name="l01341"></a>01341         export = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.exports(), args.export, <span class="stringliteral">&quot;NFS Export&quot;</span>)
<a name="l01342"></a>01342         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.export_remove(export)
<a name="l01343"></a>01343 
<a name="l01344"></a>01344     <span class="comment">## Exports a file system as a NFS export</span>
<a name="l01345"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b6b556b2f796d4a8868d33c8ae0d423">01345</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9b6b556b2f796d4a8868d33c8ae0d423" title="Exports a file system as a NFS export.">fs_export</a>(self, args):
<a name="l01346"></a>01346         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01347"></a>01347 
<a name="l01348"></a>01348         <span class="comment"># Check to see if we have some type of access specified</span>
<a name="l01349"></a>01349         <span class="keywordflow">if</span> len(args.rw_host) == 0 \
<a name="l01350"></a>01350                 <span class="keywordflow">and</span> len(args.ro_host) == 0:
<a name="l01351"></a>01351             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot; please specify --ro-host or --rw-host&quot;</span>)
<a name="l01352"></a>01352 
<a name="l01353"></a>01353         export = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.export_fs(
<a name="l01354"></a>01354             fs.id,
<a name="l01355"></a>01355             args.exportpath,
<a name="l01356"></a>01356             args.root_host,
<a name="l01357"></a>01357             args.rw_host,
<a name="l01358"></a>01358             args.ro_host,
<a name="l01359"></a>01359             args.anonuid,
<a name="l01360"></a>01360             args.anongid,
<a name="l01361"></a>01361             args.auth_type,
<a name="l01362"></a>01362             <span class="keywordtype">None</span>)
<a name="l01363"></a>01363         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([export])
<a name="l01364"></a>01364 
<a name="l01365"></a>01365     <span class="comment">## Displays volume dependants.</span>
<a name="l01366"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#afb3ea60161b415854e2e6b9ab5ff06f0">01366</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#afb3ea60161b415854e2e6b9ab5ff06f0" title="Displays volume dependants.">volume_dependants</a>(self, args):
<a name="l01367"></a>01367         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01368"></a>01368         rc = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_child_dependency(v)
<a name="l01369"></a>01369         out(rc)
<a name="l01370"></a>01370 
<a name="l01371"></a>01371     <span class="comment">## Removes volume dependants.</span>
<a name="l01372"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a607b7406e757eb16a1f6e88864da9b6a">01372</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a607b7406e757eb16a1f6e88864da9b6a" title="Removes volume dependants.">volume_dependants_rm</a>(self, args):
<a name="l01373"></a>01373         v = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01374"></a>01374         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;volume-dependant-rm&quot;</span>,
<a name="l01375"></a>01375                           self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_child_dependency_rm(v), <span class="keywordtype">None</span>)
<a name="l01376"></a>01376 
<a name="l01377"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a167642e25ed4505c71839563c08f4ea2">01377</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a167642e25ed4505c71839563c08f4ea2">volume_raid_info</a>(self, args):
<a name="l01378"></a>01378         lsm_vol = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volumes(), args.vol, <span class="stringliteral">&quot;Volume&quot;</span>)
<a name="l01379"></a>01379         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l01380"></a>01380             [
<a name="l01381"></a>01381                 VolumeRAIDInfo(
<a name="l01382"></a>01382                     lsm_vol.id, *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_raid_info(lsm_vol))])
<a name="l01383"></a>01383 
<a name="l01384"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a491c490a0a0d1d9a4cf537d3330a6168">01384</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a491c490a0a0d1d9a4cf537d3330a6168">pool_member_info</a>(self, args):
<a name="l01385"></a>01385         lsm_pool = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pools(), args.pool, <span class="stringliteral">&quot;Pool&quot;</span>)
<a name="l01386"></a>01386         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>(
<a name="l01387"></a>01387             [
<a name="l01388"></a>01388                 PoolRAIDInfo(
<a name="l01389"></a>01389                     lsm_pool.id, *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.pool_member_info(lsm_pool))])
<a name="l01390"></a>01390 
<a name="l01391"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ac4bb3abaf692612c6c73aab2b95b70fe">01391</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ac4bb3abaf692612c6c73aab2b95b70fe">volume_raid_create</a>(self, args):
<a name="l01392"></a>01392         raid_type = VolumeRAIDInfo.raid_type_str_to_lsm(args.raid_type)
<a name="l01393"></a>01393 
<a name="l01394"></a>01394         all_lsm_disks = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.disks()
<a name="l01395"></a>01395         lsm_disks = [d <span class="keywordflow">for</span> d <span class="keywordflow">in</span> all_lsm_disks <span class="keywordflow">if</span> d.id <span class="keywordflow">in</span> args.disk]
<a name="l01396"></a>01396         <span class="keywordflow">if</span> len(lsm_disks) != len(args.disk):
<a name="l01397"></a>01397             <span class="keywordflow">raise</span> LsmError(
<a name="l01398"></a>01398                 ErrorNumber.NOT_FOUND_DISK,
<a name="l01399"></a>01399                 <span class="stringliteral">&quot;Disk ID %s not found&quot;</span> %
<a name="l01400"></a>01400                 <span class="stringliteral">&apos;, &apos;</span>.join(set(args.disk) - set(d.id <span class="keywordflow">for</span> d <span class="keywordflow">in</span> all_lsm_disks)))
<a name="l01401"></a>01401 
<a name="l01402"></a>01402         busy_disks = [d.id <span class="keywordflow">for</span> d <span class="keywordflow">in</span> lsm_disks
<a name="l01403"></a>01403                       <span class="keywordflow">if</span> <span class="keywordflow">not</span> d.status &amp; Disk.STATUS_FREE]
<a name="l01404"></a>01404 
<a name="l01405"></a>01405         <span class="keywordflow">if</span> len(busy_disks) &gt;= 1:
<a name="l01406"></a>01406             <span class="keywordflow">raise</span> LsmError(
<a name="l01407"></a>01407                 ErrorNumber.DISK_NOT_FREE,
<a name="l01408"></a>01408                 <span class="stringliteral">&quot;Disk %s is not free&quot;</span> % <span class="stringliteral">&quot;, &quot;</span>.join(busy_disks))
<a name="l01409"></a>01409 
<a name="l01410"></a>01410         <span class="keywordflow">if</span> args.strip_size:
<a name="l01411"></a>01411             strip_size = size_human_2_size_bytes(args.strip_size)
<a name="l01412"></a>01412         <span class="keywordflow">else</span>:
<a name="l01413"></a>01413             strip_size = Volume.VCR_STRIP_SIZE_DEFAULT
<a name="l01414"></a>01414 
<a name="l01415"></a>01415         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([
<a name="l01416"></a>01416             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_raid_create(
<a name="l01417"></a>01417                 args.name, raid_type, lsm_disks, strip_size)])
<a name="l01418"></a>01418 
<a name="l01419"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a236f6ed93869f63a54865bdf2a04ad2c">01419</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a236f6ed93869f63a54865bdf2a04ad2c">volume_raid_create_cap</a>(self, args):
<a name="l01420"></a>01420         lsm_sys = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.systems(), args.sys, <span class="stringliteral">&quot;System&quot;</span>)
<a name="l01421"></a>01421         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3fc6d87df853d4d78323d0815609158" title="Tries to make the output better when it varies considerably from plug-in to plug-in...">display_data</a>([
<a name="l01422"></a>01422             VcrCap(lsm_sys.id, *self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.volume_raid_create_cap_get(lsm_sys))])
<a name="l01423"></a>01423 
<a name="l01424"></a>01424     <span class="comment">## Displays file system dependants</span>
<a name="l01425"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a39bb9a102b819d2f41bf2a2112cbadc6">01425</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a39bb9a102b819d2f41bf2a2112cbadc6" title="Displays file system dependants.">fs_dependants</a>(self, args):
<a name="l01426"></a>01426         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01427"></a>01427         rc = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_child_dependency(fs, args.file)
<a name="l01428"></a>01428         out(rc)
<a name="l01429"></a>01429 
<a name="l01430"></a>01430     <span class="comment">## Removes file system dependants</span>
<a name="l01431"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7846038fe8bfa5cf79cbe475fd20f2fc">01431</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7846038fe8bfa5cf79cbe475fd20f2fc" title="Removes file system dependants.">fs_dependants_rm</a>(self, args):
<a name="l01432"></a>01432         fs = _get_item(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs(), args.fs, <span class="stringliteral">&quot;File System&quot;</span>)
<a name="l01433"></a>01433         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a0207437b8615049a36f62b77ba966a9c" title="Waits for an operation to complete by polling for the status of the operations.">_wait_for_it</a>(<span class="stringliteral">&quot;fs-dependants-rm&quot;</span>,
<a name="l01434"></a>01434                           self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.fs_child_dependency_rm(fs,
<a name="l01435"></a>01435                                                         args.file),
<a name="l01436"></a>01436                           <span class="keywordtype">None</span>)
<a name="l01437"></a>01437 
<a name="l01438"></a>01438     <span class="keyword">def </span>_read_configfile(self):
<a name="l01439"></a>01439         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l01440"></a>01440 <span class="stringliteral">        Set uri from config file. Will be overridden by cmdline option or</span>
<a name="l01441"></a>01441 <span class="stringliteral">        env var if present.</span>
<a name="l01442"></a>01442 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l01443"></a>01443 
<a name="l01444"></a>01444         allowed_config_options = (<span class="stringliteral">&quot;uri&quot;</span>,)
<a name="l01445"></a>01445 
<a name="l01446"></a>01446         config_path = os.path.expanduser(<span class="stringliteral">&quot;~&quot;</span>) + <span class="stringliteral">&quot;/.lsmcli&quot;</span>
<a name="l01447"></a>01447         <span class="keywordflow">if</span> <span class="keywordflow">not</span> os.path.exists(config_path):
<a name="l01448"></a>01448             <span class="keywordflow">return</span>
<a name="l01449"></a>01449 
<a name="l01450"></a>01450         with open(config_path) <span class="keyword">as</span> f:
<a name="l01451"></a>01451             <span class="keywordflow">for</span> line <span class="keywordflow">in</span> f:
<a name="l01452"></a>01452 
<a name="l01453"></a>01453                 <span class="keywordflow">if</span> line.lstrip().startswith(<span class="stringliteral">&quot;#&quot;</span>):
<a name="l01454"></a>01454                     <span class="keywordflow">continue</span>
<a name="l01455"></a>01455 
<a name="l01456"></a>01456                 <span class="keywordflow">try</span>:
<a name="l01457"></a>01457                     name, val = [x.strip() <span class="keywordflow">for</span> x <span class="keywordflow">in</span> line.split(<span class="stringliteral">&quot;=&quot;</span>, 1)]
<a name="l01458"></a>01458                     <span class="keywordflow">if</span> name <span class="keywordflow">in</span> allowed_config_options:
<a name="l01459"></a>01459                         setattr(self, name, val)
<a name="l01460"></a>01460                 <span class="keywordflow">except</span> ValueError:
<a name="l01461"></a>01461                     <span class="keywordflow">pass</span>
<a name="l01462"></a>01462 
<a name="l01463"></a>01463     <span class="comment">## Class constructor.</span>
<a name="l01464"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ac775ee34451fdfa742b318538164070e">01464</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ac775ee34451fdfa742b318538164070e" title="Class constructor.">__init__</a>(self):
<a name="l01465"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">01465</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a> = <span class="keywordtype">None</span>
<a name="l01466"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">01466</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a> = <span class="keywordtype">None</span>
<a name="l01467"></a>01467         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a90eee7a4677ca8b1ed116364a24367f9">parser</a> = <span class="keywordtype">None</span>
<a name="l01468"></a>01468         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ad3afcab76f1db5dda05ca54af8e79d06">unknown_args</a> = <span class="keywordtype">None</span>
<a name="l01469"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">01469</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a> = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7f649901800e4188b62b0917de103629" title="All the command line arguments and options are created in this method.">cli</a>()
<a name="l01470"></a>01470 
<a name="l01471"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">01471</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">cleanup</a> = <span class="keywordtype">None</span>
<a name="l01472"></a>01472 
<a name="l01473"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">01473</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">tmo</a> = int(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.wait)
<a name="l01474"></a>01474         <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">tmo</a> <span class="keywordflow">or</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">tmo</a> &lt; 0:
<a name="l01475"></a>01475             <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;[-w|--wait] requires a non-zero positive integer&quot;</span>)
<a name="l01476"></a>01476 
<a name="l01477"></a>01477         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#aa6c8a7c783f4b8258e227ee3e8af1601">_read_configfile</a>()
<a name="l01478"></a>01478         <span class="keywordflow">if</span> os.getenv(<span class="stringliteral">&apos;LSMCLI_URI&apos;</span>) <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01479"></a>01479             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a> = os.getenv(<span class="stringliteral">&apos;LSMCLI_URI&apos;</span>)
<a name="l01480"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">01480</a>         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a> = os.getenv(<span class="stringliteral">&apos;LSMCLI_PASSWORD&apos;</span>)
<a name="l01481"></a>01481         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.uri <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01482"></a>01482             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a> = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.uri
<a name="l01483"></a>01483 
<a name="l01484"></a>01484         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a> <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l01485"></a>01485             <span class="comment"># We need a valid plug-in to instantiate even if all we are trying</span>
<a name="l01486"></a>01486             <span class="comment"># to do is list the plug-ins at the moment to keep that code</span>
<a name="l01487"></a>01487             <span class="comment"># the same in all cases, even though it isn&apos;t technically</span>
<a name="l01488"></a>01488             <span class="comment"># required for the client library (static method)</span>
<a name="l01489"></a>01489             <span class="comment"># TODO: Make this not necessary.</span>
<a name="l01490"></a>01490             <span class="keywordflow">if</span> (<span class="stringliteral">&apos;type&apos;</span> <span class="keywordflow">in</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a> <span class="keywordflow">and</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.type == <span class="stringliteral">&quot;PLUGINS&quot;</span>):
<a name="l01491"></a>01491                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a> = <span class="stringliteral">&quot;sim://&quot;</span>
<a name="l01492"></a>01492                 self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a> = <span class="keywordtype">None</span>
<a name="l01493"></a>01493             <span class="keywordflow">else</span>:
<a name="l01494"></a>01494                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;--uri missing or export LSMCLI_URI&quot;</span>)
<a name="l01495"></a>01495 
<a name="l01496"></a>01496         <span class="comment"># Lastly get the password if requested.</span>
<a name="l01497"></a>01497         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.prompt:
<a name="l01498"></a>01498             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a> = getpass.getpass()
<a name="l01499"></a>01499 
<a name="l01500"></a>01500         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a> <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:
<a name="l01501"></a>01501             <span class="comment">#Check for username</span>
<a name="l01502"></a>01502             u = uri_parse(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a>)
<a name="l01503"></a>01503             <span class="keywordflow">if</span> u[<span class="stringliteral">&apos;username&apos;</span>] <span class="keywordflow">is</span> <span class="keywordtype">None</span>:
<a name="l01504"></a>01504                 <span class="keywordflow">raise</span> ArgError(<span class="stringliteral">&quot;password specified with no user name in uri&quot;</span>)
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <span class="comment">## Does appropriate clean-up</span>
<a name="l01507"></a>01507     <span class="comment"># @param    ec      The exit code</span>
<a name="l01508"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abbc72568e192ffdeda9cfed44cce64ff">01508</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abbc72568e192ffdeda9cfed44cce64ff" title="Does appropriate clean-up.">shutdown</a>(self, ec=None):
<a name="l01509"></a>01509         <span class="keywordflow">if</span> self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">cleanup</a>:
<a name="l01510"></a>01510             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">cleanup</a>()
<a name="l01511"></a>01511 
<a name="l01512"></a>01512         <span class="keywordflow">if</span> ec:
<a name="l01513"></a>01513             sys.exit(ec)
<a name="l01514"></a>01514 
<a name="l01515"></a>01515     <span class="comment">## Process the specified command</span>
<a name="l01516"></a>01516     <span class="comment"># @param    cli     The object instance to invoke methods on.</span>
<a name="l01517"></a><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7f3389f4759618032e662129016fc269">01517</a>     <span class="keyword">def </span><a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a7f3389f4759618032e662129016fc269" title="Process the specified command.">process</a>(self, cli=None):
<a name="l01518"></a>01518         <span class="stringliteral">&quot;&quot;&quot;</span>
<a name="l01519"></a>01519 <span class="stringliteral">        Process the parsed command.</span>
<a name="l01520"></a>01520 <span class="stringliteral">        &quot;&quot;&quot;</span>
<a name="l01521"></a>01521         <span class="keywordflow">if</span> cli:
<a name="l01522"></a>01522             <span class="comment">#Directly invoking code though a wrapper to catch unsupported</span>
<a name="l01523"></a>01523             <span class="comment">#operations.</span>
<a name="l01524"></a>01524             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a> = Proxy(cli())
<a name="l01525"></a>01525             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.plugin_register(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">tmo</a>)
<a name="l01526"></a>01526             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">cleanup</a> = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.plugin_unregister
<a name="l01527"></a>01527         <span class="keywordflow">else</span>:
<a name="l01528"></a>01528             <span class="comment">#Going across the ipc pipe</span>
<a name="l01529"></a>01529             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a> = Proxy(Client(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abab8d10ddba220b6ca30b80b481bec4e">uri</a>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a9dbb300e28bc21c8dab41b01883918eb">password</a>, self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a4e5c389f6ea39c7ec07b9134745ddfd5">tmo</a>))
<a name="l01530"></a>01530 
<a name="l01531"></a>01531             <span class="keywordflow">if</span> os.getenv(<span class="stringliteral">&apos;LSM_DEBUG_PLUGIN&apos;</span>):
<a name="l01532"></a>01532                 raw_input(
<a name="l01533"></a>01533                     <span class="stringliteral">&quot;Attach debugger to plug-in, press &lt;return&gt; when ready...&quot;</span>)
<a name="l01534"></a>01534 
<a name="l01535"></a>01535             self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a2f66326b332255922ad69be6ff15851d">cleanup</a> = self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#ae0323a9039add2978bf5b49550572c7c">c</a>.close
<a name="l01536"></a>01536 
<a name="l01537"></a>01537         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>.func(self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#a8187411843a6284ffb964ef3fb9fcab3">args</a>)
<a name="l01538"></a>01538         self.<a class="code" href="classlsmcli_1_1cmdline_1_1_cmd_line.html#abbc72568e192ffdeda9cfed44cce64ff" title="Does appropriate clean-up.">shutdown</a>()
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 9 Jul 2015 for libStorageMgmt by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
